(()=>{"use strict";var __webpack_modules__={412:(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{Z:()=>Learn});class Learn{constructor(t){this.learn=t,this.learn.visible=!1,this.off_sound=!1,this.learn_ivl=null,this.learn.down_mc.interactive=!0,this.learn.down_mc.alpha=.01,setButton(this.learn.blow_mc.off_mc),this.learn.blow_mc.off_mc.on("pointerdown",(()=>this.volume()))}check(){for(;this.learn.down_mc.children.length;)this.learn.down_mc.removeChildAt(0);for(let t=0;t<learn_cfg.triggers.length;t++)if(this.checkVars(learn_cfg.triggers[t])&&this.checkLocals(learn_cfg.triggers[t].local))return console.log("trigger "+t+" activated"),this.constructStep(t);this.nullPointer()}volume(){this.off_sound=!this.off_sound,window.custom_sound&&(window.custom_sound.volume=.6*(this.off_sound?0:1)),this.off_sound?this.learn.blow_mc.off_mc.alpha=1:this.learn.blow_mc.off_mc.alpha=.01}constructStep(t){this.construction||(this.construction=!0,this.tikTak(),this.constructDown(t),-1!=learn_cfg.triggers[t].specs.text?(this.constructText(learn_cfg.triggers[t].specs.text),this.learn.blow_mc.x=800,gsap.to(this.learn.blow_mc,{duration:.3,x:493,onComplete:()=>{this.constructPointer(t),console.log("show_point_st1")}})):(gsap.to(this.learn.blow_mc,{duration:.3,x:800}),this.constructPointer(t),console.log("show_point_st1_a")),this.learn.parent||root.layer2_mc.addChild(this.learn),this.learn.visible=!0)}constructDown(t){let e=new PIXI.Graphics;e.beginFill(),e.drawRect(0,0,760,760),e.endFill(),this.learn.down_mc.addChild(e)}constructHole(t){let e=this.learn.down_mc.children[0];e.beginHole(),e.drawCircle(learn_cfg.triggers[t].specs.pointer[1],learn_cfg.triggers[t].specs.pointer[2],learn_cfg.triggers[t].specs.radius),e.endHole()}constructText(t){this.learn.blow_mc.text_txt.text=learn_cfg.text[t].text,this.learn.blow_mc.title_txt.text=learn_cfg.text[t].title,this.nullPointer(),this.off_sound?this.learn.blow_mc.off_mc.alpha=1:(sounds.playCustom(learn_cfg.text[t].sound),this.learn.blow_mc.off_mc.alpha=.01)}constructPointer(t){this.construction=!1,learn_cfg.triggers[t].specs.pointer[0]&&(console.log("show_point_st2"),"after"!=learn_cfg.triggers[t].specs.timing[0]||this.off_sound?this.showPointer(t):this.learn_ivl=setInterval((()=>{clearInterval(this.learn_ivl),this.showPointer(t),console.log("show_point_st3")}),learn_cfg.triggers[t].specs.timing[1]))}showPointer(t){console.log("show_point_st4"),this.constructHole(t),gsap.to(this.learn.cursor_mc,{duration:.3,x:learn_cfg.triggers[t].specs.pointer[1],y:learn_cfg.triggers[t].specs.pointer[2],onComplete:()=>{"click"==learn_cfg.triggers[t].specs.pointer[3]?this.learn.cursor_mc.play():this.learn.cursor_mc.gotoAndStop(0),this.num=t,-1==learn_cfg.triggers[t].specs.text&&"click"==learn_cfg.triggers[this.num].specs.pointer[3]||(this.learn_ivl=setInterval((()=>{this.tikTak()}),2500+1e3*(this.off_sound?0:1)))}})}tikTak(){if(void 0!==this.num&&(console.log("tik tak suka"),clearInterval(this.learn_ivl),gsap.to(this.learn.blow_mc,{duration:.3,x:800}),"click"!=learn_cfg.triggers[this.num].specs.pointer[3]))for(this.nullPointer();this.learn.down_mc.children.length;)this.learn.down_mc.removeChildAt(0)}checkVars(t){for(let e=0;e<t.keys.length;e++){let s=t.keys[e].split(" "),i=null;if(void 0!==s[1]?(udata[s[0]][s[1]]=udata[s[0]][s[1]]||0,i=udata[s[0]][s[1]]):(udata[s[0]]=udata[s[0]]||0,i=udata[s[0]]),i!=t.values[e])return!1}return!0}checkLocals(locals){for(let i=0;i<locals.keys.length;i++){let cls=locals.keys[i].split(".");if(!eval("window."+cls[0])&&!locals.values[i])continue;if(!eval("window."+cls[0])&&locals.values[i])return!1;let mov=eval("window."+locals.keys[i]);if(Boolean(mov.parent)&&mov.visible&&!locals.values[i])return!1;if((!Boolean(mov.parent)||!mov.visible)&&locals.values[i])return!1}return!0}nullPointer(){gsap.to(this.learn.cursor_mc,{duration:.3,x:-100,y:-100})}checkBoss(){}showBossHand(){}checkBossWin(){}checkName(){}showNameHand(){}checkNewName(){}checkQuests(){}showQuestHand(){}checkMapHand(){}checkMapHary(){}hideMap(){}checkStany(){}checkIconsShop(){}checkMenuShop(){}showIconShopHand(){}showMenuShopHand(){}showRight(t,e){}showLeft(t,e){}hideHand(){}locBools(){}shopBools(){}bossBools(){return udata.fwins[0]||0}}}},__webpack_module_cache__={};function __webpack_require__(t){var e=__webpack_module_cache__[t];if(void 0!==e)return e.exports;var s=__webpack_module_cache__[t]={exports:{}};return __webpack_modules__[t](s,s.exports,__webpack_require__),s.exports}__webpack_require__.d=(t,e)=>{for(var s in e)__webpack_require__.o(e,s)&&!__webpack_require__.o(t,s)&&Object.defineProperty(t,s,{enumerable:!0,get:e[s]})},__webpack_require__.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e);var __webpack_exports__={};(()=>{class t{constructor(t,e,s,i,o,a,n,h,l,r,m){window.rootClass=this,this.up=t,this.down=e,this.friend=i,this.my=s,this.new_name=o,this.obmen=h,this.reg_music=a,this.screen_shot=n,this.chotko=l,this.kalmar=r,this.initButtons(),this.initMasks(),this.old_level=0,this.friends=[],this.names=["Двор","Город","Рынок","Оружейка","Разборки","Играть","Гараж"],this.faq_link="https://vk.com/page-133196577_54959825",this.rating_mode="friends",this.oldbutts=[],this.top_page=0,this.upload_link="",this.obmen_startX=this.obmen.win.line1_mc.x,this.obmen_endX=parseInt(this.obmen.win.line1_mc.width),this.obmen_realvalue=1,this.obmen_downX=0,this.obmen_bool=!1,this.obmen_goanim=!0,this.kalmar_goanim=!0,this.kalmar_bosses_infos=["местных боссов","залетных боссов","подражателей"],this.obmen_value=0,this.xxx_obmen=[this.obmen.win.x1_mc,this.obmen.win.x10_mc,this.obmen.win.x100_mc,this.obmen.win.x1k_mc,this.obmen.win.x10k_mc,this.obmen.win.x100k_mc,this.obmen.win.x500k_mc,this.obmen.win.x1kk_mc];for(let t=0;t<this.xxx_obmen.length;t++)setButton(this.xxx_obmen[t]);this.activate_mousemove=!1,this.mm_mode=null,this.reg_music_startX=parseInt(this.reg_music.win.music_line.x),this.reg_music_endX=parseInt(this.reg_music.win.music_line.width),this.reg_music_downX=0,this.fullBlob=null,this.aid=0,this.album_name="Хулиганы",this.screen_caption="Я играю в Хулиганы! Присоединяйся и получай бонус 100 рублей на старте! https://vk.com/app"+vk_params.api_id+"?ad_id=screen",this.active_screen=!1,this.down.icons_mc.b1.on("pointerdown",(()=>this.toMenu())),this.down.icons_mc.b2.on("pointerdown",(()=>modules.checkFlags(["menu"],(()=>main_menu.toCity())))),this.down.icons_mc.b3.on("pointerdown",(()=>modules.checkFlags(["menu"],(()=>main_menu.toShop())))),this.down.icons_mc.b4.on("pointerdown",(()=>modules.checkFlags(["menu"],(()=>main_menu.toArmor())))),this.down.icons_mc.b5.on("pointerdown",(()=>modules.checkFlags(["menu"],(()=>main_menu.checkStatusBoss())))),this.down.icons_mc.b6.on("pointerdown",(()=>modules.checkFlags(["menu"],(()=>main_menu.showMinigames())))),this.down.icons_mc.b7.on("pointerdown",(()=>modules.checkFlags(["menu"],(()=>main_menu.toGarage())))),this.reg_music.win.music_scroll.on("pointerdown",(t=>this.downRegScroll(t,"music"))),this.reg_music.win.sound_scroll.on("pointerdown",(t=>this.downRegScroll(t,"sound"))),helper.clickControl(this.reg_music.win.canvas_btn,null,(()=>{localStore.canvas=!Boolean(localStore.canvas),this.reg_music.win.canvas_check.visible=Boolean(localStore.canvas)})),helper.clickControl(this.reg_music.win.preload_btn,null,(()=>{localStore.preload=!Boolean(localStore.preload),this.reg_music.win.preload_check.visible=Boolean(localStore.preload)})),this.up.edit_mc.on("pointerdown",(()=>this.newNameB())),this.new_name.win.butt_mc.on("pointerdown",(()=>this.newName())),this.up.coins_mc.on("pointerdown",(()=>{this.obmen_fun=()=>this.obmenVal(),this.obmen.win.box_obmen_all.visible=this.obmen.win.obmen_all_mc.visible=!1,this.obmen_vals=["gold","coins"],this.obmen_by_coef=[1],this.obmen_to_coef=100,this.startObmen()})),this.up.gold_mc.on("pointerdown",(()=>modules.checkFlags(["bank"],(()=>{bank.semki_mode="r",bank.semki.win.tcoin_ic.alpha=.7,bank.semki.win.semki_ic.alpha=.7,bank.semki.win.rubles_ic.alpha=1,bank.showSemki()})))),this.up.conserve_mc.on("pointerdown",(()=>modules.checkFlags(["bank"],(()=>{bank.semki_mode="t",bank.semki.win.tcoin_ic.alpha=1,bank.semki.win.semki_ic.alpha=.7,bank.semki.win.rubles_ic.alpha=.7,bank.showSemki()})))),helper.clickControl(this.up.semki_mc,null,(()=>modules.checkFlags(["bank"],(()=>{bank.semki_mode="s",bank.semki.win.tcoin_ic.alpha=.7,bank.semki.win.semki_ic.alpha=1,bank.semki.win.rubles_ic.alpha=.7,bank.showSemki()}))),(()=>console.log("trim"))),this.up.energy_mc.on("pointerdown",(()=>modules.checkFlags(["menu"],(()=>main_menu.toDoping())))),this.up.active1_mc.on("pointerdown",(()=>this.regMusicB())),this.up.active2_mc.on("pointerdown",(()=>window.open(this.faq_link))),this.up.active3_mc.on("pointerdown",(()=>this.screenShotB())),this.obmen.win.close_mc.on("pointerdown",(()=>this.stopObmen())),this.obmen.win.butt_mc.on("pointerdown",(()=>this.obmen_fun())),this.obmen.win.obmen_all_mc.on("pointerdown",(()=>this.obmen_buy_all())),this.down.back_pn.back_mc.on("pointerdown",(()=>this.clickBack())),this.down.top.next_mc.on("pointerdown",(()=>this.nextTop())),this.down.top.prev_mc.on("pointerdown",(()=>this.prevTop())),this.down.top.start_mc.on("pointerdown",(()=>this.startTop())),this.down.top.end_mc.on("pointerdown",(()=>this.endTop())),this.down.dop_info.top_mc.alltop_butt.on("pointerdown",(t=>this.newMode(t))),this.down.dop_info.top_mc.frtop_butt.on("pointerdown",(t=>this.newMode(t))),this.down.top.invite_mc.butt.on("pointerdown",(()=>modules.checkFlags(["menu"],(()=>main_menu.inviteFriend())))),this.obmen.win.line1_mc.on("pointerdown",(t=>this.updPosition(t))),this.obmen.win.line2_mc.on("pointerdown",(t=>this.updPosition(t))),this.obmen.win.give_scroll.on("pointerdown",(t=>this.downObmen(t))),this.obmen.win.take_scroll.on("pointerdown",(t=>this.downObmen(t))),this.down.dop_info.buttons_mc.guest_mc.on("pointerdown",(()=>this.goValidGuest())),this.down.tooltip_mc.buttons_mc.guest_mc.on("pointerdown",(()=>this.goValidGuest())),this.down.dop_info.buttons_mc.shmon_mc.on("pointerdown",(t=>this.validShmon(t))),this.down.tooltip_mc.buttons_mc.shmon_mc.on("pointerdown",(t=>this.validShmon(t))),this.down.dop_info.buttons_mc.post_mc.on("pointerdown",(t=>this.validSayWhat(t))),this.down.tooltip_mc.buttons_mc.post_mc.on("pointerdown",(t=>this.validSayWhat(t))),this.reg_music.win.butt_mc.on("pointerdown",(()=>this.regMusic())),this.reg_music.win.music_line.on("pointerdown",(t=>{this.reg_music.win.music_scroll.x=this.reg_music_startX-(this.reg_music_startX+this.reg_music.win.x-t.data.global.x),bg_music.volume=(this.reg_music.win.music_scroll.x-this.reg_music_startX)/this.reg_music_endX})),this.reg_music.win.sound_line.on("pointerdown",(t=>this.reg_music.win.sound_scroll.x=this.reg_music_startX-(this.reg_music_startX+this.reg_music.win.x-t.data.global.x))),root.on("pointermove",(t=>this.pointerMove(t))),root.on("pointerup",(t=>{this.activate_mousemove=this.obmen_bool=!1})),this.new_name.interactive=this.obmen.interactive=this.screen_shot.interactive=this.reg_music.interactive=this.kalmar.interactive=!0,this.screen_shot.big_mc.nosave_txt.on("pointerdown",(()=>this.closeScreen())),window.addEventListener("keyup",(t=>{44==t.keyCode&&this.screenShotB()})),this.down.search_mc.on("pointerdown",(()=>{this.goGuest(this.search_tf.text)})),this.kalmar.mobile.close_mc.on("pointerdown",(()=>this.closeMenuKalmar())),this.kalmar.mobile.prev_mode_mc.on("pointerdown",(()=>this.menuKalmarPrev())),this.kalmar.mobile.next_mode_mc.on("pointerdown",(()=>this.menuKalmarNext())),this.kalmar.mobile.fight_mc.on("pointerdown",(()=>TS.php("fights.start",{id:15,mode:this.kalmar_menu_modes},(t=>{modules.checkFlags(["menu","fights"],(()=>{main_menu.fightStatus(t),this.closeMenuKalmar()}))}),rootClass.onError)))}pointerMove(t){if(this.obmen_bool){let e={x:this.obmen_startX-(this.obmen_startX+this.obmen.win.x-t.data.global.x)};this.obmen.win.give_scroll.x=this.obmen.win.take_scroll.x=Math.floor(e.x-this.obmen_downX),e.x-this.obmen_downX>=this.obmen_startX+this.obmen_endX&&(this.obmen.win.give_scroll.x=this.obmen.win.take_scroll.x=this.obmen_startX+this.obmen_endX),e.x-this.obmen_downX<=this.obmen_startX&&(this.obmen.win.give_scroll.x=this.obmen.win.take_scroll.x=this.obmen_startX),this.updObmen()}if(this.activate_mousemove){let e={x:this.reg_music_startX-(this.reg_music_startX+this.reg_music.win.x-t.data.global.x)},s=null;s="music"==this.mm_mode?this.reg_music.win.music_scroll:this.reg_music.win.sound_scroll,s.x=Math.floor(e.x-this.reg_music_downX),e.x-this.reg_music_downX>=this.reg_music_startX+this.reg_music_endX&&(s.x=this.reg_music_startX+this.reg_music_endX),e.x-this.reg_music_downX<=this.reg_music_startX&&(s.x=this.reg_music_startX),bg_music.volume=(this.reg_music.win.music_scroll.x-this.reg_music_startX)/this.reg_music_endX}(t.data.global.x<20||t.data.global.x>730)&&(this.activate_mousemove=this.obmen_bool=!1)}init(){for(let t=0;t<rating.friends.length;t++)this.friends.push(rating.friends[t].id);modules.checkFlags(["achives"],(()=>{achives.my_lvls=udata.achives_level})),this.interval_random=setInterval((()=>this.randomFriends()),1e4),this.randomFriends(),this.upInit(),this.downInit(),this.initStyles(),sounds.playBackMusic()}showDop(){this.up.dop_info.stats_mc.visible=!0,gsap.to(this.up.dop_info,{duration:.3,y:-122})}hideDop(){gsap.to(this.up.dop_info,{duration:.3,y:-208,onComplete:()=>{this.up.dop_info.stats_mc.visible=!1}})}upInit(){this.textField=new PIXI.TextInput({input:{fontFamily:"Trebuchet MS",fontSize:"20px",width:"240px",height:"32px",textAlign:"center",padding:0,color:"#332116"}}),this.textField.maxLength=13,this.up.name_txt.text=this.textField.text=helper.decode64(udata.name),this.up.sale_icon.visible=donat.semki.saletime>TIME,this.up.sale_icon2.visible=donat.gold.saletime>TIME,this.up.sale_icon3.visible=donat.t_coin.saletime>TIME,this.new_name.win.tf_mc.addChild(this.textField),helper.blowController("up_exp",[this.up.line_mc.butt],this.up.blow_mc),helper.blowController("up_coins",[this.up.coins_mc],this.up.coins_blow),helper.blowController("up_semki",[this.up.semki_mc],this.up.semki_blow),helper.blowController("up_gold",[this.up.gold_mc],this.up.gold_blow),helper.blowController("up_energy",[this.up.energy_mc],this.up.enblow_mc),helper.blowController("up_cons",[this.up.conserve_mc],this.up.conserve_blow);for(let t=1;t<=3;t++)this.up.settings_mc["active"+t+"_mc"].visible=!1,setButton(this.up["active"+t+"_mc"]),this.up["active"+t+"_mc"].on("mouseover",(t=>this.up.settings_mc[t.currentTarget.name].visible=!0)),this.up["active"+t+"_mc"].on("mouseout",(t=>this.up.settings_mc[t.currentTarget.name].visible=!1));TIMERS.timers.energy={init:!0,tick:t=>{this.updateEnergy(t)}},this.updateUp(),this.hideDop(),root.layer1_mc.addChild(this.up)}downInit(){this.loadTop(),this.down.y=625,this.down.dop_info.interactive=this.down.tooltip_mc.interactive=!0,this.search_tf=new PIXI.TextInput({input:{fontFamily:"Trebuchet MS",fontSize:"14px",width:"87px",height:"21px",textAlign:"left",padding:0,color:"#2C2518"}}),this.search_tf.x=9,this.search_tf.y=110,this.search_tf.placeholder="Введи ID",this.down.addChild(this.search_tf),this.down.myid_txt.text="Мой ID: "+vk_params.viewer_id;for(let t=1;t<=7;t++)this.down.icons_mc["blow"+t].tf_txt.text=this.names[t-1],setButton(this.down.icons_mc["b"+t]),helper.blowController("down_icon"+t,[this.down.icons_mc["b"+t]],this.down.icons_mc["blow"+t]);root.layer1_mc.addChild(this.down)}randomFriends(){let t=null;t=non_app_friends.length>0?non_app_friends[Math.floor(Math.random()*non_app_friends.length)]:{id:"null",photo_50:null_photo50},helper.loadPhoto50(t.id,(t=>{for(;this.down.top.invite_mc.photo_mc.children.length;)this.down.top.invite_mc.photo_mc.removeChildAt(0);this.down.top.invite_mc.photo_mc.addChild(t)}),t.photo_50)}toMenu(){(1!=HYSTORY[HYSTORY.length-1]||TOBACK)&&modules.checkFlags(["menu"],(()=>{this.hideIcons(),this.removeStage(),main_menu.init()}))}toATM(){(10!=HYSTORY[HYSTORY.length-1]||TOBACK)&&(this.removeStage(),bank.init(),this.showIcons())}loadTop(){this.hideToolTips(),this.butts&&(this.oldbutts=this.butts),this.butts=[],"friends"==this.rating_mode?(this.down.dop_info.top_mc.friends_mc.gotoAndStop(1),this.down.dop_info.top_mc.all_mc.gotoAndStop(0)):(this.down.dop_info.top_mc.friends_mc.gotoAndStop(0),this.down.dop_info.top_mc.all_mc.gotoAndStop(1));for(let t=0;t<9;t++)rating[this.rating_mode][this.top_page+t]?(udata.id==rating[this.rating_mode][this.top_page+t].id?this.butts[t]=this.initTopSlot(this.my):this.butts[t]=this.initTopSlot(this.friend),this.butts[t].tf_txt.text="Топ-"+(this.top_page+t+1),helper.loadPhoto50(rating[this.rating_mode][this.top_page+t].id,(e=>this.butts[t].loader_mc.addChild(e)),rating[this.rating_mode][this.top_page+t].photo)):(this.butts[t]=this.initTopSlot(this.friend),this.butts[t].tf_txt.text="позвать",helper.loadPhoto50("null",(e=>this.butts[t].loader_mc.addChild(e)),null_photo50)),this.down.top.topMov.addChild(this.butts[t]),this.oldbutts[t]&&gsap.to(this.oldbutts[t],{duration:1,y:this.oldbutts[t].getBounds().height,ease:"expo.out"}),gsap.to(this.butts[t],{duration:1,y:0,ease:"expo.out"}),this.butts[t].x=65*t,this.butts[t].y-=this.butts[t].getBounds().height,this.butts[t].cursor="pointer",setButton(this.butts[t]),this.butts[t].on("pointerdown",(t=>{-24==this.down.tooltip_mc.y||-57==this.down.dop_info.y?this.hideToolTips():this.cli(t)}))}newMode(t){let e="";e=t.currentTarget==this.down.dop_info.top_mc.frtop_butt?"friends":"top",e!=this.rating_mode&&(this.rating_mode=e,this.top_page=0,this.loadTop())}nextTop(){null!=rating[this.rating_mode][this.top_page+9]&&(rating[this.rating_mode][this.top_page+18]?this.top_page+=9:this.endTop(),this.loadTop())}prevTop(){0!=this.top_page&&(this.top_page>9?this.top_page-=9:this.startTop(),this.loadTop())}startTop(){0!=this.top_page&&(this.top_page=0,this.loadTop())}endTop(){this.top_page==rating[this.rating_mode].length-9||rating[this.rating_mode].length<=9||(this.top_page=rating[this.rating_mode].length-9,this.loadTop())}hideToolTips(){gsap.to(this.down.tooltip_mc,{duration:.3,y:30,onComplete:()=>{this.down.icons_mc.alpha<.5&&helper.fadeAnimation(this.down.icons_mc,"fadeIn",150)}}),gsap.to(this.down.dop_info,{duration:.3,y:0,onComplete:()=>{this.down.dop_info.top_mc.alpha<.5&&helper.fadeAnimation(this.down.dop_info.top_mc,"fadeIn",150)}})}cli(t){let e=this.tooltip_index=this.butts.indexOf(t.currentTarget);rating[this.rating_mode][this.top_page+e]?this.showTooltip(t):main_menu.inviteFriend()}checkTooltipButtons(){if(this.down.dop_info.buttons_mc.fight_mc.alpha=.5,this.down.tooltip_mc.buttons_mc.fight_mc.alpha=.5,"friends"!=this.rating_mode)return this.down.dop_info.buttons_mc.shmon_mc.alpha=.5,this.down.dop_info.buttons_mc.post_mc.alpha=.5,this.down.tooltip_mc.buttons_mc.shmon_mc.alpha=.5,void(this.down.tooltip_mc.buttons_mc.post_mc.alpha=.5);TIME-parseInt(rating[this.rating_mode][this.top_page+this.tooltip_index].visit)>=604800?(this.down.tooltip_mc.buttons_mc.post_mc.alpha=1,this.down.dop_info.buttons_mc.post_mc.alpha=1):(this.down.tooltip_mc.buttons_mc.post_mc.alpha=.5,this.down.dop_info.buttons_mc.post_mc.alpha=.5),TIME-parseInt(rating[this.rating_mode][this.top_page+this.tooltip_index].shmon)>=3600?(this.down.tooltip_mc.buttons_mc.shmon_mc.alpha=1,this.down.dop_info.buttons_mc.shmon_mc.alpha=1):(this.down.tooltip_mc.buttons_mc.shmon_mc.alpha=.5,this.down.dop_info.buttons_mc.shmon_mc.alpha=.5)}showTooltip(t){if(9==HYSTORY[HYSTORY.length-1])return this.goValidGuest();rating[this.rating_mode][this.top_page+this.tooltip_index].id==udata.id||this.down.icons_mc.alpha<1&&this.down.icons_mc.alpha>0||(this.checkTooltipButtons(t),0===this.tooltip_index?(gsap.to(this.down.dop_info,{duration:.3,y:-57}),gsap.to(this.down.tooltip_mc,{duration:.3,y:30,onComplete:()=>{this.down.icons_mc.alpha<.5&&helper.fadeAnimation(this.down.icons_mc,"fadeIn",150)}}),helper.tooltipControl(t.currentTarget,this.down.dop_info,0,700,[this.down.dop_info.top_mc])):(gsap.to(this.down.tooltip_mc,{duration:.3,y:-24}),this.down.tooltip_mc.x=65*this.tooltip_index,gsap.to(this.down.dop_info,{duration:.3,y:0,onComplete:()=>{this.down.dop_info.top_mc.alpha<.5&&helper.fadeAnimation(this.down.dop_info.top_mc,"fadeIn",150)}}),helper.tooltipControl(t.currentTarget,this.down.tooltip_mc,30,700,[this.down.icons_mc])))}goValidGuest(){this.goGuest(rating[this.rating_mode][this.top_page+this.tooltip_index].id)}validShmon(t){if(.5==this.down.dop_info.buttons_mc.shmon_mc.alpha||.5==this.down.tooltip_mc.buttons_mc.shmon_mc.alpha)return;let e=mouseXY.x,s=mouseXY.y,i=this.top_page+this.tooltip_index;TS.php("users.getFriendBonus",{id:rating[this.rating_mode][i].id},(t=>{helper.animatePrice(modules.names.interface.e,t.win.exp,0,e,s,root.layer2_mc),helper.animatePrice(modules.names.interface.c,t.win.coins,0,e,s,root.layer2_mc),helper.animatePrice(modules.names.interface.s,t.win.semki,0,e,s,root.layer2_mc),helper.animatePrice(modules.names.interface.g,t.win.gold,0,e,s,root.layer2_mc),helper.animatePrice(modules.names.interface.w1,t.win.weapon1,0,e,s,root.layer2_mc),helper.animatePrice(modules.names.interface.w2,t.win.weapon2,0,e,s,root.layer2_mc),helper.animatePrice(modules.names.interface.w3,t.win.weapon3,0,e,s,root.layer2_mc),t.win.wear>=0&&(helper.animatePrice(modules.names.interface.we,1,0,e,s,root.layer2_mc),modules.checkFlags(["menu","fights"],(()=>{fights_windows.showCraft(t.win.wear)}))),achives.refresh(udata.achives_level),iface.updateUp(),iface.showChotko(),rating[this.rating_mode][i].shmon=TIME,this.down.dop_info.buttons_mc.shmon_mc.alpha=this.down.tooltip_mc.buttons_mc.shmon_mc.alpha=.5}),rootClass.onError)}validSayWhat(){if(.5==this.down.dop_info.buttons_mc.post_mc.alpha||.5==this.down.tooltip_mc.buttons_mc.post_mc.alpha)return;let t="@id"+rating[this.rating_mode][this.top_page+this.tooltip_index].id+"(Дружище), давно не вижу тебя в игре! Заходи быстрее, без тебя ну никак совсем! https://vk.com/app"+vk_params.api_id;bridge.send("VKWebAppShowWallPostBox",{message:t,attachments:"photo112354918_457242607"}).then((t=>{console.log(t)}))}goGuest(t){t&&(t!=udata.id?modules.checkFlags(["coll"],(()=>{TS.php("users.get",{id:t},(t=>{guest.udata=t,this.removeStage(),guest.init(),this.showIcons()}),rootClass.onError)})):main_menu.toHome())}newNameB(){gsap.to(this.new_name.win,{x:418,duration:.3}),root.layer1_mc.addChild(this.new_name),learn.check()}newName(){TS.php("users.newName",{name:helper.encode64(this.textField.text)},(()=>this.onNewName()),(t=>rootClass.onError(t)))}onNewName(){this.up.name_txt.text=this.textField.text,gsap.to(this.new_name.win,{duration:.3,x:1010,onComplete:()=>{this.new_name.win.x=-280,root.layer1_mc.removeChild(this.new_name),learn.check()}})}regMusicB(){gsap.to(this.reg_music.win,{x:204,duration:.3}),this.reg_music.win.music_scroll.x=this.reg_music_startX+this.reg_music_endX*(localStore.music/100),this.reg_music.win.sound_scroll.x=this.reg_music_startX+this.reg_music_endX*(localStore.sound/100),this.reg_music.win.canvas_check.visible=Boolean(localStore.canvas),this.reg_music.win.preload_check.visible=Boolean(localStore.preload),root.layer1_mc.addChild(this.reg_music),this.mm_mode}regMusic(){gsap.to(this.reg_music.win,{duration:.3,x:1010,onComplete:()=>{this.reg_music.win.x=-378,root.layer1_mc.removeChild(this.reg_music)}}),localStore.music=Math.floor((this.reg_music.win.music_scroll.x-this.reg_music_startX)/this.reg_music_endX*100),localStore.sound=Math.floor((this.reg_music.win.sound_scroll.x-this.reg_music_startX)/this.reg_music_endX*100),saveLocalStorage()}downRegScroll(t,e){let s=null;this.activate_mousemove=!0,this.mm_mode=e,s="music"==e?this.reg_music.win.music_scroll:this.reg_music.win.sound_scroll,this.reg_music_downX=t.data.global.x-s.worldTransform.tx}screenShotB(){if(this.active_screen)return;bridge.sendPromise("VKWebAppCallAPIMethod",{method:"photos.getAlbums",params:{access_token:VK_token,v:VK_version}}).then((t=>{this.onGetAlbums(t)})),this.screen_shot.big_mc.butt_mc.visible=!1,this.texture?this.texture.baseTexture.update():this.texture=new PIXI.Texture.from(canv);let t=new PIXI.Sprite(this.texture);for(this.screen_shot.big_mc.butt_mc._events.pointerdown||this.screen_shot.big_mc.butt_mc.on("pointerdown",(t=>{this.closeScreen();let e=new XMLHttpRequest,s={};e.open("POST",my_server+"/images/utils/upload.php",!0),e.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),e.onload=()=>{s=JSON.parse(e.responseText.toString().trim()),bridge.sendPromise("VKWebAppCallAPIMethod",{method:"photos.save",params:{album_id:this.aid,server:s.server,photos_list:s.photos_list,hash:s.hash,caption:this.screen_caption,access_token:VK_token,v:VK_version}})},e.send("data="+localBlob+"&id="+vk_params.viewer_id+"&link="+helper.encode64(this.upload_link))})),t.regY=-50,t.scale.x=t.scale.y=.5,t.rotation=Math.PI/180*-4;this.screen_shot.big_mc.image_mc.children.length;)this.screen_shot.big_mc.image_mc.removeChildAt(0);this.screen_shot.big_mc.image_mc.addChild(t),this.screen_shot.big_mc.scr_eff.mask=this.screen_shot.big_mc.image_mc.mask,sounds.playScreen(),this.screen_shot.alpha=0,helper.alphaAnimation(this.screen_shot,1,300,(()=>window.localBlob=scene.renderer.plugins.extract.base64(new PIXI.Sprite(this.texture),"image/jpeg"))),gsap.to(this.screen_shot.little_mc,{x:174,duration:.5,ease:"circ.out",onComplete:()=>{sounds.playScreen(),gsap.to(this.screen_shot.medium_mc,{x:165,duration:.4,ease:"circ.out",onComplete:()=>{sounds.playScreen(),gsap.to(this.screen_shot.big_mc,{y:151,duration:.3,ease:"circ.out"})}})}}),root.layer1_mc.addChild(this.screen_shot),learn.check(),this.active_screen=!0}closeScreen(){gsap.to(this.screen_shot.big_mc,{y:1e3,duration:.3,ease:"circ.out",onComplete:()=>{gsap.to(this.screen_shot.medium_mc,{x:-1e3,duration:.4,ease:"circ.out",onComplete:()=>{gsap.to(this.screen_shot.little_mc,{x:1e3,duration:.5,ease:"circ.out",onComplete:()=>{this.screen_shot.big_mc.y=-388,this.screen_shot.medium_mc.x=790,this.screen_shot.little_mc.x=-431,root.layer1_mc.removeChild(this.screen_shot),this.active_screen=!1}})}})}})}onGetAlbums(t){t=t.response;for(let e=0;e<t.items.length;e++)t.items[e].title==this.album_name&&(this.aid=t.items[e].id);this.aid>0?this.getUploadLink():bridge.sendPromise("VKWebAppCallAPIMethod",{method:"photos.createAlbum",params:{title:this.album_name,access_token:VK_token,v:VK_version}}).then((t=>{this.aid=t.response.id,this.getUploadLink()}))}getUploadLink(){bridge.sendPromise("VKWebAppCallAPIMethod",{method:"photos.getUploadServer",params:{album_id:this.aid,access_token:VK_token,v:VK_version}}).then((t=>{this.upload_link=t.response.upload_url,this.screen_shot.big_mc.butt_mc.visible=!0}))}startObmen(){this.obmen.bg_mc.visible=!1,this.obmen.shadow_mc.alpha=.01,this.obmen_goanim=!0;for(let t=0;t<this.xxx_obmen.length;t++)this.xxx_obmen[t].visible=!1;this.obmen_by_coef.length>1?(this.obmen.win.by1_mc.y=145,this.obmen.win.by2_mc.y=177,this.obmen.win.by2_mc.visible=!0):(this.obmen.win.by1_mc.y=160,this.obmen.win.by2_mc.visible=!1),helper.fadeAnimation(this.obmen.shadow_mc,"fadeIn",500,(()=>{helper.fadeAnimation(this.obmen.bg_mc,"fadeIn",1e3),gsap.to(this.obmen.win,{y:101,ease:"back.out(1.3)",duration:1,onComplete:()=>this.obmen_goanim=!1})})),this.obmen.win.give_scroll.x=this.obmen.win.take_scroll.x=this.obmen_startX,this.updObmen(),root.layer1_mc.addChild(this.obmen)}timerKalmar(){if(!this.kalmar.mobile.fight_mc.visible)return TIME>parseInt(udata.ftimer_kalmar)+parseInt(bosses[15].reload)&&this.req_count_kalm>=this.count_req_kalm?(this.kalmar.mobile.fight_mc.visible=Boolean(this.req_count_kalm>=this.count_req_kalm&&TIME>=kalmar.times[1]&&kalmar.times[2]>TIME&&TIME>parseInt(udata.ftimer_kalmar)+parseInt(bosses[15].reload)),void(this.kalmar.mobile.fight_blow_mc.visible=!1)):void(this.kalmar.mobile.fight_blow_mc.time_txt.text=helper.timeString(parseInt(udata.ftimer_kalmar)+parseInt(bosses[15].reload)-TIME))}initKalmar(t){kalmar=t,modules.checkFlags(["menu","fights","notify"],(()=>TS.php("fights.check",{},(t=>this.menuKalmar(t)),rootClass.onError)))}init23Feb(){helper.fadeAnimation(this.feb23.shadow_mc,"fadeIn",500,(()=>{gsap.to(this.feb23.box_mc,{y:101,ease:"back.out(1.3)",duration:1,onComplete:()=>this.kalmar_goanim=!1})})),this.feb23.box_mc.count0_txt.text="+"+helper.shortText(febr23.box[0].count),this.feb23.box_mc.count1_txt.text="+"+helper.shortText(febr23.box[1].count),this.feb23.box_mc.count2_txt.text="+"+helper.shortText(febr23.box[2].count),this.feb23.box_mc.price0_txt.text=helper.shortText(febr23.box[0].price),this.feb23.box_mc.price1_txt.text=helper.shortText(febr23.box[1].price),this.feb23.box_mc.price2_txt.text=helper.shortText(febr23.box[2].price),this.feb23.box_mc.automat_txt.text=udata.automat,root.layer1_mc.addChild(this.feb23)}menuKalmar(t){"fight"!==t.service.status||15!=t.boss.bid?(helper.fadeAnimation(this.kalmar.shadow_mc,"fadeIn",500,(()=>{gsap.to(this.kalmar.mobile,{y:101,ease:"back.out(1.3)",duration:1,onComplete:()=>this.kalmar_goanim=!1})})),this.kalmar_menu_modes=0,this.kalmar_modes_info=[["Завалить "+(kalmar.wanted[0]-kalmar.counters[0]>0?kalmar.wanted[0]-kalmar.counters[0]:0)+" местных боссов"],["Завалить "+(kalmar.wanted[0]-kalmar.counters[0]>0?kalmar.wanted[0]-kalmar.counters[0]:0)+" местных боссов","Завалить "+(kalmar.wanted[1]-kalmar.counters[1]>0?kalmar.wanted[1]-kalmar.counters[1]:0)+" залетных боссов"],["Завалить "+(kalmar.wanted[0]-kalmar.counters[0]>0?kalmar.wanted[0]-kalmar.counters[0]:kalmar.wanted[0])+" местных боссов","Завалить "+(kalmar.wanted[1]-kalmar.counters[1]>0?kalmar.wanted[1]-kalmar.counters[1]:kalmar.wanted[1])+" залетных боссов","Завалить "+(kalmar.wanted[2]-kalmar.counters[2]>0?kalmar.wanted[2]-kalmar.counters[2]:kalmar.wanted[2])+" подражателей"]],this.kalmar_mode=["Обычный режим","Пацанский режим","Авторитетный режим"],this.constructorInfoKalmar(),root.layer1_mc.addChild(this.kalmar)):main_menu.fightStatus(t)}menuKalmarNext(){this.kalmar_menu_modes+1<kalmar.wanted.length&&(this.kalmar_menu_modes++,this.constructorInfoKalmar())}menuKalmarPrev(){this.kalmar_menu_modes>0&&(this.kalmar_menu_modes--,this.constructorInfoKalmar())}constructorInfoKalmar(){this.kalmar.mobile.mode_txt.text=this.kalmar_mode[this.kalmar_menu_modes],this.count_req_kalm=0,this.req_count_kalm=0;let t=[this.kalmar.mobile.req0_icon,this.kalmar.mobile.req1_icon,this.kalmar.mobile.req2_icon];for(let t=0;t<this.kalmar_modes_info[this.kalmar_menu_modes].length;t++)this.count_req_kalm++;this.kalmar.mobile.info_txt.text="Условия нападения ("+this.count_req_kalm+" из "+this.kalmar_modes_info.length+"):",this.kalmar.mobile.req0_txt.text=this.kalmar_modes_info[2][0],this.kalmar.mobile.req1_txt.text=this.kalmar_modes_info[2][1],this.kalmar.mobile.req2_txt.text=this.kalmar_modes_info[2][2];for(let e=0;e<kalmar.wanted.length;e++)kalmar.counters[e]>=kalmar.wanted[e]&&this.req_count_kalm++,t[e].gotoAndStop(kalmar.counters[e]>=kalmar.wanted[e]?1:0);this.kalmar.mobile.fight_mc.visible=Boolean(this.req_count_kalm>=this.count_req_kalm&&TIME>=kalmar.times[1]&&kalmar.times[2]>TIME&&TIME>parseInt(udata.ftimer_kalmar)+parseInt(bosses[15].reload)),this.kalmar.mobile.fight_blow_mc.visible=!1,TIME<parseInt(udata.ftimer_kalmar)+parseInt(bosses[15].reload)&&this.req_count_kalm>=this.count_req_kalm&&(this.kalmar.mobile.fight_blow_mc.visible=!0,this.kalmar.mobile.fight_not_mc.on("mouseover",(()=>this.kalmar.mobile.fight_blow_mc.alpha=1)),this.kalmar.mobile.fight_not_mc.on("mouseout",(()=>this.kalmar.mobile.fight_blow_mc.alpha=0)),TIMERS.timers.custom.init=!0,TIMERS.timers.custom.tick.push((()=>this.timerKalmar())))}closeMenuKalmar(){this.kalmar_goanim||(this.kalmar.mobile.y=-339,this.kalmar.shadow_mc.alpha=.01,root.layer1_mc.removeChild(this.kalmar))}closeBoxFeb23(){this.kalmar_goanim||(this.feb23.box_mc.y=-339,this.feb23.shadow_mc.alpha=.01,root.layer1_mc.removeChild(this.feb23))}stopObmen(){this.obmen_goanim||(this.obmen.win.y=-339,this.obmen.shadow_mc.alpha=.01,root.layer1_mc.removeChild(this.obmen))}updObmen(){this.obmen_realvalue=1+parseInt((this.obmen.win.give_scroll.x-this.obmen_startX)/this.obmen_endX*100);for(let t=0;t<this.obmen_by_coef.length;t++)"weapon0"==this.obmen_vals[this.obmen_vals.length-1]||"weapon1"==this.obmen_vals[this.obmen_vals.length-1]||"weapon2"==this.obmen_vals[this.obmen_vals.length-1]||"weapon3"==this.obmen_vals[this.obmen_vals.length-1]?this.obmen.win["by"+(t+1)+"_mc"].tf_txt.text=helper.shortText(this.obmen_by_coef[t]*this.obmen_realvalue):this.obmen.win["by"+(t+1)+"_mc"].tf_txt.text=this.obmen_by_coef[t]*this.obmen_realvalue,this.obmen.win["by"+(t+1)+"_mc"].val.gotoAndStop(this.obmen_vals[t]);this.obmen.win.to_mc.val.gotoAndStop(this.obmen_vals[this.obmen_vals.length-1]),"weapon0"==this.obmen_vals[this.obmen_vals.length-1]||"weapon1"==this.obmen_vals[this.obmen_vals.length-1]||"weapon2"==this.obmen_vals[this.obmen_vals.length-1]||"weapon3"==this.obmen_vals[this.obmen_vals.length-1]?this.obmen.win.to_mc.tf_txt.text=helper.shortText(this.obmen_to_coef*this.obmen_realvalue):this.obmen.win.to_mc.tf_txt.text=this.obmen_to_coef*this.obmen_realvalue}downObmen(t){this.obmen_bool=!0,this.obmen_downX=t.data.global.x-this.obmen.win.take_scroll.worldTransform.tx}updPosition(t){this.obmen.win.give_scroll.x=this.obmen.win.take_scroll.x=this.obmen_startX-(this.obmen_startX+this.obmen.win.x-t.data.global.x),this.updObmen()}obmenVal(){TS.php("users.buyCoins",{id:Math.abs(this.obmen_realvalue)},(t=>{udata.gold=t.gold,udata.coins=t.coins,this.showChotko(),this.updateUp()}),rootClass.onError)}obmenTcoin(){}showChotko(){let t=helper.randomChotko(),e=helper.duplicate(this.chotko);e.parent||root.layer1_mc.addChild(e),sounds.playChotko(),e.alpha=0,e.visible=!0,e.rotation=t.rotation*(Math.PI/180),e.x=t.x,e.y=t.y,gsap.to(e,{x:t.newX,y:t.newY,duration:.3,onComplete:()=>{gsap.to(e,{x:t.x,y:t.y,duration:1,onComplete:()=>{root.layer1_mc.removeChild(e)}})}}),helper.fadeAnimation(e,"fadeIn",200)}updateEnergy(t){let e=t=>{let e=parseInt(t/60);t%=60,e%=60,this.up.enblow_mc.this_txt.text=helper.getNumberRazdel(udata.energy)+" (+1 через "+helper.getZeros(e)+":"+helper.getZeros(t)+")"};switch(t.status){case"max":helper.numberAnimation(this.up.energy_txt,udata.energy,100),this.up.enblow_mc.this_txt.text=helper.getNumberRazdel(udata.energy)+" (максимум)";break;case"plus":helper.numberAnimation(this.up.energy_txt,udata.energy,100),e(t.time);break;case"tick":e(t.time)}}updateUp(){let t=helper.getLevel(udata.exp),e=0;udata.level=t,0==this.old_level&&(this.old_level=t),this.old_level<t&&(udata.etime=0,udata.semki=parseInt(udata.semki).toString(),sounds.playKrasava(),modules.checkFlags(["notify"],(()=>notify.showNewLevel()))),this.old_level=t,this.up.level_txt.text=t.toString(),this.up.enblow_mc.max_txt.text=parseInt(udata.emax)+parseInt(udata.emax_bonus),levels[t]?(this.up.blow_mc.next_txt.text=helper.shortText(parseInt(levels[t])-parseInt(udata.exp)),this.up.blow_mc.this_txt.text=helper.shortText(parseInt(udata.exp))+"/"+helper.shortText(parseInt(levels[t])),e=(parseInt(udata.exp)-parseInt(levels[t-1]))/(parseInt(levels[t])-parseInt(levels[t-1]))):(this.up.blow_mc.next_txt.text="Максимальный",this.up.blow_mc.this_txt.text=helper.shortText(parseInt(udata.exp))+"/"+helper.shortText(parseInt(levels[t-1])),e=1),this.up.enblow_mc.time_txt.text=udata.energytimer+" сек.",helper.numberAnimation(this.up.coins_txt,udata.coins,100),helper.numberAnimation(this.up.rubles_txt,udata.gold,100),helper.numberAnimation(this.up.semki_txt,udata.semki,100),helper.numberAnimation(this.up.energy_txt,udata.energy,100),helper.numberAnimation(this.up.conserve_txt,udata.t_coin,100),this.up.conserve_blow.t_coin_blow.text=helper.getNumberRazdel(udata.t_coin),this.up.semki_blow.semki_blow.text=helper.getNumberRazdel(udata.semki),this.up.coins_blow.coins_blow.text=helper.getNumberRazdel(udata.coins),this.up.gold_blow.gold_blow.text=helper.getNumberRazdel(udata.gold),helper.scaleAnimation(this.up.line_mc.line,e,300)}clickBack(){switch(-1==helper.backLocation()&&this.hideBack(),HYSTORY[HYSTORY.length-1]){case 0:modules.checkFlags(["menu"],(()=>main_menu.toHome()));break;case 1:modules.checkFlags(["menu"],(()=>iface.toMenu()));break;case 2:modules.checkFlags(["menu","city"],(()=>main_menu.toCity()));break;case 3:modules.checkFlags(["menu","city"],(()=>map.toLocation()));break;case 4:this.removeStage(),guest.init(),this.showIcons();break;case 5:main_menu.toDoping();break;case 6:main_menu.toArmor();break;case 7:main_menu.toShop();break;case 8:main_menu.toNaperstki();break;case 9:main_menu.toFight();break;case 10:this.toATM();break;case 11:main_menu.toGarage();break;case 12:main_menu.toKNB();break;case 13:garage.toFlower();break;case 14:city.toWorks()}}hideIcons(){810!=this.down.icons_mc.x&&gsap.to(this.down.back_pn,{duration:.1,y:50,onComplete:()=>{gsap.to(this.down.icons_mc,{duration:.7,x:810,onComplete:()=>{gsap.to(this.down.back_pn,{duration:.1,y:-16})}})}})}showIcons(){this.down.icons_mc.x<200||gsap.to(this.down.back_pn,{duration:.1,y:50,onComplete:()=>{gsap.to(this.down.icons_mc,{duration:.7,ease:"bounce.out",x:157,onComplete:()=>{gsap.to(this.down.back_pn,{duration:.1,y:-16})}})}})}removeStage(){for(;root.layer0_mc.children.length;)root.layer0_mc.removeChildAt(0)}showBack(){28!=this.down.back_pn.back_mc.x&&gsap.to(this.down.back_pn.back_mc,{duration:.3,x:28})}hideBack(){gsap.to(this.down.back_pn.back_mc,{duration:.3,x:128})}onError(t){modules.checkFlags(["notify"],(()=>iface.checkError(t)))}checkError(t){switch(t.code){case 5:notify.showNoEnergy();break;case 7:notify.showNoMoney();break;default:notify.showResult(t)}}initStyles(){setTextStyle(this.up.name_txt,{dropShadow:!0,dropShadowAngle:90,dropShadowColor:"#000000",dropShadowDistance:2,dropShadowAlpha:.15}),setTextStyle(this.up.level_txt,{dropShadow:!0,dropShadowAngle:90,dropShadowColor:"#000000",dropShadowDistance:2,dropShadowAlpha:.15}),setTextStyle(this.up.semki_txt,{dropShadow:!0,dropShadowAngle:90,dropShadowColor:"#000000",dropShadowDistance:2,dropShadowAlpha:.15}),setTextStyle(this.up.coins_txt,{dropShadow:!0,dropShadowAngle:90,dropShadowColor:"#000000",dropShadowDistance:2,dropShadowAlpha:.15}),setTextStyle(this.up.rubles_txt,{dropShadow:!0,dropShadowAngle:90,dropShadowColor:"#000000",dropShadowDistance:2,dropShadowAlpha:.15}),setTextStyle(this.up.energy_txt,{dropShadow:!0,dropShadowAngle:45,dropShadowColor:"#000000",dropShadowDistance:2,dropShadowAlpha:.15}),setTextStyle(this.up.blow_mc.this_txt,{dropShadow:!0,dropShadowAngle:45,dropShadowColor:"#000000",dropShadowDistance:.5,dropShadowAlpha:1}),setTextStyle(this.up.blow_mc.next_txt,{dropShadow:!0,dropShadowAngle:45,dropShadowColor:"#000000",dropShadowDistance:.5,dropShadowAlpha:1}),setTextStyle(this.up.enblow_mc.this_txt,{dropShadow:!0,dropShadowAngle:45,dropShadowColor:"#000000",dropShadowDistance:.35,dropShadowAlpha:1}),setTextStyle(this.up.enblow_mc.max_txt,{dropShadow:!0,dropShadowAngle:45,dropShadowColor:"#000000",dropShadowDistance:.35,dropShadowAlpha:1}),setTextStyle(this.up.enblow_mc.time_txt,{dropShadow:!0,dropShadowAngle:45,dropShadowColor:"#000000",dropShadowDistance:.35,dropShadowAlpha:1}),setTextStyle(this.up.dop_info.stats_mc.name_txt,{dropShadow:!0,dropShadowAlpha:.43,dropShadowAngle:120,dropShadowColor:"#000000",dropShadowBlur:2,dropShadowDistance:2}),setTextStyle(this.up.dop_info.stats_mc.exp_txt,{dropShadow:!0,dropShadowAlpha:.43,dropShadowAngle:120,dropShadowColor:"#000000",dropShadowBlur:2,dropShadowDistance:2}),setTextStyle(this.up.dop_info.stats_mc.mandats_txt,{dropShadow:!0,dropShadowAlpha:.43,dropShadowAngle:120,dropShadowColor:"#000000",dropShadowBlur:2,dropShadowDistance:2})}initButtons(){setButton(this.obmen.win.close_mc),setButton(this.obmen.win.butt_mc),setButton(this.obmen.win.line1_mc),setButton(this.obmen.win.line2_mc),setButton(this.obmen.win.give_scroll),setButton(this.obmen.win.take_scroll),setButton(this.up.edit_mc),setButton(this.up.line_mc.butt),setButton(this.up.coins_mc),setButton(this.up.semki_mc),setButton(this.up.gold_mc),setButton(this.up.conserve_mc),setButton(this.up.energy_mc),setButton(this.new_name.win.butt_mc),setButton(this.down.back_pn.back_mc),setButton(this.down.top.next_mc),setButton(this.down.top.prev_mc),setButton(this.down.top.start_mc),setButton(this.down.top.end_mc),setButton(this.down.dop_info.top_mc.alltop_butt),setButton(this.down.dop_info.top_mc.frtop_butt),setButton(this.down.top.invite_mc.butt),setButton(this.reg_music.win.music_scroll),setButton(this.reg_music.win.sound_scroll),setButton(this.reg_music.win.butt_mc),setButton(this.reg_music.win.music_line),setButton(this.reg_music.win.sound_line),setButton(this.reg_music.win.canvas_btn),setButton(this.reg_music.win.preload_btn),setButton(this.screen_shot.big_mc.butt_mc),setButton(this.screen_shot.big_mc.nosave_txt),setButton(this.down.dop_info.buttons_mc.shmon_mc),setButton(this.down.dop_info.buttons_mc.guest_mc),setButton(this.down.dop_info.buttons_mc.fight_mc),setButton(this.down.dop_info.buttons_mc.post_mc),setButton(this.down.tooltip_mc.buttons_mc.shmon_mc),setButton(this.down.tooltip_mc.buttons_mc.guest_mc),setButton(this.down.tooltip_mc.buttons_mc.fight_mc),setButton(this.down.tooltip_mc.buttons_mc.post_mc),setButton(this.down.search_mc),setButton(this.obmen.win.obmen_all_mc),setButton(this.kalmar.mobile.close_mc),setButton(this.kalmar.mobile.fight_mc),setButton(this.kalmar.mobile.fight_not_mc),setButton(this.kalmar.mobile.prev_mode_mc),setButton(this.kalmar.mobile.next_mode_mc)}initMasks(){let t=new PIXI.Graphics;t.beginFill(),t.drawRoundedRect(325,-6,86,13,5),t.endFill(),this.up.line_mc.addChild(t),this.up.line_mc.line.mask=t;let e=new PIXI.Graphics;e.beginFill(),e.drawRoundedRect(15,19,35,32,5),e.endFill(),this.down.top.invite_mc.addChild(e),this.down.top.invite_mc.photo_mc.mask=e;let s=new PIXI.Graphics;s.beginFill(),s.drawRect(26,38,590,73),s.endFill(),this.down.top.addChild(s),this.down.top.topMov.mask=s}initTopSlot(t){let e=helper.duplicate(t),s=new PIXI.Graphics;return s.beginFill(),s.drawRoundedRect(8,13,43,39,5),s.endFill(),e.addChild(s),e.loader_mc.mask=s,e}}class e{constructor(t,e,s,i,o,a){this.padik=t,this.bgs=e,this.top=s,this.top_slot=i,this.cust=o,this.cust_slot=a,this.cust_cats=[this.cust.win.cat0_mc,this.cust.win.cat1_mc],this.cust_cat=0,this.cust_slots=[],this.wears=[this.padik.pers_mc.wear0,this.padik.pers_mc.wear1,this.padik.pers_mc.wear2,this.padik.pers_mc.wear3,this.padik.pers_mc.wear4],this.initUnics(),this.initButtons(),this.top20_goanim=!1,this.top20_i=!1,this.top20_data=[],this.top20_slots=[],this.top20_loaders=[],this.pereezd_bg=0,this.new_bb=!1,this.top_type="def",this.gifts_page=0,this.gifts_slots=[],this.padik.top20_mc.icon_mc.on("mouseover",(t=>this.iconScaleIn(t))),this.padik.top20_mc.icon_mc.on("mouseout",(t=>this.iconScaleOut(t))),this.padik.ach_mc.icon_mc.on("mouseover",(t=>this.iconScaleIn(t))),this.padik.ach_mc.icon_mc.on("mouseout",(t=>this.iconScaleOut(t))),this.padik.pereezd_mc.icon_mc.on("mouseover",(t=>this.iconScaleIn(t))),this.padik.pereezd_mc.icon_mc.on("mouseout",(t=>this.iconScaleOut(t))),this.padik.cal_mc.icon_mc.on("mouseover",(t=>this.iconScaleIn(t))),this.padik.cal_mc.icon_mc.on("mouseout",(t=>this.iconScaleOut(t))),this.top.win.arrows_mc.prev_bt.on("pointerdown",(()=>this.top20Prev())),this.top.win.arrows_mc.next_bt.on("pointerdown",(()=>this.top20Next())),helper.clickControl(this.padik.cal_mc.icon_mc,null,(()=>calendar.showCalendar())),this.padik.ach_mc.icon_mc.on("pointerdown",(()=>{achives.lvls=udata.achives_level,achives.mode="user",achives.showAchives()})),this.padik.kalmar_mc.on("pointerdown",(()=>helper.getJSON(my_server+"/json/cache/calmar_ivent.json?hash="+md5(Math.random().toString()),(t=>iface.initKalmar(t)),rootClass.onError))),this.padik.top20_mc.icon_mc.on("pointerdown",(()=>{this.top_type="def",helper.alphaAnimation(this.top.win.top_don_check,0,300),helper.getJSON(my_server+"/json/cache/top20.json?hash="+md5(Math.random().toString()),(t=>this.showTop20(t)),rootClass.onError)})),this.top.win.close_mc.on("pointerdown",(()=>root.layer1_mc.removeChild(this.top))),this.top.win.top_don_mc.on("pointerdown",(()=>{"def"==this.top_type?(helper.alphaAnimation(this.top.win.top_don_check,1,300),this.top_type="don",helper.getJSON(my_server+"/json/cache/top20_don.json?hash="+md5(Math.random().toString()),(t=>this.showTop20(t)),rootClass.onError)):(helper.alphaAnimation(this.top.win.top_don_check,0,300),this.top_type="def",helper.getJSON(my_server+"/json/cache/top20.json?hash="+md5(Math.random().toString()),(t=>this.showTop20(t)),rootClass.onError))})),this.cust.win.close_mc.on("pointerdown",(()=>root.layer1_mc.removeChild(this.cust))),this.padik.podarok_mc.on("pointerdown",(()=>modules.checkFlags(["coll"],(()=>this.showGiftLog())))),this.padik.pereezd_mc.icon_mc.on("pointerdown",(()=>this.showPereezd())),this.padik.pereezd_panel.cancel_btn.on("pointerdown",(()=>this.hidePereezd())),this.padik.pereezd_panel.next_btn.on("pointerdown",(()=>this.nextPereezd())),this.padik.pereezd_panel.prev_btn.on("pointerdown",(()=>this.prevPereezd())),this.padik.pereezd_panel.go_btn.on("pointerdown",(()=>TS.php("users.pereezd",{bg:this.pereezd_bg},(t=>this.successPereezd(t)),(()=>rootClass.onError)))),this.top.interactive=this.padik.pereezd_panel.interactive=this.cust.interactive=!0,this.textField=new PIXI.TextInput({input:{fontFamily:"Trebuchet MS",fontSize:"14px",width:"148px",height:"63px",textAlign:"center",padding:0,color:"#000000",maxLength:42,multiline:!0}}),this.padik.blow_mc.input_txt.addChild(this.textField),this.textField.on("focus",(()=>{this.padik.blow_mc.alpha=1,this.padik.blow_mc.buttons_mc.visible=!0})),this.textField.on("blur",(()=>{this.new_bb||this.blurTF()})),this.padik.blow_mc.buttons_mc.close_mc.on("pointerdown",(()=>this.blurTF())),this.padik.blow_mc.buttons_mc.ok_mc.on("pointerdown",(()=>this.newBalabol()));for(let t=0;t<5;t++)helper.blowController("home_cat"+t,[this.padik.pers_mc["cat"+t+"_btn"]],this.padik.pers_mc["cat"+t+"_mc"]),this.padik.pers_mc["cat"+t+"_btn"].on("pointerdown",(()=>modules.checkFlags(["menu","shop"],(()=>{shop.category=t,main_menu.toShop("cat")}))));for(let t=0;t<this.cust_cats.length;t++)this.cust_cats[t].interactive=this.cust_cats[t].buttonMode=!0,this.cust_cats[t].on("pointerdown",(()=>{this.cust_cat=t,this.customCat()}));TIMERS.timers.custom.init=!0,TIMERS.timers.custom.tick.push((()=>this.updBronikTimers())),TIMERS.timers.custom.tick.push((()=>this.updKalmarTimers())),TIMERS.timers.custom.tick.push((()=>this.updCheckCalendar())),TIMERS.timers.custom.tick.push((()=>helper.bgConstructor(this.bgs,udata)))}updBronikTimers(){if(bronik_out.time+604800<TIME)return void(this.padik.bronikout_mc.timer_txt.text="Обнови игру\nчтобы затикал");let t=helper.checkLastDate(bronik_out.days[0],bronik_out.days[0]),e=helper.checkLastDate(bronik_out.days[1],bronik_out.days[1]),s=!1,i=!1;return t[0]>TIME&&t[1]>TIME&&(s=!1),t[1]>TIME&&(t[0]>t[1]||TIME>t[0])?(this.padik.bronikout_mc.timer_txt.text="Истекает через:\n"+helper.timeString(t[1]-TIME),void(s=!0)):(e[0]>TIME&&e[1]>TIME&&(i=!1),e[1]>TIME&&(e[0]>e[1]||TIME>e[0])?(this.padik.bronikout_mc.timer_txt.text="Истекает через:\n"+helper.timeString(e[1]-TIME),void(i=!0)):void(s||i||(this.padik.bronikout_mc.timer_txt.text="Начнется через:\n"+helper.timeString((t[0]<e[0]?t[0]:e[0])-TIME))))}updKalmarTimers(){let t=kalmar.times[0],e=kalmar.times[1],s=kalmar.times[2];if(!(TIME>s))return t>TIME?void(this.padik.kalmar_mc.tf_txt.text="Активация через:\n"+helper.timeString(t-TIME)):e>TIME?void(this.padik.kalmar_mc.tf_txt.text="Начнется через:\n"+helper.timeString(e-TIME)):void(this.padik.kalmar_mc.tf_txt.text="Закончится через:\n"+helper.timeString(s-TIME));this.padik.kalmar_mc.tf_txt.text="Обнови игру\nчтобы затикал"}updCheckCalendar(){calendar.calendar.parent||calendar.getDateInfo(),this.padik.cal_mc.icon_mc.check_complete_cal.alpha=calendar.calendar.win.taked_mc.alpha}init(){for(helper.goLocation(0),this.blurTF();this.padik.back_mc.children.length;)this.padik.back_mc.removeChildAt(0);this.bgs=helper.duplicate(this.bgs),this.bgs.gotoAndStop(parseInt(udata.bg)),this.padik.pers_mc.x=332,5==parseInt(udata.bg)&&(this.padik.pers_mc.x=350),this["constructBG"+udata.bg]&&this["constructBG"+udata.bg](),helper.bgConstructor(this.bgs,udata),this.padik.back_mc.addChild(this.bgs),this.padik.page_mc.visible=!1,this.padik.want_col.visible=!1,this.padik.ach_mc.visible=this.padik.top20_mc.visible=this.padik.podarok_mc.visible=this.padik.bronikout_mc.visible=this.padik.pereezd_mc.visible=this.padik.cal_mc.visible=this.padik.kalmar_mc.visible=!0,this.padik.pereezd_panel.visible=!1,this.refreshWears(),this.padik.podarok_mc.point_mc.visible=Boolean(udata.gifts.length),root.layer0_mc.addChild(this.padik),learn.check()}constructBG4(){this.bgs.bg5.semki_mc.visible=this.bgs.bg5.butilka_mc.visible=this.bgs.bg5.energos_mc.visible=!1,setButton(this.bgs.bg5.wall_butt),setButton(this.bgs.bg5.semki_mc),setButton(this.bgs.bg5.butilka_mc),setButton(this.bgs.bg5.energos_mc),helper.clickControl(this.bgs.bg5.semki_mc,null,(()=>{TS.php("users.lootCustom",{key:"semki_mc"},(()=>{this.playCustomAnim(this.bgs.bg5.semki_blow,456,"semki")}),rootClass.onError)})),helper.clickControl(this.bgs.bg5.butilka_mc,null,(()=>{TS.php("users.lootCustom",{key:"butilka_mc"},(()=>{this.playCustomAnim(this.bgs.bg5.butilka_blow,399,"weapon2")}),rootClass.onError)})),helper.clickControl(this.bgs.bg5.energos_mc,null,(()=>{TS.php("users.lootCustom",{key:"energos_mc"},(()=>{this.playCustomAnim(this.bgs.bg5.energos_blow,70,"energy")}),rootClass.onError)})),this.bgs.bg5.wall_butt.on("mouseover",(()=>helper.alphaAnimation(this.bgs.bg5.wall_int,1))),this.bgs.bg5.wall_butt.on("mouseout",(()=>helper.alphaAnimation(this.bgs.bg5.wall_int,0))),this.bgs.bg5.wall_butt.on("pointerdown",(()=>this.showCustom()))}playCustomAnim(t,e,s){helper.fadeAnimation(t,"fadeIn",500),t.gotoAndStop(s),gsap.to(t,{y:e-20,duration:.5,onComplete:()=>{helper.fadeAnimation(t,"fadeOut",200),helper.bgConstructor(this.bgs,udata),achives.refresh(),iface.updateUp(),iface.showChotko()}})}showCustom(){this.cust.shadow_mc.alpha=0,this.cust_cat=0,helper.alphaAnimation(this.cust.shadow_mc,1,300),this.customCat(),this.cust.parent||root.layer1_mc.addChild(this.cust)}customCat(){for(let t=0;t<this.cust_cats.length;t++)this.cust_cats[t].gotoAndStop(this.cust_cat!==t?0:1);for(;this.cust.win.slots_mc.children.length;)this.cust.win.slots_mc.removeChildAt(0);this.cust_slots=[];let t=bgs_info.bgs[udata.bg].shop[this.cust_cat];for(let e=0;e<t.length;e++){let s=helper.duplicate(this.cust_slot),i=Math.floor(e/3);if(s.photo_knp_mc.photo_mc.gotoAndStop(t[e]),udata.bgs_info[udata.bg]=udata.bgs_info[udata.bg]||[],udata.bgs_info[udata.bg][bgs_info.shop[t[e]].key]=udata.bgs_info[udata.bg][bgs_info.shop[t[e]].key]||[],udata.bgs_info[udata.bg][bgs_info.shop[t[e]].key][bgs_info.shop[t[e]].subkey]=udata.bgs_info[udata.bg][bgs_info.shop[t[e]].key][bgs_info.shop[t[e]].subkey]||0,udata.bgs_info[udata.bg][bgs_info.shop[t[e]].key].level=udata.bgs_info[udata.bg][bgs_info.shop[t[e]].key].level||1,s.price_txt.text="v"==bgs_info.shop[t[e]].subkey?bgs_info.shop[t[e]].price[udata.bgs_info[udata.bg][bgs_info.shop[t[e]].key].level]?helper.shortText(bgs_info.shop[t[e]].price[udata.bgs_info[udata.bg][bgs_info.shop[t[e]].key].level]):helper.shortText(bgs_info.shop[t[e]].price[parseInt(udata.bgs_info[udata.bg][bgs_info.shop[t[e]].key].level)-1]):helper.shortText(bgs_info.shop[t[e]].price),s.icon_levels.levels_txt.text=udata.bgs_info[udata.bg][bgs_info.shop[t[e]].key].level,"v"==bgs_info.shop[t[e]].subkey&&udata.bgs_info[udata.bg][bgs_info.shop[t[e]].key].level?s.icon_levels.visible=!0:s.icon_levels.visible=!1,"v"==bgs_info.shop[t[e]].subkey){s.up_blow_bonus_mc.name_txt.text=s.blow_bonus_mc.name_txt.text=bgs_info.shop[t[e]].name,s.up_blow_bonus_mc.descrp_txt.text=s.blow_bonus_mc.descrp_txt.text=bgs_info.shop[t[e]].description;let i=(parseInt(bgs_info.shop[t[e]].bonus.timing[udata.bgs_info[udata.bg][bgs_info.shop[t[e]].key].level-1])-parseInt(udata.mandat_bonuses_custom))/60/60;if(s.up_blow_bonus_mc.bonus_txt.text=s.blow_bonus_mc.bonus_txt.text=bgs_info.shop[t[e]].bonus.value[udata.bgs_info[udata.bg][bgs_info.shop[t[e]].key].level-1]+" в "+i+" "+helper.numberEndFlower(i,"hours"),udata.bgs_info[udata.bg][bgs_info.shop[t[e]].key][bgs_info.shop[t[e]].subkey]==bgs_info.shop[t[e]].value){let i=(parseInt(bgs_info.shop[t[e]].bonus.timing[udata.bgs_info[udata.bg][bgs_info.shop[t[e]].key].level])-parseInt(udata.mandat_bonuses_custom))/60/60;s.up_blow_bonus_mc.bonus_txt.text=bgs_info.shop[t[e]].bonus.value[udata.bgs_info[udata.bg][bgs_info.shop[t[e]].key].level]+" в "+i+" "+helper.numberEndFlower(i,"hours")}udata.bgs_info[udata.bg][bgs_info.shop[t[e]].key].timer+bgs_info.shop[t[e]].bonus.timing[udata.bgs_info[udata.bg][bgs_info.shop[t[e]].key].level-1]>TIME?(s.blow_bonus_mc.time_txt.text=helper.timeString(udata.bgs_info[udata.bg][bgs_info.shop[t[e]].key].timer+(bgs_info.shop[t[e]].bonus.timing[udata.bgs_info[udata.bg][bgs_info.shop[t[e]].key].level-1]-udata.mandat_bonuses_custom)-TIME),TIMERS.timers.custom.init=!0,TIMERS.timers.custom.tick.push((()=>{s.blow_bonus_mc.time_txt.text=helper.timeString(udata.bgs_info[udata.bg][bgs_info.shop[t[e]].key].timer+(bgs_info.shop[t[e]].bonus.timing[udata.bgs_info[udata.bg][bgs_info.shop[t[e]].key].level-1]-udata.mandat_bonuses_custom)-TIME)}))):s.blow_bonus_mc.time_txt.text="готово",s.upgrade_mc.on("mouseover",(()=>helper.alphaAnimation(s.up_blow_bonus_mc,1))),s.upgrade_mc.on("mouseout",(()=>helper.alphaAnimation(s.up_blow_bonus_mc,0))),s.buy_mc.on("mouseover",(()=>helper.alphaAnimation(s.up_blow_bonus_mc,1))),s.buy_mc.on("mouseout",(()=>helper.alphaAnimation(s.up_blow_bonus_mc,0))),udata.bgs_info[udata.bg][bgs_info.shop[t[e]].key][bgs_info.shop[t[e]].subkey]==bgs_info.shop[t[e]].value&&(setButton(s.photo_knp_mc),s.photo_knp_mc.on("mouseover",(()=>helper.alphaAnimation(s.blow_bonus_mc,1))),s.photo_knp_mc.on("mouseout",(()=>helper.alphaAnimation(s.blow_bonus_mc,0))))}udata.bgs_info[udata.bg][bgs_info.shop[t[e]].key][bgs_info.shop[t[e]].subkey]==bgs_info.shop[t[e]].value?(udata.bgs_info[udata.bg][bgs_info.shop[t[e]].key].level!=bgs_info.shop[t[e]].price.length&&"f"!=bgs_info.shop[t[e]].subkey||(s.buy_ico.alpha=1,s.upgrade_mc.visible=!1),s.buy_mc.visible=!1):s.icon_levels.visible=!1,setButton(s.buy_mc),setButton(s.upgrade_mc),s.buy_mc.on("pointerdown",(()=>{TS.php("users.buyCustom",{id:t[e],cat:this.cust_cat},(t=>this.onBuyCustom(t)),rootClass.onError)})),s.upgrade_mc.on("pointerdown",(()=>{TS.php("users.buyCustom",{id:t[e],cat:this.cust_cat},(t=>this.onBuyCustom(t)),rootClass.onError)})),s.x=116*(e-3*i),this.cust_slots.push(s)}for(let t=this.cust_slots.length-1;t>=0;t--)this.cust.win.slots_mc.addChild(this.cust_slots[t]);this.cust.win.price_txt.text=helper.shortText(udata.birds)}onBuyCustom(){helper.bgConstructor(this.bgs,udata),this.customCat()}blurTF(){this.padik.blow_mc.buttons_mc.visible=!1,this.textField.text=helper.decode64(udata.balabol),""==helper.decode64(udata.balabol)&&(this.padik.blow_mc.alpha=.01)}newBalabol(){this.new_bb=!0,TS.php("users.newBalabol",{name:helper.encode64(this.textField.text)},(()=>this.onNewBalabol()),rootClass.onError),this.padik.blow_mc.buttons_mc.visible=!1}onNewBalabol(){udata.balabol=helper.encode64(this.textField.text),udata.semki-=15,this.new_bb=!1,""==helper.decode64(udata.balabol)&&(this.padik.blow_mc.alpha=.01),iface.updateUp()}showPereezd(){iface.hideIcons(),this.pereezd_bg=parseInt(udata.bg),this.padik.ach_mc.visible=this.padik.top20_mc.visible=this.padik.bronikout_mc.visible=this.padik.pereezd_mc.visible=this.padik.podarok_mc.visible=this.padik.cal_mc.visible=this.padik.kalmar_mc.visible=!1,helper.fadeAnimation(this.padik.pereezd_panel,"fadeIn",500),this.pereezdInfo()}hidePereezd(){iface.showIcons(),this.padik.ach_mc.visible=this.padik.top20_mc.visible=this.padik.bronikout_mc.visible=this.padik.podarok_mc.visible=this.padik.pereezd_mc.visible=this.padik.cal_mc.visible=this.padik.kalmar_mc.visible=!0,this.bgs.gotoAndStop(parseInt(udata.bg)),helper.fadeAnimation(this.padik.pereezd_panel,"fadeOut",500)}successPereezd(t){udata.bg=t.bg,this.padik.pers_mc.x=332,5==parseInt(udata.bg)&&(this.padik.pers_mc.x=350),helper.bgConstructor(this.bgs,udata),this["constructBG"+udata.bg]&&this["constructBG"+udata.bg](),this.hidePereezd()}nextPereezd(){bgs_info.bgs.length-1!=this.pereezd_bg&&(this.pereezd_bg++,this.pereezdInfo())}prevPereezd(){0!=this.pereezd_bg&&(this.pereezd_bg--,this.pereezdInfo())}pereezdInfo(){let t=udata.my_bgs;this.bgs.gotoAndStop(this.pereezd_bg),this.padik.pereezd_panel.go_btn.visible=t.indexOf(this.pereezd_bg)>=0&&parseInt(udata.bg)!==this.pereezd_bg,this.padik.pereezd_panel.name_txt.text=bgs_info.bgs[this.pereezd_bg].name,this.padik.pereezd_panel.want_txt.text=bgs_info.bgs[this.pereezd_bg].wanted}showGiftLog(){this.gifts_page=0,this.gifts_slots=[],this.gifts_log.win.close_mc._events.pointerdown||this.gifts_log.win.close_mc.on("pointerdown",(()=>this.hideGiftLog())),this.gifts_log.win.prev_mc._events.pointerdown||this.gifts_log.win.prev_mc.on("pointerdown",(()=>this.prevGiftPage())),this.gifts_log.win.next_mc._events.pointerdown||this.gifts_log.win.next_mc.on("pointerdown",(()=>this.nextGiftPage())),TS.php("users.get",{uid:vk_params.user_id,users:window.my_friends,hash:vk_params.hash,ads:vk_params.referrer.split("ad_")[1]},(t=>{this.constructGifts(),this.gifts_log.parent||root.layer1_mc.addChild(this.gifts_log)}),rootClass.onError)}constructGifts(){for(;this.gifts_log.win.slots_mc.children.length;)this.gifts_log.win.slots_mc.removeChildAt(0);this.gifts_log.win.page_txt.text=this.gifts_page+1+"/"+Math.ceil(udata.gifts.length/6),0==Math.ceil(udata.gifts.length/6)&&(this.gifts_log.win.page_txt.text="1/1");let t=[];this.gifts_slots=[];for(let e=0;e<udata.gifts.length-6*this.gifts_page&&e<6;e++){this.gifts_slots.push(helper.duplicate(this.gifts_log_slot));let s=this.gifts_slots[this.gifts_slots.length-1];s.y=51*e,setButton(s.take_mc),s.take_mc.on("pointerdown",(t=>TS.php("users.getGift",{id:this.gifts_slots.indexOf(t.currentTarget.parent)+6*this.gifts_page},(t=>this.onResultGift(t)),rootClass.onError))),this.showRightGift(s,udata.gifts[e+6*this.gifts_page]),udata.gifts[e+6*this.gifts_page].id&&(s.id=udata.gifts[e+6*this.gifts_page].id,-1==t.indexOf(s.id)&&t.push(s.id)),this.gifts_log.win.slots_mc.addChild(this.gifts_slots[this.gifts_slots.length-1])}helper.loadNames(t,(t=>{console.log(t);for(let e=0;e<this.gifts_slots.length;e++)if(this.gifts_slots[e].id)for(let s=0;s<t.length;s++)t[s].id==this.gifts_slots[e].id&&(this.gifts_slots[e].name_txt.text=t[s].first_name+" "+t[s].last_name.substr(0,1)+".",helper.loadPhoto50(t[s].id,(t=>this.gifts_slots[e].photo_mc.addChild(t)),t[s].photo_50),setButton(this.gifts_slots[e].photo_mc),this.gifts_slots[e].photo_mc.on("pointerdown",(()=>{iface.goGuest(this.gifts_slots[e].id),this.hideGiftLog()})));else this.gifts_slots[e].photo_mc.addChild(helper.duplicate(this.gifts_log_def_photo)),this.gifts_slots[e].name_txt.text="Игра Хулиганы"}))}onResultGift(t){t.cftOK&&modules.checkFlags(["menu","fights"],(()=>{fights_windows.showCraft(t.cftID)})),udata=t,achives.refresh(t.achives_level),udata.gifts.length/6<=this.gifts_page&&0!==this.gifts_page&&this.gifts_page--,this.constructGifts(),iface.showChotko(),iface.updateUp()}nextGiftPage(){udata.gifts.length/6<=this.gifts_page+1||(this.gifts_page++,this.constructGifts())}prevGiftPage(){0!=this.gifts_page&&(this.gifts_page--,this.constructGifts())}showRightGift(t,e){switch(t.coll_mc.visible=!1,t.semki_mc.visible=!1,t.gold_mc.visible=!1,t.weapons_mc.visible=!1,t.coins_mc.visible=!1,t.snow_mc.visible=!1,t.t_coin_mc.visible=!1,t.flower_chifir_mc.visible=!1,t.slot_machine_spins_mc.visible=!1,t.wear_mc.visible=!1,t.exp_mc.visible=!1,e.b){case"coll_items":t.coll_mc.visible=!0,t.coll_mc.gotoAndStop(e.v);break;case"weapons":let s=0;t.weapons_mc.visible=!0;for(let t=0;t<3;t++)e.v[t]&&(s=t);t.weapons_mc.icon_mc.gotoAndStop(s),t.weapons_mc.tf_txt.text=helper.shortText(e.v[s]);break;case"wear":t.wear_mc.visible=!0,t.wear_mc.tf_txt.text=helper.shortText(e.v.count);break;default:t[e.b+"_mc"].visible=!0,t[e.b+"_mc"].tf_txt.text=helper.shortText(e.v)}}hideGiftLog(){root.layer1_mc.removeChild(this.gifts_log),this.padik.podarok_mc.point_mc.visible=Boolean(udata.gifts.length)}refreshWears(){let t=JSON.parse(JSON.stringify(udata.mywears));this.wears=[this.padik.pers_mc.wear0,this.padik.pers_mc.wear1,this.padik.pers_mc.wear2,this.padik.pers_mc.wear3,this.padik.pers_mc.wear4];for(let e=0;e<t.length;e++)t[e]>=0&&wears.w[t[e]].layer_priority&&([this.wears[wears.w[t[e]].layer_priority[0]],this.wears[wears.w[t[e]].layer_priority[1]]]=[this.wears[wears.w[t[e]].layer_priority[1]],this.wears[wears.w[t[e]].layer_priority[0]]]);null==t[4]&&(t[4]=-1);for(let e=0;e<t.length;e++){for(;this.wears[e].children.length;)this.wears[e].removeChildAt(0);-1==t[e]?this.wears[e].addChild(helper.duplicate(stock_wears[e])):this.wears[e].addChild(shop_wears[t[e]])}}showTop20(t){this.top20_data=t,this.top20_i=!1,this.top.shadow_mc.alpha=this.top.shadow_box.alpha=0,this.top.win.y=-600,this.top.bg_mc.visible=!1,this.top20Form(),helper.fadeAnimation(this.top.shadow_mc,"fadeIn",300,(()=>{helper.fadeAnimation(this.top.bg_mc,"fadeIn",1e3),this.top.bg_mc.visible=!0,gsap.to(this.top.win,{y:101,duration:1,ease:"back.out(1.3)",onComplete:()=>{helper.fadeAnimation(this.top.shadow_box,"fadeIn",100)}})})),root.layer1_mc.addChild(this.top)}top20Form(){for(;this.top.win.slots_mc.children.length;)this.top.win.slots_mc.removeChildAt(0);this.top20_slots=[],this.top20_loaders=[],this.top20_data&&this.top20_data.top||(this.top20_data={top:[],time:0}),TIMERS.timers.top20.init||(TIMERS.timers.top20={init:!0,tick:t=>this.tickTop20(t)}),this.tickTop20(TIMERS.top20Control());let t=[];for(let e=0;e<this.top20_data.top.length;e++){let s=helper.duplicate(this.top_slot);s.i_mc.visible=!1,s.name_txt.text=helper.decode64(this.top20_data.top[e].name);let i="top_dmg";"don"==this.top_type&&(i="top_dmg_don"),s.want_txt.text="Нанес "+helper.getNumber(this.top20_data.top[e][i])+" урона за неделю",s.want_mc.num_exp_mc.num_txt.text="x"+helper.shortText(this.top20_data.top[e].exp_price),this.top20_data.top[e].coins_price=this.top20_data.top[e].coins_price||0,s.want_mc.num_coins_mc.num_txt.text="x"+helper.shortText(this.top20_data.top[e].coins_price),s.want_mc.num_gold_mc.num_txt.text="x"+helper.shortText(this.top20_data.top[e].gold_price),this.top20_slots.push(s),s.y=59*(this.top20_slots.length-1),setButton(s),s.on("pointerdown",(t=>{iface.goGuest(this.top20_data.top[this.top20_slots.indexOf(t.currentTarget)].id),helper.fadeAnimation(this.top,"fadeOut",350,(()=>{this.top.parent&&root.layer1_mc.removeChild(this.top),this.top.alpha=1,this.top.visible=!0}))})),this.top20_data.top[e].id==vk_params.viewer_id&&(s.i_mc.visible=!0,this.top20_i=!0),0==this.top20_data.top[e].gold_price&&(s.want_mc.visible=!1),t.push(this.top20_data.top[e].id),this.top.win.slots_mc.addChild(s)}this.top20_i?helper.loadNames(t,(t=>{for(let e=0;e<this.top20_slots.length;e++)helper.loadPhoto50(this.top20_data.top[e].id,(t=>{t.scale.x=t.scale.y=.7,this.top20_slots[e].photo_mc.addChild(t)}),t[e].photo_50),this.top20_slots[e].name_txt.text="ТОП-"+(e+1)+". "+t[e].first_name+" "+t[e].last_name.substr(0,1)+"."})):("don"==this.top_type?this.top20_data.top.push({id:vk_params.viewer_id,name:udata.name,photo:my_photo50,exp_price:0,coins_price:0,gold_price:0,top_dmg_don:udata.top_dmg_don}):this.top20_data.top.push({id:vk_params.viewer_id,name:udata.name,photo:my_photo50,exp_price:0,coins_price:0,gold_price:0,top_dmg:udata.top_dmg}),this.top20Form())}tickTop20(t){"max"!=t.status?this.top.win.timer_mc.time_txt.text=helper.timeString(t.time,!0):this.top.win.timer_mc.visible=TIMERS.timers.top20.init=!1}top20Prev(){if(this.top20_goanim||this.top20_slots.length<2)return;let t;this.top20_goanim=!0;for(let e=0;e<this.top20_slots.length;e++)this.top20_slots[e].y==59*(this.top20_slots.length-1)&&(t=e),e!==t&&gsap.to(this.top20_slots[e],{duration:.3,y:this.top20_slots[e].y+59});helper.fadeAnimation(this.top20_slots[t],"fadeOut",100),gsap.to(this.top20_slots[t].scale,{duration:.1,x:.8,y:.8,onComplete:()=>{gsap.to(this.top20_slots[t],.1,{y:0,onComplete:()=>{helper.fadeAnimation(this.top20_slots[t],"fadeIn",100),gsap.to(this.top20_slots[t].scale,{duration:.1,x:1,y:1,onComplete:()=>{this.top20_goanim=!1}})}})}})}top20Next(){if(this.top20_goanim||this.top20_slots.length<2)return;let t;this.top20_goanim=!0;for(let e=0;e<this.top20_slots.length;e++)0==this.top20_slots[e].y&&(t=e),e!==t&&gsap.to(this.top20_slots[e],{duration:.3,y:this.top20_slots[e].y-59});helper.fadeAnimation(this.top20_slots[t],"fadeOut",200),gsap.to(this.top20_slots[t].scale,{duration:.1,x:.8,y:.8,onComplete:()=>{gsap.to(this.top20_slots[t],{duration:.1,y:59*(this.top20_slots.length-1),onComplete:()=>{gsap.to(this.top20_slots[t].scale,.1,{duration:.1,x:1,y:1,onComplete:()=>{this.top20_goanim=!1,this.top20_slots[t].scale.x=this.top20_slots[t].scale.y=1}}),helper.fadeAnimation(this.top20_slots[t],"fadeIn",100)}})}})}iconScaleIn(t){let e=t.currentTarget;helper.fadeAnimation(e.parent.blow_mc,"fadeIn",300)}iconScaleOut(t){let e=t.currentTarget;helper.fadeAnimation(e.parent.blow_mc,"fadeOut",300)}constructTree(){for(this.checkPlaces();this.bgs.bg4.toys_mc.children.length;)this.bgs.bg4.toys_mc.removeChildAt(0);udata.newyear.toys||(udata.newyear.toys=[]);for(let t=0;t<this.pluses.length;t++){let e=udata.newyear.toys[t]||-1;if(0==udata.newyear.toys[t]&&(e=0),-1!==e){let e=helper.duplicate(ny.all_toys[udata.newyear.toys[t]]);e.x=this.pluses[t].x,e.y=this.pluses[t].y,this.bgs.bg4.toys_mc.addChild(e),this.pluses[t].visible=!1}}}checkPlaces(){this.pluses=[this.bgs.bg4.plus_star];for(let t=1;t<=26;t++)t<13&&(this.pluses[t+26]=this.bgs.bg4["plus_toyspecial"+t]),this.pluses[t]=this.bgs.bg4["plus_toy"+t]}initButtons(){setButton(this.padik.top20_mc.icon_mc),setButton(this.padik.ach_mc.icon_mc),setButton(this.padik.pereezd_mc.icon_mc),setButton(this.padik.cal_mc.icon_mc),setButton(this.padik.podarok_mc),setButton(this.top.win.arrows_mc.prev_bt),setButton(this.top.win.arrows_mc.next_bt),setButton(this.top.win.close_mc),setButton(this.top.win.top_don_mc),setButton(this.cust.win.close_mc),setButton(this.padik.pereezd_panel.next_btn),setButton(this.padik.pereezd_panel.prev_btn),setButton(this.padik.pereezd_panel.go_btn),setButton(this.padik.pereezd_panel.cancel_btn),setButton(this.padik.blow_mc.buttons_mc.close_mc),setButton(this.padik.blow_mc.buttons_mc.ok_mc),setButton(this.padik.pers_mc.cat0_btn),setButton(this.padik.pers_mc.cat1_btn),setButton(this.padik.pers_mc.cat2_btn),setButton(this.padik.pers_mc.cat3_btn),setButton(this.padik.pers_mc.cat4_btn),setButton(this.padik.kalmar_mc)}initUnics(){this.top.win.close_mc.addChild(helper.duplicate(modules.unical.close)),this.cust.win.close_mc.addChild(helper.duplicate(modules.unical.close))}}class s{constructor(t,e){this.padik=helper.duplicate(t),this.bgs=e,this.udata=[],this.achives_blow=!1,this.wears=[this.padik.pers_mc.wear0,this.padik.pers_mc.wear1,this.padik.pers_mc.wear2,this.padik.pers_mc.wear3,this.padik.pers_mc.wear4],this.initButtons(),this.padik.ach_mc.icon_mc.on("mouseover",(t=>padik.iconScaleIn(t))),this.padik.ach_mc.icon_mc.on("mouseout",(t=>padik.iconScaleOut(t))),this.padik.page_mc.butt.on("pointerdown",(()=>window.open("https://vk.com/id"+this.udata.id))),this.padik.ach_mc.icon_mc.on("pointerdown",(()=>{achives.lvls=this.udata.achives_level,achives.mode="friend",achives.showAchives()}));for(let t=1;t<=4;t++)this.padik.want_col["btn"+t].on("mouseover",(t=>helper.alphaAnimation(t.currentTarget,1,100))),this.padik.want_col["btn"+t].on("mouseout",(t=>helper.alphaAnimation(t.currentTarget,0,100)))}init(){for(helper.goLocation(4),this.padik.pereezd_panel.visible=!1,this.bgs=helper.duplicate(this.bgs);this.padik.back_mc.children.length;)this.padik.back_mc.removeChildAt(0);this.bgs.gotoAndStop(parseInt(this.udata.bg)),this["constructBG"+udata.bg]&&this["constructBG"+udata.bg](),helper.bgConstructor(this.bgs,this.udata),this.padik.back_mc.addChild(this.bgs),this.padik.page_mc.visible=this.padik.blow_mc.visible=this.padik.want_col.visible=!0,this.padik.podarok_mc.visible=this.padik.top20_mc.visible=this.padik.pereezd_mc.visible=this.padik.bronikout_mc.visible=this.padik.cal_mc.visible=this.padik.kalmar_mc.visible=!1,this.padik.blow_mc.name_txt.text=helper.decode64(this.udata.balabol),""==helper.decode64(this.udata.balabol)?this.padik.blow_mc.alpha=.01:this.padik.blow_mc.alpha=1,iface.up.dop_info.stats_mc.name_txt.text=helper.decode64(this.udata.name),iface.up.dop_info.stats_mc.exp_txt.text=helper.getLevel(this.udata.exp)+" уровень",iface.up.dop_info.stats_mc.mandats_txt.text=this.udata.mandat_use,this.padik.blow_mc.buttons_mc.visible=!1,this.refreshWears(),this.showWantedColl(),root.layer0_mc.addChild(this.padik)}constructBG4(){this.bgs.bg5.semki_mc.visible=this.bgs.bg5.butilka_mc.visible=this.bgs.bg5.energos_mc.visible=!1}showWantedColl(){for(let t=1;t<=4;t++){let e=this.udata.coll_want[t-1];if(e||0===e||(e=-1),this.padik.want_col["col"+t].visible=this.padik.want_col["cnt"+t].visible=this.padik.want_col["btn"+t].visible=!1,-1!==e){this.padik.want_col["col"+t].visible=this.padik.want_col["cnt"+t].visible=!0,this.padik.want_col["col"+t].icon||(this.padik.want_col["col"+t].icon=helper.duplicate(collections.items)),this.padik.want_col["col"+t].addChild(this.padik.want_col["col"+t].icon),this.padik.want_col["col"+t].icon.gotoAndStop(e);let s=udata.coll_items[e]||0;s&&(this.padik.want_col["btn"+t].visible=!0,this.padik.want_col["btn"+t]._events.pointerdown=null,this.padik.want_col["btn"+t].on("pointerdown",(()=>{bridge.send("VKWebAppShowRequestBox",{uid:this.udata.id,message:"Эй, ты, да да ты! Лови заначку от меня! Заходи быстрее и забирай!"}).then((t=>console.log(t.success))).catch((t=>console.log(t))),TS.php("collections.give",{iid:e,fid:this.udata.id},(t=>{udata.coll_items=t.coll_items,this.showWantedColl()}),rootClass.onError)}))),this.padik.want_col["cnt"+t].tf_txt.text="x"+s}}}refreshWears(){let t=JSON.parse(JSON.stringify(this.udata.mywears));this.wears=[this.padik.pers_mc.wear0,this.padik.pers_mc.wear1,this.padik.pers_mc.wear2,this.padik.pers_mc.wear3,this.padik.pers_mc.wear4];for(let e=0;e<t.length;e++)t[e]>=0&&wears.w[t[e]].layer_priority&&([this.wears[wears.w[t[e]].layer_priority[0]],this.wears[wears.w[t[e]].layer_priority[1]]]=[this.wears[wears.w[t[e]].layer_priority[1]],this.wears[wears.w[t[e]].layer_priority[0]]]);null==t[4]&&(t[4]=-1);for(let e=0;e<t.length;e++){for(;this.wears[e].children.length;)this.wears[e].removeChildAt(0);-1==t[e]?this.wears[e].addChild(helper.duplicate(stock_wears[e])):this.wears[e].addChild(shop_wears[t[e]])}}constructTree(){for(this.checkPlaces();this.bgs.bg4.toys_mc.children.length;)this.bgs.bg4.toys_mc.removeChildAt(0);udata.newyear.toys||(udata.newyear.toys=[]);for(let t=0;t<this.pluses.length;t++){let e=this.udata.newyear.toys[t]||-1;if(0==this.udata.newyear.toys[t]&&(e=0),-1!==e){let e=helper.duplicate(this.all_toys[this.udata.newyear.toys[t]]);e.x=this.pluses[t].x,e.y=this.pluses[t].y,this.bgs.bg4.toys_mc.addChild(e),this.pluses[t].visible=!1}}}checkPlaces(){this.pluses=[this.bgs.bg4.plus_star];for(let t=1;t<=26;t++)t<13&&(this.pluses[t+26]=this.bgs.bg4["plus_toyspecial"+t]),this.pluses[t]=this.bgs.bg4["plus_toy"+t]}initButtons(){setButton(this.padik.ach_mc.icon_mc),setButton(this.padik.page_mc.butt),setButton(this.padik.want_col.btn1),setButton(this.padik.want_col.btn2),setButton(this.padik.want_col.btn3),setButton(this.padik.want_col.btn4)}}var i=__webpack_require__(412);class o{constructor(t,e){this.menu=t,this.minigames=e,this.all_checks=0,this.butts=[this.menu.city_btn,this.menu.doping_btn,this.menu.garage_btn,this.menu.minigame_btn,this.menu.home_btn,this.menu.shop_btn,this.menu.fights_btn,this.menu.weapons_btn],this.blows=[this.menu.blow_city,this.menu.blow_doping,this.menu.blow_garage,this.menu.blow_minigame,this.menu.blow_home,this.menu.blow_shop,this.menu.blow_fights,this.menu.blow_weapons],this.hoboMovs=[this.menu.hobo1_mov,this.menu.hobo2_mov,this.menu.hobo3_mov,this.menu.hobo4_mov,this.menu.hobo5_mov],this.hoboBlows=[this.menu.hobo1_blow,this.menu.hobo2_blow,this.menu.hobo3_blow,this.menu.hobo4_blow,this.menu.hobo5_blow],this.hobo_def_blows=[this.menu.hobo1_def_blow,this.menu.hobo2_def_blow,this.menu.hobo3_def_blow,this.menu.hobo4_def_blow,this.menu.hobo5_def_blow],this.hoboBlowsY=[this.menu.hobo1_blow.y,this.menu.hobo2_blow.y,this.menu.hobo3_blow.y,this.menu.hobo4_blow.y,this.menu.hobo5_blow.y],this.hobo=0,this.minigames_goanim=!1,this.minigames.interactive=this.minigames.win.block_mc.interactive=!0,this.initUnics(),this.initButtons();for(let t=0;t<this.butts.length;t++)setButton(this.butts[t]),helper.blowController("menu_icon"+t,[this.butts[t]],this.blows[t]);this.minigames.win.close_mc.on("pointerdown",(()=>this.hideMinigames())),this.minigames.win.naperstki_btn.on("pointerdown",(()=>{this.minigames_goanim||this.toNaperstki()})),this.minigames.win.knb_btn.on("pointerdown",(()=>{this.minigames_goanim||this.toKNB()})),this.menu.home_btn.on("pointerdown",(()=>this.toHome())),this.menu.minigame_btn.on("pointerdown",(()=>this.showMinigames())),this.menu.garage_btn.on("pointerdown",(()=>this.toGarage())),this.menu.doping_btn.on("pointerdown",(()=>this.toDoping())),this.menu.fights_btn.on("pointerdown",(()=>this.checkStatusBoss())),this.menu.weapons_btn.on("pointerdown",(()=>this.toArmor())),this.menu.city_btn.on("pointerdown",(()=>this.toCity())),this.menu.shop_btn.on("pointerdown",(()=>this.toShop())),helper.clickControl(this.minigames.win.slots_btn,null,(()=>this.toSlots()));for(let t=0;t<this.hoboMovs.length;t++)setButton(this.hoboMovs[t]),this.hoboMovs[t].visible=!1,helper.blowController("hobo_def_blow"+t,[this.hoboMovs[t]],this.hobo_def_blows[t]);this.menu.nytree_mc.visible=!1}init(){TIMERS.timers.hobo.tick||(TIMERS.timers.hobo={init:!0,tick:t=>{"plus"==t.status&&this.hoboStatus()}}),helper.goLocation(1),DATE.getHours()>=21||DATE.getHours()<6?this.menu.night_mc.visible=!0:this.menu.night_mc.visible=!1,this.hoboStatus(),root.layer0_mc.addChild(this.menu),learn.check()}toHome(){(0!=HYSTORY[HYSTORY.length-1]||TOBACK)&&(iface.removeStage(),padik.init(),iface.showIcons())}toSlots(){modules.checkFlags(["bank"],(()=>{this.minigames_goanim||(main_menu.hideMinigames(),iface.toATM(),bank.initSlots())}))}toCity(){(2!=HYSTORY[HYSTORY.length-1]||TOBACK)&&modules.checkFlags(["city"],(()=>{iface.removeStage(),map.init(),iface.showIcons()}))}toDoping(){(5!=HYSTORY[HYSTORY.length-1]||TOBACK)&&modules.checkFlags(["doping"],(()=>{iface.removeStage(),doping.init(),iface.showIcons()}))}toArmor(){(6!=HYSTORY[HYSTORY.length-1]||TOBACK)&&modules.checkFlags(["armor"],(()=>{iface.removeStage(),armor.init(),iface.showIcons()}))}toShop(t=null,e=[]){(7!=HYSTORY[HYSTORY.length-1]||TOBACK)&&modules.checkFlags(["shop"],(()=>{iface.removeStage(),shop.checks=helper.copyJSON(shop._checks),shop.init(t,e),iface.showIcons()}))}toNaperstki(){(8!=HYSTORY[HYSTORY.length-1]||TOBACK)&&modules.checkFlags(["mini"],(()=>{iface.removeStage(),naperstki.init(),iface.showIcons()}))}toKNB(){(12!=HYSTORY[HYSTORY.length-1]||TOBACK)&&modules.checkFlags(["mini"],(()=>{iface.removeStage(),kanobu.init(),iface.showIcons()}))}toFight(){(9!=HYSTORY[HYSTORY.length-1]||TOBACK)&&(iface.removeStage(),fights.init(),iface.showIcons())}toGarage(){(11!=HYSTORY[HYSTORY.length-1]||TOBACK)&&modules.checkFlags(["garage"],(()=>{iface.removeStage(),garage.init(),iface.showIcons()}))}clickHobo(t){let e=this.hoboMovs.indexOf(t.currentTarget);this.hoboMovs[e].interactive=!1,TS.php("users.getHobo",{},(t=>{this.hobo--,sounds.playHobo(),this.hoboBlows[e].gotoAndStop(t.win),this.hoboBlows[e].y=this.hoboBlowsY[e]+10,this.hoboBlows[e].visible=!0,this.hoboBlows[e].alpha=0,helper.alphaAnimation(this.hobo_def_blows[e],0),helper.fadeAnimation(this.hoboBlows[e],"fadeIn",500),gsap.to(this.hoboBlows[e],{y:this.hoboBlowsY[e]-20,duration:.5,onComplete:()=>{helper.fadeAnimation(this.hoboBlows[e],"fadeOut",200),helper.fadeAnimation(this.hoboMovs[e],"fadeOut",200),achives.refresh(t.achives_level),iface.updateUp(),learn.check()}})}),(t=>rootClass.onError(t)))}hoboStatus(){for(let t=0;t<this.hoboMovs.length;t++)this.hoboMovs[t].interactive=!0,this.hoboMovs[t]._events.pointerdown||this.hoboMovs[t].on("pointerdown",(t=>this.clickHobo(t))),!this.hoboMovs[t].visible&&parseInt(udata.hobo)>this.hobo&&(helper.fadeAnimation(this.hoboMovs[t],"fadeIn",300),this.hobo++,DATE.getHours()>=21||DATE.getHours()<6?this.hoboBlows[t].light_mc.visible=!0:this.hoboBlows[t].light_mc.visible=!1)}showMinigames(){this.minigames.shadow_mc.alpha=.01,this.minigames_goanim=!0,this.minigames.bg_mc.visible=!1,this.minigames.win.y=-500,helper.getLevel(udata.exp)>=7?this.minigames.win.block_mc.visible=!1:this.minigames.win.block_mc.visible=!0,helper.fadeAnimation(this.minigames.shadow_mc,"fadeIn",500,(()=>{helper.fadeAnimation(this.minigames.bg_mc,"fadeIn",1e3),gsap.to(this.minigames.win,{y:101,ease:"back.out(1.3)",duration:1,onComplete:()=>{this.minigames_goanim=!1}})}));try{works.show_nap.visible=!1}catch(t){}root.layer1_mc.addChild(this.minigames),learn.check()}hideMinigames(){this.minigames_goanim||root.layer1_mc.removeChild(this.minigames)}checkStatusBoss(){modules.checkFlags(["fights","notify"],(()=>TS.php("fights.check",{},(t=>this.fightStatus(t)),rootClass.onError)))}fightStatus(t){let e=udata.combo_info["boss"+t.boss.bid]||0;t.service.CRITICAL&&fights.fight.crit_mc.gotoAndPlay(1),t.service.COMBO&&e<3&&(fights.fight.combo_mc.anim_mc.gotoAndPlay(1),iface.showChotko(),!t.service.combo_box&&t.service.new_COMBO&&(fights.combo_full_true.combo_full_true_txt.alpha=0,root.layer1_mc.addChild(fights.combo_full_true),fights.combo_full_true.combo_fight_true.gotoAndPlay(fights.last_fight),helper.fadeAnimation(fights.combo_full_true,"fadeIn",1e3,(()=>{fights.combo_full_true.combo_fight_true.gotoAndStop(fights.last_fight),fights.combo_full_true.combo_full_true_txt.alpha=1,helper.fadeAnimation(fights.combo_full_true,"fadeOut",1500,(()=>{root.layer1_mc.removeChild(fights.combo_full_true)}))})))),fights.fight.combo_mc.combo_fights_false.alpha=0,t.service.total_damage&&0==t.boss.combo&&helper.alphaAnimation(fights.fight.combo_mc.combo_fights_false,1,300,(()=>{let t=setInterval((()=>{helper.alphaAnimation(fights.fight.combo_mc.combo_fights_false,0,300),clearInterval(t)}),300)})),t.service.combo_box&&fights.showComboBox(t.service.combo_box);for(let t=0;t<9;t++)fights.combo_block[t].visible=!0,fights.combo_true[t].gotoAndStop(14);if(e<3){fights.fight.combo_mc.combo_lvl.gotoAndStop(e);let s=3*(e+1);for(let e=0;e<s;e++)fights.combo_block[e].visible=!1,udata.combo_info.c_true&&udata.combo_info.c_true[t.boss.bid]&&parseInt(udata.combo_info.c_true[t.boss.bid][e])>=0&&(fights.combo_true[e].gotoAndStop(udata.combo_info.c_true[t.boss.bid][e]),t.boss.combo||(t.boss.combo=0),parseInt(t.boss.combo)<e+1&&fights.combo_true[e].gotoAndStop(udata.combo_info.c_true[t.boss.bid][e]+7))}if(t.service.draznilka){let e=bosses[t.boss.bid].zaeb;fights.fight.zaeb_mc.tf_txt.text=e[Math.floor(Math.random()*e.length)],0==fights.fight.zaeb_mc.alpha&&helper.alphaAnimation(fights.fight.zaeb_mc,1,300,(()=>{let t=setInterval((()=>{helper.alphaAnimation(fights.fight.zaeb_mc,0,300),clearInterval(t)}),3e3)}))}if(achives.refresh(udata.achives_level),fights.data=Object.assign(t.boss,t.service),"fight"!==t.service.status){for(fights.auto_multiudar&&(fights.auto_multiudar=fights.obmen.win_fight.check_auto_udar_mc.visible=fights.setup_automultiudar=!1),fights_windows.showBossSelector(),9==HYSTORY[HYSTORY.length-1]&&iface.clickBack();HYSTORY.indexOf(9)>-1;)HYSTORY.splice(HYSTORY.indexOf(9),1);fights_windows.selector.win.mandat_mc.damage_txt.text="максимум",udata.mandat_lvl<=1?(parseInt(udata.mandat_lvl)<mandats_info.l[udata.mandat_level].length+mandats_info.l[0].length*udata.mandat_level&&(fights_windows.selector.win.mandat_mc.damage_txt.text="0/"+parseInt(mandats_info.l[udata.mandat_level][parseInt(udata.mandat_lvl)-mandats_info.l[0].length*udata.mandat_level])),gsap.to(fights_windows.selector.win.mandat_mc.line_mc.full_mc,{duration:.3,x:-111})):(fights_windows.selector.win.mandat_mc.damage_txt.text="мандаты",fights_windows.selector.win.mandat_mc.line_mc.full_mc.x=0),parseInt(udata.mandat_lvl)-parseInt(udata.mandat_use)>0?helper.animateEl("start",fights_windows.selector.win.mandat_mc.icon_mc):helper.animateEl("stop",fights_windows.selector.win.mandat_mc.icon_mc)}else fights_windows.selector.parent&&root.layer1_mc.removeChild(fights_windows.selector),this.toFight();"win"==t.service.status&&fights_windows.showBossWin(),"defeat"==t.service.status&&fights_windows.showBossDefeat(),iface.updateUp()}inviteFriend(){bridge.send("VKWebAppShowInviteBox",{}).then((t=>console.log(t))).catch((t=>console.log(t)))}initButtons(){setButton(this.minigames.win.close_mc),setButton(this.minigames.win.naperstki_btn),setButton(this.minigames.win.knb_btn),setButton(this.minigames.win.slots_btn)}initUnics(){this.minigames.win.close_mc.addChild(helper.duplicate(modules.unical.close))}showNewYearWindow(){(15!=HYSTORY[HYSTORY.length-1]||TOBACK)&&modules.checkFlags(["ny"],(()=>{iface.removeStage(),ny.init(),iface.showIcons()}))}}class a{constructor(t){this.mandats=t,this.icons=[this.mandats.win.icons_mc.page1.m1,this.mandats.win.icons_mc.page1.m2,this.mandats.win.icons_mc.page1.m3,this.mandats.win.icons_mc.page1.m4,this.mandats.win.icons_mc.page1.m5,this.mandats.win.icons_mc.page1.m6,this.mandats.win.icons_mc.page1.m7,this.mandats.win.icons_mc.page1.m8,this.mandats.win.icons_mc.page2.m9,this.mandats.win.icons_mc.page2.m10,this.mandats.win.icons_mc.page2.m11,this.mandats.win.icons_mc.page2.m12,this.mandats.win.icons_mc.page2.m13,this.mandats.win.icons_mc.page2.m14,this.mandats.win.icons_mc.page2.m15,this.mandats.win.icons_mc.page3.m16,this.mandats.win.icons_mc.page3.m17,this.mandats.win.icons_mc.page3.m18,this.mandats.win.icons_mc.page3.m19,this.mandats.win.icons_mc.page3.m20,this.mandats.win.icons_mc.page3.m21,this.mandats.win.icons_mc.page3.m22,this.mandats.win.icons_mc.page3.m23],this.blows=[this.mandats.win.icons_mc.page1.b1,this.mandats.win.icons_mc.page1.b2,this.mandats.win.icons_mc.page1.b3,this.mandats.win.icons_mc.page1.b4,this.mandats.win.icons_mc.page1.b5,this.mandats.win.icons_mc.page1.b6,this.mandats.win.icons_mc.page1.b7,this.mandats.win.icons_mc.page1.b8,this.mandats.win.icons_mc.page2.b9,this.mandats.win.icons_mc.page2.b10,this.mandats.win.icons_mc.page2.b11,this.mandats.win.icons_mc.page2.b12,this.mandats.win.icons_mc.page2.b13,this.mandats.win.icons_mc.page2.b14,this.mandats.win.icons_mc.page2.b15,this.mandats.win.icons_mc.page3.b16,this.mandats.win.icons_mc.page3.b17,this.mandats.win.icons_mc.page3.b18,this.mandats.win.icons_mc.page3.b19,this.mandats.win.icons_mc.page3.b20,this.mandats.win.icons_mc.page3.b21,this.mandats.win.icons_mc.page3.b22,this.mandats.win.icons_mc.page3.b23],this.initUnics(),this.initButtons(),this.setTexts(),this.mandats.interactive=this.mandats.win.levels_mc.interactive=this.mandats.win.levels_mc.buttonMode=!0,this.fst_legacy=[this.mandats.win.damage_txt,this.mandats.win.use_info,this.mandats.win.nouse_info,this.mandats.win.use_txt,this.mandats.win.nouse_txt,this.mandats.win.icons_mc,this.mandats.win.sbros_btn,this.mandats.win.sbros_mc,this.mandats.win.line_mc],this.mandat3_page=0;for(let t=0;t<this.icons.length;t++)setButton(this.icons[t].shadow_mc),this.icons[t].shadow_mc.alpha=.01,this.icons[t].shadow_mc.on("mouseover",(t=>helper.fadeAnimation(this.blows[this.icons.indexOf(t.currentTarget.parent)],"fadeIn"))),this.icons[t].shadow_mc.on("mouseout",(t=>helper.fadeAnimation(this.blows[this.icons.indexOf(t.currentTarget.parent)],"fadeOut"))),this.icons[t].shadow_mc.on("pointerdown",(t=>this.clickMandat(t)));for(let t=0;t<20;t++)setButton(this.mandats.win.level3_mc.slots["slot"+t]),helper.blowController("mandat3_"+t,[this.mandats.win.level3_mc.slots["slot"+t]],this.mandats.win.level3_mc.slots["blow"+t]),helper.clickControl(this.mandats.win.level3_mc.slots["slot"+t],null,(()=>{this.mandats.win.level3_mc.slots["slot"+t].close||TS.php("mandats.up3",{id:t},(t=>{this.onCompleteRequest(t)}),rootClass.onError)}));for(let t=0;t<20;t++)setButton(this.mandats.win.level4_mc.slots["slot"+t]),helper.blowController("mandat4_"+t,[this.mandats.win.level4_mc.slots["slot"+t]],this.mandats.win.level4_mc.slots["blow"+t]),helper.clickControl(this.mandats.win.level4_mc.slots["slot"+t],null,(()=>{this.mandats.win.level4_mc.slots["slot"+t].close||TS.php("mandats.up4",{id:t},(t=>{this.onCompleteRequest(t)}),rootClass.onError)}));this.mandats.win.icons_mc.page2.visible=this.mandats.win.icons_mc.page3.visible=!1,this.mandats.win.next_bt.visible=this.mandats.win.prev_def.visible=!0,this.mandats.win.prev_bt.visible=this.mandats.win.next_def.visible=!1,this.mandats.masker=new PIXI.Graphics,this.mandats.masker.beginFill(),this.mandats.masker.drawRect(17,125,380,407),this.mandats.masker.endFill(),this.mandats.win.addChild(this.mandats.masker),this.mandats.masker.alpha=.01,this.mandats.win.next_bt.on("pointerdown",(()=>this.nextPage())),this.mandats.win.prev_bt.on("pointerdown",(()=>this.prevPage())),this.mandats.win.levels_mc.on("mouseover",(()=>helper.fadeAnimation(this.mandats.win.lblows_mc,"fadeIn"))),this.mandats.win.levels_mc.on("mouseout",(()=>helper.fadeAnimation(this.mandats.win.lblows_mc,"fadeOut"))),this.mandats.win.close_mc.on("pointerdown",(()=>{this.mandats.parent&&root.layer1_mc.removeChild(this.mandats)})),this.mandats.win.sbros_btn.on("pointerdown",(()=>{udata.mandat_use>0&&TS.php("mandats.cancel",{},(t=>this.onCompleteRequest(t)),rootClass.onError)}))}nextPage(){if(udata.mandat_level>2)switch(this.mandats.win.level4_mc.slots.x){case 26:this.mandats.win.level4_mc.slots.x=-734,this.mandats.win.prev_def.visible=!1,this.mandats.win.prev_bt.visible=!0;break;case-734:this.mandats.win.level4_mc.slots.x=-1494,this.mandats.win.next_def.visible=!0,this.mandats.win.next_bt.visible=!1}else if(udata.mandat_level>1)switch(this.mandats.win.level3_mc.slots.x){case 26:this.mandats.win.level3_mc.slots.x=-734,this.mandats.win.prev_def.visible=!1,this.mandats.win.prev_bt.visible=!0;break;case-734:this.mandats.win.level3_mc.slots.x=-1494,this.mandats.win.next_def.visible=!0,this.mandats.win.next_bt.visible=!1}else switch(this.mandats.win.icons_mc.mask=this.mandats.masker,this.mandats.win.icons_mc.page2.visible=this.mandats.win.icons_mc.page3.visible=!0,this.mandats.win.icons_mc.y){case 0:gsap.to(this.mandats.win.icons_mc,{duration:0,y:-407,onComplete:()=>{this.mandats.win.icons_mc.page1.visible=this.mandats.win.icons_mc.page3.visible=!1,this.mandats.win.icons_mc.page2.visible=!0,this.mandats.win.icons_mc.mask=null,this.mandats.win.prev_def.visible=!1,this.mandats.win.prev_bt.visible=!0}});break;case-407:gsap.to(this.mandats.win.icons_mc,{duration:0,y:-812,onComplete:()=>{this.mandats.win.icons_mc.page1.visible=this.mandats.win.icons_mc.page2.visible=!1,this.mandats.win.icons_mc.page3.visible=!0,this.mandats.win.icons_mc.mask=null,this.mandats.win.next_def.visible=!0,this.mandats.win.next_bt.visible=!1}})}}prevPage(){if(udata.mandat_level>2)switch(this.mandats.win.level4_mc.slots.x){case-734:this.mandats.win.level4_mc.slots.x=26,this.mandats.win.prev_def.visible=!0,this.mandats.win.prev_bt.visible=!1;break;case-1494:this.mandats.win.level4_mc.slots.x=-734,this.mandats.win.next_def.visible=!1,this.mandats.win.next_bt.visible=!0}else if(udata.mandat_level>1)switch(this.mandats.win.level3_mc.slots.x){case-734:this.mandats.win.level3_mc.slots.x=26,this.mandats.win.prev_def.visible=!0,this.mandats.win.prev_bt.visible=!1;break;case-1494:this.mandats.win.level3_mc.slots.x=-734,this.mandats.win.next_def.visible=!1,this.mandats.win.next_bt.visible=!0}else switch(this.mandats.win.icons_mc.y){case-407:gsap.to(this.mandats.win.icons_mc,{duration:0,y:0,onComplete:()=>{this.mandats.win.icons_mc.page2.visible=this.mandats.win.icons_mc.page3.visible=!1,this.mandats.win.icons_mc.page1.visible=!0,this.mandats.win.icons_mc.mask=null,this.mandats.win.prev_def.visible=!0,this.mandats.win.prev_bt.visible=!1}});break;case-812:gsap.to(this.mandats.win.icons_mc,{duration:0,y:-407,onComplete:()=>{this.mandats.win.icons_mc.page1.visible=this.mandats.win.icons_mc.page3.visible=!1,this.mandats.win.icons_mc.page2.visible=!0,this.mandats.win.icons_mc.mask=null,this.mandats.win.next_def.visible=!1,this.mandats.win.next_bt.visible=!0}})}}showMandats(){if(this.mandats.shadow_mc.alpha=this.mandats.shadow_box.alpha=0,this.mandats.win.y=-600,this.mandats.bg_mc.visible=!1,this.mandats.win.next_def.visible=!1,this.mandats.win.next_bt.visible=!0,this.mandats.win.prev_def.visible=!0,this.mandats.win.prev_bt.visible=!1,this.mandats.win.level3_mc.slots.x=this.mandats.win.level4_mc.slots.x=26,udata.mandat_level>1){for(let t=0;t<this.fst_legacy.length;t++)this.fst_legacy[t].visible=!1;2==udata.mandat_level?this.mandats.win.level4_mc.visible=!1:this.mandats.win.level3_mc.visible=!1,this.mandats.win.line_box.y=85}else this.mandats.win.line_box.y=124,this.mandats.win.level3_mc.visible=this.mandats.win.level4_mc.visible=!1,this.mandats.win.icons_mc.y=0,this.mandats.win.icons_mc.page2.visible=this.mandats.win.icons_mc.page3.visible=!1,this.mandats.win.icons_mc.page1.visible=!0;helper.fadeAnimation(this.mandats.shadow_mc,"fadeIn",300,(()=>{helper.fadeAnimation(this.mandats.bg_mc,"fadeIn",1e3),gsap.to(this.mandats.win,{y:104,duration:1,ease:"back.out(1.3)",onComplete:()=>{helper.fadeAnimation(this.mandats.shadow_box,"fadeIn",100)}})})),root.layer1_mc.addChild(this.mandats),this.updateMandats()}updateMandats(){if(this.mandats.win.levels_mc.gotoAndStop(parseInt(udata.mandat_level)),2==udata.mandat_level)return this.updateMandats3();if(udata.mandat_level>2)return this.updateMandats4();let t=udata.mandat_up[udata.mandat_level];this.mandats.win.lblows_mc.gotoAndStop(1),this.mandats.win.lblows_mc.gotoAndStop(0==udata.mandat_level&&udata.mandat_use==mandats_info.l[0].length||1==udata.mandat_level&&udata.mandat_use==mandats_info.l[0].length+mandats_info.l[1].length?1:0);for(let e=0;e<this.icons.length;e++){let s=t[e]||0;this.icons[e].close=!1,this.icons[e].num_txt.text=s+"/"+mandats_info.m[udata.mandat_level][e].lvls,this.blows[e].name_txt.text=helper.decode64(mandats_info.m[udata.mandat_level][e].name),this.blows[e].info_txt.text=helper.decode64(mandats_info.m[udata.mandat_level][e].info),mandats_info.m[udata.mandat_level][e].block?(this.blows[e].info_txt.text="мандат заблокирован",this.icons[e].close=!0):parseInt(udata.mandat_use)<parseInt(mandats_info.m[udata.mandat_level][e].open)&&(this.blows[e].info_txt.text="нужно вложить "+mandats_info.m[udata.mandat_level][e].open+" мандатов",this.icons[e].close=!0),e>=1&&0!==parseInt(mandats_info.m[udata.mandat_level][e].line)&&mandats_info.m[udata.mandat_level][e-1].line==mandats_info.m[udata.mandat_level][e].line&&t[e-1]<parseInt(mandats_info.m[udata.mandat_level][e].open)&&!mandats_info.m[udata.mandat_level][e].block&&(this.blows[e].info_txt.text="прокачай предыдущий мандат",this.icons[e].close=!0),this.icons[e].close?helper.alphaAnimation(this.icons[e].shadow_mc,.5,300):helper.alphaAnimation(this.icons[e].shadow_mc,.01,300)}this.mandats.win.nouse_txt.text=parseInt(udata.mandat_lvl)-parseInt(udata.mandat_use).toString(),this.mandats.win.use_txt.text=udata.mandat_use,this.mandats.win.damage_txt.text="максимум",this.mandats.win.line_mc.full_mc.x=0,parseInt(udata.mandat_lvl)<mandats_info.l[udata.mandat_level].length+mandats_info.l[0].length*udata.mandat_level&&(this.mandats.win.damage_txt.text=helper.shortText(parseInt(udata.mandat_dmg))+"/"+helper.shortText(mandats_info.l[udata.mandat_level][parseInt(udata.mandat_lvl)-mandats_info.l[0].length*udata.mandat_level]),this.mandats.win.line_mc.full_mc.x=parseInt(udata.mandat_dmg)/parseInt(mandats_info.l[udata.mandat_level][parseInt(udata.mandat_lvl)-mandats_info.l[0].length*udata.mandat_level])*111-111),parseInt(udata.mandat_lvl)-parseInt(udata.mandat_use)>0?helper.animateEl("start",fights_windows.selector.win.mandat_mc.icon_mc):helper.animateEl("stop",fights_windows.selector.win.mandat_mc.icon_mc),fights.fight.parent&&fights.updateBoss(),learn.check()}updateMandats3(){let t=["line_bit","line_travm","line_but","line_def"];udata.mandat3.weapons=udata.mandat3.weapons||[0,0,0,0],udata.mandat3.mandats_up=udata.mandat3.mandats_up||[0,0,0,0],udata.mandat3.damages=udata.mandat3.damages||[0,0,0,0],udata.mandat3.levels=udata.mandat3.levels||[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],this.mandats.win.level3_mc.bit_txt.text=udata.mandat3.weapons[0]-udata.mandat3.mandats_up[0],this.mandats.win.level3_mc.travm_txt.text=udata.mandat3.weapons[1]-udata.mandat3.mandats_up[1],this.mandats.win.level3_mc.but_txt.text=udata.mandat3.weapons[2]-udata.mandat3.mandats_up[2],this.mandats.win.level3_mc.def_txt.text=udata.mandat3.weapons[3]-udata.mandat3.mandats_up[3];for(let t=0;t<20;t++)this.mandats.win.level3_mc.slots["slot"+t].close=!1,this.mandats.win.level3_mc.slots["slot"+t].num_txt.text=udata.mandat3.levels[t]+"/"+mandats_info.m3[t].lvls,this.mandats.win.level3_mc.slots["blow"+t].name_txt.text=mandats_info.m3[t].name,this.mandats.win.level3_mc.slots["blow"+t].info_txt.text=mandats_info.m3[t].info,mandats_info.m3[t].block?udata.mandat3.levels[t-1]<mandats_info.m3[t].open&&(this.mandats.win.level3_mc.slots["slot"+t].close=!0,this.mandats.win.level3_mc.slots["blow"+t].info_txt.text="прокачай предыдущий мандат"):udata.mandat_use-1779<mandats_info.m3[t].open&&(this.mandats.win.level3_mc.slots["slot"+t].close=!0,this.mandats.win.level3_mc.slots["blow"+t].info_txt.text="Нужно вкачать ещё "+(mandats_info.m3[t].open-(udata.mandat_use-1779))+" мандатов");for(let e=0;e<4;e++)mandats_info.l3[e].length==udata.mandat3.weapons[e]?(this.mandats.win.level3_mc[t[e]].damage_txt.text="максимум",this.mandats.win.level3_mc[t[e]].full_mc.x=0):(this.mandats.win.level3_mc[t[e]].damage_txt.text=helper.shortText(udata.mandat3.damages[e])+"/"+helper.shortText(mandats_info.l3[e][udata.mandat3.weapons[e]]),this.mandats.win.level3_mc[t[e]].full_mc.x=udata.mandat3.damages[e]/mandats_info.l3[e][udata.mandat3.weapons[e]]*111-111);udata.mandat_use==mandats_info.l[0].length+mandats_info.l[1].length+mandats_info.l3[0].length+mandats_info.l3[1].length+mandats_info.l3[2].length+mandats_info.l3[3].length?helper.animateEl("start",this.mandats.win.levels_mc):helper.animateEl("stop",this.mandats.win.levels_mc),fights.fight.parent&&fights.updateBoss()}updateMandats4(){let t=["line_bit","line_travm","line_but","line_def"];udata.mandat4.weapons=udata.mandat4.weapons||[0,0,0,0],udata.mandat4.mandats_up=udata.mandat4.mandats_up||[0,0,0,0],udata.mandat4.damages=udata.mandat4.damages||[0,0,0,0],udata.mandat4.levels=udata.mandat4.levels||[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],this.mandats.win.level4_mc.bit_txt.text=udata.mandat4.weapons[0]-udata.mandat4.mandats_up[0],this.mandats.win.level4_mc.travm_txt.text=udata.mandat4.weapons[1]-udata.mandat4.mandats_up[1],this.mandats.win.level4_mc.but_txt.text=udata.mandat4.weapons[2]-udata.mandat4.mandats_up[2],this.mandats.win.level4_mc.def_txt.text=udata.mandat4.weapons[3]-udata.mandat4.mandats_up[3];for(let t=0;t<20;t++)this.mandats.win.level4_mc.slots["slot"+t].close=!1,this.mandats.win.level4_mc.slots["slot"+t].num_txt.text=udata.mandat4.levels[t]+"/"+mandats_info.m4[t].lvls,this.mandats.win.level4_mc.slots["blow"+t].name_txt.text=mandats_info.m4[t].name,this.mandats.win.level4_mc.slots["blow"+t].info_txt.text=mandats_info.m4[t].info,mandats_info.m4[t].block?udata.mandat4.levels[t-1]<mandats_info.m4[t].open&&(this.mandats.win.level4_mc.slots["slot"+t].close=!0,this.mandats.win.level4_mc.slots["blow"+t].info_txt.text="прокачай предыдущий мандат"):udata.mandat_use-3094<mandats_info.m4[t].open&&(this.mandats.win.level4_mc.slots["slot"+t].close=!0,this.mandats.win.level4_mc.slots["blow"+t].info_txt.text="Нужно вкачать ещё "+(mandats_info.m4[t].open-(udata.mandat_use-3094))+" мандатов");for(let e=0;e<4;e++)mandats_info.l4[e].length==udata.mandat4.weapons[e]?(this.mandats.win.level4_mc[t[e]].damage_txt.text="максимум",this.mandats.win.level4_mc[t[e]].full_mc.x=0):(this.mandats.win.level4_mc[t[e]].damage_txt.text=helper.shortText(udata.mandat4.damages[e])+"/"+helper.shortText(mandats_info.l4[e][udata.mandat4.weapons[e]]),this.mandats.win.level4_mc[t[e]].full_mc.x=udata.mandat4.damages[e]/mandats_info.l4[e][udata.mandat4.weapons[e]]*111-111);fights.fight.parent&&fights.updateBoss()}upLevel(){udata.mandat_level>2||udata.mandat_use<mandats_info.l[0].length||TS.php("mandats.levelUp",{},(t=>this.onUpMandats(t)),rootClass.onError)}onUpMandats(t){if(3==udata.mandat_level&&t.mandat_old_level<t.mandat_level){this.mandats.win.level3_mc.visible=!1,gsap.to(this.mandats.win.line_box,{duration:.2,y:85});for(let t=0;t<this.fst_legacy.length;t++)helper.fadeAnimation(this.fst_legacy[t],"fadeOut",200);helper.fadeAnimation(this.mandats.win.level4_mc,"fadeIn",200),this.mandats.win.level4_mc.slots.x=26,this.mandats.win.prev_def.visible=this.mandats.win.next_bt.visible=!0,this.mandats.win.prev_bt.visible=this.mandats.win.next_def.visible=!1}if(2==udata.mandat_level&&t.mandat_old_level<t.mandat_level){gsap.to(this.mandats.win.line_box,{duration:.2,y:85});for(let t=0;t<this.fst_legacy.length;t++)helper.fadeAnimation(this.fst_legacy[t],"fadeOut",200);helper.fadeAnimation(this.mandats.win.level3_mc,"fadeIn",200),this.mandats.win.level3_mc.slots.x=26,this.mandats.win.prev_def.visible=this.mandats.win.next_bt.visible=!0,this.mandats.win.prev_bt.visible=this.mandats.win.next_def.visible=!1}1==udata.mandat_level&&t.mandat_old_level<t.mandat_level&&(this.mandats.win.icons_mc.y=0,this.mandats.win.icons_mc.page2.visible=this.mandats.win.icons_mc.page3.visible=!1,this.mandats.win.icons_mc.page1.visible=!0,this.mandats.win.icons_mc.mask=null,this.mandats.win.prev_def.visible=this.mandats.win.next_bt.visible=!0,this.mandats.win.prev_bt.visible=this.mandats.win.next_def.visible=!1)}clickMandat(t){let e=this.icons.indexOf(t.currentTarget.parent);(udata.mandat_up[e]||0)==parseInt(mandats_info.m[udata.mandat_level][e].lvls)||t.currentTarget.alpha>.01||TS.php("mandats.up",{id:e},(t=>{this.onCompleteRequest(t)}),rootClass.onError)}onCompleteRequest(t){this.onUpMandats(t),achives.refresh(),this.updateMandats(),iface.updateUp()}initButtons(){setButton(this.mandats.win.close_mc),setButton(this.mandats.win.sbros_btn),setButton(this.mandats.win.next_bt),setButton(this.mandats.win.prev_bt)}initUnics(){this.mandats.win.close_mc.addChild(helper.duplicate(modules.unical.close)),this.mandats.shadow_box.addChild(helper.duplicate(modules.unical.wood_shadow))}setTexts(){setTextStyle(this.mandats.win.level3_mc.bit_desc,{miterLimit:3,strokeThickness:3,stroke:"#3b2e23"}),setTextStyle(this.mandats.win.level3_mc.bit_txt,{miterLimit:3,strokeThickness:3,stroke:"#3b2e23"}),setTextStyle(this.mandats.win.level3_mc.but_desc,{miterLimit:3,strokeThickness:3,stroke:"#3b2e23"}),setTextStyle(this.mandats.win.level3_mc.but_txt,{miterLimit:3,strokeThickness:3,stroke:"#3b2e23"}),setTextStyle(this.mandats.win.level3_mc.travm_desc,{miterLimit:3,strokeThickness:3,stroke:"#3b2e23"}),setTextStyle(this.mandats.win.level3_mc.travm_txt,{miterLimit:3,strokeThickness:3,stroke:"#3b2e23"}),setTextStyle(this.mandats.win.level3_mc.def_desc,{miterLimit:3,strokeThickness:3,stroke:"#3b2e23"}),setTextStyle(this.mandats.win.level3_mc.def_txt,{miterLimit:3,strokeThickness:3,stroke:"#3b2e23"}),setTextStyle(this.mandats.win.level4_mc.bit_desc,{miterLimit:3,strokeThickness:3,stroke:"#3b2e23"}),setTextStyle(this.mandats.win.level4_mc.bit_txt,{miterLimit:3,strokeThickness:3,stroke:"#3b2e23"}),setTextStyle(this.mandats.win.level4_mc.but_desc,{miterLimit:3,strokeThickness:3,stroke:"#3b2e23"}),setTextStyle(this.mandats.win.level4_mc.but_txt,{miterLimit:3,strokeThickness:3,stroke:"#3b2e23"}),setTextStyle(this.mandats.win.level4_mc.travm_desc,{miterLimit:3,strokeThickness:3,stroke:"#3b2e23"}),setTextStyle(this.mandats.win.level4_mc.travm_txt,{miterLimit:3,strokeThickness:3,stroke:"#3b2e23"}),setTextStyle(this.mandats.win.level4_mc.def_desc,{miterLimit:3,strokeThickness:3,stroke:"#3b2e23"}),setTextStyle(this.mandats.win.level4_mc.def_txt,{miterLimit:3,strokeThickness:3,stroke:"#3b2e23"})}}class n{constructor(t,e,s,i,o,a,n,h,l,r,m,_){this.fight=t,this.bgs=e,this.bosses=s,this.exit=i,this.data={},this.combo=o,this.combo_gift=a,this.obmen=n,this.combo_full_true=h,this.box_donat=l,this.box_donat_slot=r,this.kalmar_top=m,this.kalmar_top_slot=_,this.initUnics(),this.initButtons(),this.top_damagers=this.colors=this.scroll_pack_ar=[],this.damage_coef=[1,10,100,1e3,1e4,1e5,5e5,1e6],this.xx_obmen=[1,1,1,1],this.setup_mandat=this.auto_multiudar=this.setup_automultiudar=this.obmen.win_fight.check_auto_udar_mc.visible=this.exit.man_mc.blow_mc.save_damages_mc.check.visible=!1,this.obmen_startX=this.obmen.win_fight.line1_mc.x,this.obmen_endX=parseInt(this.obmen.win_fight.line1_mc.width),this.obmen_line_x=this.obmen.win_fight.line.x-13,this.obmen_realvalue=1,this.obmen_bool=!1,this.obmen_goanim=!0,this.obmen.win_fight.take_scroll.x=this.obmen_startX,this.obmen.win_fight.line.height=5,this.box_don_goanim=!0,this.top100_goanim=!1,this.top100_i=!1,this.top100_data=[],this.top100_slots=[],this.top100_loaders=[],this.top_position=this.obmen_downX=this.obmen_value=this.garant_line=this.wear_line=this.bronik_line=0;for(let t=0;t<4;t++)this.scroll_pack_ar.push(this.obmen_startX);this.weapon_buttons=[this.fight.panel_mc.butt1,this.fight.panel_mc.butt2,this.fight.panel_mc.butt3,this.fight.panel_mc.butt4,this.fight.panel_mc.butt5,this.fight.panel_mc.butt6,this.fight.panel_mc.butt7],this.weapon_blows=[this.fight.panel_mc.blow1,this.fight.panel_mc.blow2,this.fight.panel_mc.blow3,this.fight.panel_mc.blow4,this.fight.panel_mc.blow5,this.fight.panel_mc.blow6,this.fight.panel_mc.blow7],this.timers=[this.fight.panel_mc.tm1_mc,this.fight.panel_mc.tm2_mc,this.fight.panel_mc.tm3_mc],this.xxx_array=[this.fight.xxx1_mc,this.fight.xxx2_mc,this.fight.xxx3_mc,this.fight.xxx4_mc],this.active_umen=[this.fight.umen1_icon,this.fight.umen2_icon,this.fight.umen3_icon],this.blow_active_umen=[this.fight.blow_active_umen1,this.fight.blow_active_umen2,this.fight.blow_active_umen3],this.combo_true=[this.fight.combo_mc.combo_true_0,this.fight.combo_mc.combo_true_1,this.fight.combo_mc.combo_true_2,this.fight.combo_mc.combo_true_3,this.fight.combo_mc.combo_true_4,this.fight.combo_mc.combo_true_5,this.fight.combo_mc.combo_true_6,this.fight.combo_mc.combo_true_7,this.fight.combo_mc.combo_true_8],this.combo_block=[this.fight.combo_mc.combo_close_0,this.fight.combo_mc.combo_close_1,this.fight.combo_mc.combo_close_2,this.fight.combo_mc.combo_close_3,this.fight.combo_mc.combo_close_4,this.fight.combo_mc.combo_close_5,this.fight.combo_mc.combo_close_6,this.fight.combo_mc.combo_close_7,this.fight.combo_mc.combo_close_8],this.timers_autoudar=[this.fight.panel_mc.tm4_mc,this.fight.panel_mc.tm5_mc,this.fight.panel_mc.tm6_mc,this.fight.panel_mc.tm7_mc],this.active_umen[0].visible=this.active_umen[1].visible=this.active_umen[2].visible=!1,TIMERS.timers.custom.init=!0,TIMERS.timers.custom.tick.push((()=>this.activeUmen())),TIMERS.timers.custom.tick.push((()=>this.weaponTickAutoUdar()));for(let t=0;t<this.active_umen.length;t++)this.active_umen[t].on("mouseover",(t=>helper.fadeAnimation(this.blow_active_umen[this.active_umen.indexOf(t.currentTarget)],"fadeIn"))),this.active_umen[t].on("mouseout",(t=>helper.fadeAnimation(this.blow_active_umen[this.active_umen.indexOf(t.currentTarget)],"fadeOut")));for(let t=0;t<this.weapon_buttons.length;t++){setButton(this.weapon_buttons[t]);let e=t;helper.clickControl(this.weapon_buttons[t],null,(t=>this.clickWeapon(e)),(()=>{if(this.obmen_fun=()=>{this.auto_multiudar?this.setup_automultiudar=!0:this.setup_automultiudar=!1,this.setup_automultiudar?this.stopObmen():this.clickWeapon(e,!0)},e>2){this.active_weap=e,this.auto_udar_weap!=e&&(this.auto_multiudar=this.obmen.win_fight.check_auto_udar_mc.visible=this.setup_automultiudar=!1),this.setup_automultiudar||(this.obmen.win_fight.check_auto_udar_mc.visible=this.auto_multiudar=this.setup_automultiudar),this.cl_autoudar=()=>this.clickAutoUdar(e),this.obmen.win_fight.indic_garant_mc.visible=this.obmen.win_fight.indic_wear_mc.visible=this.obmen.win_fight.indic_bronik_mc.visible=this.obmen.win_fight.indic_fight_mc.visible=!0,this.indicat_array=[this.obmen.win_fight.indic_fight_mc],this.count_indicator=1,-1==boss_modes[0].indexOf(parseInt(this.data.bid))?parseInt(this.data.mode)<3&&(this.indicat_array.push(this.obmen.win_fight.indic_garant_mc),this.indicat_array.push(this.obmen.win_fight.indic_wear_mc),this.count_indicator=3):(this.indicat_array.push(this.obmen.win_fight.indic_bronik_mc),this.count_indicator=2),this.this_mandat=udata.mandat_dmg_bonus[this.active_weap]||0,this.this_wear=udata.wear_dmg_bonus[this.active_weap-3]||0;let s=this.obmen_line_x,i=this.obmen.win_fight.line.width;for(let t=0;t<this.indicat_array.length;t++)this.indicat_array[t].on("mouseover",(t=>this.blowIndic(t))),this.indicat_array[t].on("mouseout",(()=>{helper.fadeAnimation(this.obmen.win_fight.blow_indic_mc,"fadeOut")})),t>0&&(this.indicat_array[t].x=s+=i/this.count_indicator,i-=s-this.obmen_line_x,this.count_indicator--);this.garant_line=(this.obmen.win_fight.indic_garant_mc.x-this.obmen_line_x+2.5)/(this.obmen_line_x+this.obmen.win_fight.line.width-this.obmen_line_x),this.wear_line=(this.obmen.win_fight.indic_wear_mc.x-this.obmen_line_x+2.5)/(this.obmen_line_x+this.obmen.win_fight.line.width-this.obmen_line_x),this.bronik_line=(this.obmen.win_fight.indic_bronik_mc.x-this.obmen_line_x+2.5)/(this.obmen_line_x+this.obmen.win_fight.line.width-this.obmen_line_x),this.xxx_obmen=[this.obmen.win_fight.x1_mc,this.obmen.win_fight.x10_mc,this.obmen.win_fight.x100_mc,this.obmen.win_fight.x1k_mc,this.obmen.win_fight.x10k_mc,this.obmen.win_fight.x100k_mc,this.obmen.win_fight.x500k_mc,this.obmen.win_fight.x1kk_mc];for(let e=0;e<this.xxx_obmen.length;e++)setButton(this.xxx_obmen[e]),this.xxx_obmen[e].visible=Boolean((this.xx_obmen[t-3]==Math.pow(10,e)||this.xx_obmen[t-3]==Math.pow(10,e-1))&&this.damage_coef[e]==this.xx_obmen[t-3]||this.xx_obmen[t-3]==Math.pow(10,e)/2);this.obmen_vals="weapon"+(e-3),this.obmen_by_coef=1*this.xx_obmen[t-3];for(let e=0;e<this.xxx_obmen.length;e++)this.xxx_obmen[e].on("pointerdown",(e=>this.clickXXX(t,e)));this.startObmen()}})),this.weapon_buttons[t].on("mouseover",(t=>{TIMERS.timers.boss_timer.init&&this.weapon_buttons.indexOf(t.currentTarget)<3||helper.fadeAnimation(this.weapon_blows[this.weapon_buttons.indexOf(t.currentTarget)],"fadeIn")})),this.weapon_buttons[t].on("mouseout",(t=>{TIMERS.timers.boss_timer.init&&this.weapon_buttons.indexOf(t.currentTarget)<3||helper.fadeAnimation(this.weapon_blows[this.weapon_buttons.indexOf(t.currentTarget)],"fadeOut")}))}this.exit.interactive=this.box_donat.interactive=this.combo_gift.interactive=this.combo.interactive=this.obmen.interactive=this.kalmar_top.interactive=!0,this.fight.update_mc.butt_mc.on("mouseover",(t=>helper.fadeAnimation(t.currentTarget.parent.blow_mc,"fadeIn",200))),this.fight.update_mc.butt_mc.on("mouseout",(t=>helper.fadeAnimation(t.currentTarget.parent.blow_mc,"fadeOut",200))),this.fight.exit_mc.butt_mc.on("mouseover",(t=>helper.fadeAnimation(t.currentTarget.parent.blow_mc,"fadeIn",200))),this.fight.exit_mc.butt_mc.on("mouseout",(t=>helper.fadeAnimation(t.currentTarget.parent.blow_mc,"fadeOut",200))),this.fight.percs_mc.butt_mc.on("mouseover",(t=>helper.fadeAnimation(t.currentTarget.parent.blow_mc,"fadeIn",200))),this.fight.percs_mc.butt_mc.on("mouseout",(t=>helper.fadeAnimation(t.currentTarget.parent.blow_mc,"fadeOut",200))),this.fight.box_donat_boss.list_barsetka_mc.icon_barsetka_kalmar.on("mouseover",(()=>helper.fadeAnimation(this.fight.box_donat_boss.bl_open_mc,"fadeIn",200))),this.fight.box_donat_boss.list_barsetka_mc.icon_barsetka_kalmar.on("mouseout",(()=>helper.fadeAnimation(this.fight.box_donat_boss.bl_open_mc,"fadeOut",200))),this.fight.update_mc.butt_mc.on("pointerdown",(()=>TS.php("fights.check",{},(t=>{main_menu.fightStatus(t),this.updateBoss()}),rootClass.onError))),this.fight.exit_mc.butt_mc.on("pointerdown",(()=>this.exitFight())),this.fight.percs_mc.butt_mc.on("pointerdown",(()=>umen.showUmen())),this.fight.box_donat_boss.list_barsetka_mc.icon_barsetka.on("pointerdown",(()=>this.showBoxDonat())),this.box_donat.panel_mc.close_mc.on("pointerdown",(()=>{this.box_don_goanim||(this.box_donat.panel_mc.y=-339,this.box_donat.shadow_mc.alpha=.01,this.box_donat.parent&&root.layer1_mc.removeChild(this.box_donat))})),this.box_donat.panel_mc.butt_mc.on("mouseover",(()=>helper.fadeAnimation(this.box_donat.blow_mc,"fadeIn",200))),this.box_donat.panel_mc.butt_mc.on("mouseout",(()=>helper.fadeAnimation(this.box_donat.blow_mc,"fadeOut",200))),this.obmen.win_fight.butt_fight_mc.on("pointerdown",(()=>this.obmen_fun())),this.obmen.win_fight.close_mc.on("pointerdown",(()=>this.stopObmen())),this.obmen.win_fight.line1_mc.on("pointerdown",(t=>this.updPosition(t))),this.obmen.win_fight.take_scroll.on("pointerdown",(t=>this.downObmen(t))),root.on("pointermove",(t=>this.pointerMove(t))),root.on("pointerup",(t=>{this.activate_mousemove=this.obmen_bool=!1})),this.obmen.win_fight.indic_garant_mc.on("pointerdown",(t=>this.obmenWeap(t))),this.obmen.win_fight.indic_wear_mc.on("pointerdown",(t=>this.obmenWeap(t))),this.obmen.win_fight.indic_bronik_mc.on("pointerdown",(t=>this.obmenWeap(t))),this.exit.man_mc.blow_mc.nonex_mc.on("pointerdown",(()=>root.layer1_mc.removeChild(this.exit))),this.exit.man_mc.blow_mc.butt_mc.on("pointerdown",(()=>{let t=this.exit.man_mc.blow_mc.save_damages_mc.check.visible?1:0;TS.php("fights.exit",{save:t},(t=>main_menu.fightStatus(t)),rootClass.onError),root.layer1_mc.removeChild(this.exit)}));for(let t=0;t<this.xxx_array.length;t++)setButton(this.xxx_array[t]),this.xxx_array[t].on("pointerdown",(t=>{let e=this.xxx_array.indexOf(t.currentTarget);localStore.weapons[e]+=1,localStore.weapons[e]>7&&(localStore.weapons[e]=0),saveLocalStorage(),this.updateXXX()}));this.fight.mandat_mc.butt_mc.on("mouseover",(()=>{helper.fadeAnimation(this.fight.blow_mnd,"fadeIn",300)})),this.fight.mandat_mc.butt_mc.on("mouseout",(()=>{helper.fadeAnimation(this.fight.blow_mnd,"fadeOut",300)})),this.fight.panel_mc.up_bt.on("pointerdown",(()=>this.upTop())),this.fight.panel_mc.down_bt.on("pointerdown",(()=>this.downTop())),this.fight.mandat_mc.butt_mc.on("pointerdown",(()=>{mandats.showMandats()})),this.combo_gift.win.get_mc.on("pointerdown",(()=>root.layer1_mc.removeChild(this.combo_gift))),window.addEventListener("focus",(()=>{this.obmen.win_fight.check_auto_udar_mc.visible&&(this.auto_multiudar=!0)})),window.addEventListener("blur",(()=>this.auto_multiudar=!1)),helper.clickControl(this.obmen.win_fight.square_auto_udar_mc,null,(()=>this.cl_autoudar())),this.fight.panel_mc.kalmar_top_mc.on("pointerdown",(()=>helper.getJSON(my_server+"/json/cache/calmar_top.json?hash="+md5(Math.random().toString()),(t=>this.showTop100Kalmar(t)),rootClass.onError))),this.kalmar_top.win.arrows_mc.prev_bt.on("pointerdown",(()=>this.top100KalmarPrev())),this.kalmar_top.win.arrows_mc.next_bt.on("pointerdown",(()=>this.top100KalmarNext())),this.kalmar_top.win.close_mc.on("pointerdown",(()=>root.layer1_mc.removeChild(this.kalmar_top))),this.exit.man_mc.blow_mc.save_damages_mc.chb.on("pointerdown",(()=>{this.exit.man_mc.blow_mc.save_damages_mc.check.visible=1!=this.exit.man_mc.blow_mc.save_damages_mc.check.visible})),modules.checkFlags(["doping"],(()=>{doping.open.win.close_mc.on("pointerdown",(()=>doping.hideBox()))})),this.fight.box_donat_boss.list_barsetka_mc.icon_barsetka_kalmar.on("pointerdown",(()=>{for(let t=0;t<doping.replay_butt.length;t++)doping.replay_butt[t].visible=doping.replay_txt[t].visible=!0;modules.checkFlags(["doping","coll"],(()=>{TS.php("fights.boxKalmar",{bid:0},(t=>{udata=t.udata,doping.openBox(t),this.updateBoxKalmar()}),rootClass.onError)}))})),this.fight.send_friends_mc.on("pointerdown",(()=>{TS.php("fights.friends",{},(t=>{this.fight.send_friends_mc.visible=!Boolean(parseInt(t.boss.check_friends)),modules.checkFlags(["notify"],(()=>{notify.result.win.x=-416,notify.result.shadow_mc.alpha=0,notify.result.win.title_txt.text="Внимание!",notify.result.win.info_txt.text="Ваша банда друзей выехала!",helper.fadeAnimation(notify.result.shadow_mc,"fadeIn",300),gsap.to(notify.result.win,{x:209,duration:.5,ease:"back.out(1.7)"}),root.layer1_mc.addChild(notify.result)})),this.active_umen[0].y=this.active_umen[1].y=this.active_umen[2].y=200,this.blow_active_umen[0].y=this.blow_active_umen[1].y=this.blow_active_umen[2].y=136}),rootClass.onError)}))}pointerMove(t){if(this.obmen_bool){let e={x:this.obmen_startX-(this.obmen_startX+this.obmen.win_fight.x-t.data.global.x)};this.obmen.win_fight.take_scroll.x=Math.floor(e.x-this.obmen_downX),e.x-this.obmen_downX>=this.obmen_startX+this.obmen_endX&&(this.obmen.win_fight.take_scroll.x=this.obmen_startX+this.obmen_endX),e.x-this.obmen_downX<=this.obmen_startX&&(this.obmen.win_fight.take_scroll.x=this.obmen_startX),this.scroll_pack_ar[this.active_weap-3]=this.obmen.win_fight.take_scroll.x,this.updObmen()}(t.data.global.x<20||t.data.global.x>730)&&(this.activate_mousemove=this.obmen_bool=!1)}init(){for(this.updateXXX(),udata.combo_info["boss"+this.data.bid]=udata.combo_info["boss"+this.data.bid]||0,helper.goLocation(9);this.fight.bg_mc.children.length;)this.fight.bg_mc.removeChildAt(0);for(;this.fight.boss_anim.children.length;)this.fight.boss_anim.removeChildAt(0);this.fight.bg_mc.addChild(this.bgs[this.data.bid]),this.fight.boss_anim.addChild(this.bosses[this.data.bid]),this.fight.panel_mc.name_txt.text=helper.decode64(bosses[this.data.bid].name),TIMERS.timers.boss_ftime.init||(TIMERS.timers.boss_ftime={init:!0,tick:t=>{this.lifetimeTick(t)}}),this.lifetimeTick(TIMERS.bossControl()),root.layer0_mc.addChild(this.fight),this.updateBoss()}showTop100Kalmar(t){this.top100_data=t,this.kalmar_top.shadow_mc.alpha=this.kalmar_top.shadow_box.alpha=0,this.kalmar_top.win.y=-600,this.kalmar_top.bg_mc.visible=!1,this.top100FormKalmar(),helper.fadeAnimation(this.kalmar_top.shadow_mc,"fadeIn",300,(()=>{helper.fadeAnimation(this.kalmar_top.bg_mc,"fadeIn",1e3),this.kalmar_top.bg_mc.visible=!0,gsap.to(this.kalmar_top.win,{y:101,duration:1,ease:"back.out(1.3)",onComplete:()=>{helper.fadeAnimation(this.kalmar_top.shadow_box,"fadeIn",100)}})})),root.layer1_mc.addChild(this.kalmar_top)}top100FormKalmar(){for(;this.kalmar_top.win.slots_mc.children.length;)this.kalmar_top.win.slots_mc.removeChildAt(0);this.top100_slots=[],this.top100_loaders=[];let t=[];for(let e=0;e<this.top100_data.length;e++){let s=helper.duplicate(this.kalmar_top_slot);s.i_mc.visible=!1,s.want_txt.text="Нанес "+helper.getNumberRazdel(this.top100_data[e].damage)+" урона",s.want_mc.num_exp_mc.num_txt.text="x"+helper.getNumber(top_kalmar[e].exp),s.want_mc.num_coins_mc.num_txt.text="x"+helper.getNumber(top_kalmar[e].coins),s.want_mc.num_gold_mc.num_txt.text="x"+helper.getNumber(top_kalmar[e].gold),s.want_mc.num_semki_mc.num_txt.text="x"+helper.getNumber(top_kalmar[e].semki),s.want_mc.num_wear_mc.num_txt.text="x"+helper.getNumber(Math.floor(this.top100_data[e].damage/1e12)),this.top100_slots.push(s),s.y=59*(this.top100_slots.length-1),setButton(s),s.on("pointerdown",(t=>{iface.goGuest(this.top100_data[this.top100_slots.indexOf(t.currentTarget)].id),helper.fadeAnimation(this.kalmar_top,"fadeOut",350,(()=>{this.kalmar_top.parent&&root.layer1_mc.removeChild(this.kalmar_top),this.kalmar_top.alpha=1,this.kalmar_top.visible=!0}))})),this.top100_data[e].id==vk_params.viewer_id&&(s.i_mc.visible=!0),t.push(this.top100_data[e].id),this.kalmar_top.win.slots_mc.addChild(s)}helper.loadNames(t,(t=>{for(let e=0;e<this.top100_slots.length;e++)helper.loadPhoto50(this.top100_data[e].id,(t=>{t.scale.x=t.scale.y=.7,this.top100_slots[e].photo_mc.addChild(t)}),t[e].photo_50),this.top100_slots[e].name_txt.text="ТОП-"+(e+1)+". "+t[e].first_name+" "+t[e].last_name.substr(0,1)+"."}))}top100KalmarPrev(){if(this.top100_goanim||this.top100_slots.length<2)return;let t;this.top100_goanim=!0;for(let e=0;e<this.top100_slots.length;e++)this.top100_slots[e].y==59*(this.top100_slots.length-1)&&(t=e),e!==t&&gsap.to(this.top100_slots[e],{duration:.3,y:this.top100_slots[e].y+59});helper.fadeAnimation(this.top100_slots[t],"fadeOut",100),gsap.to(this.top100_slots[t].scale,{duration:.1,x:.8,y:.8,onComplete:()=>{gsap.to(this.top100_slots[t],.1,{y:0,onComplete:()=>{helper.fadeAnimation(this.top100_slots[t],"fadeIn",100),gsap.to(this.top100_slots[t].scale,{duration:.1,x:1,y:1,onComplete:()=>{this.top100_goanim=!1}})}})}})}top100KalmarNext(){if(this.top100_goanim||this.top100_slots.length<2)return;let t;this.top100_goanim=!0;for(let e=0;e<this.top100_slots.length;e++)0==this.top100_slots[e].y&&(t=e),e!==t&&gsap.to(this.top100_slots[e],{duration:.3,y:this.top100_slots[e].y-59});helper.fadeAnimation(this.top100_slots[t],"fadeOut",100),gsap.to(this.top100_slots[t].scale,{duration:.1,x:.8,y:.8,onComplete:()=>{gsap.to(this.top100_slots[t],{duration:.1,y:59*(this.top100_slots.length-1),onComplete:()=>{gsap.to(this.top100_slots[t].scale,.1,{duration:.1,x:1,y:1,onComplete:()=>{this.top100_goanim=!1,this.top100_slots[t].scale.x=this.top100_slots[t].scale.y=1}}),helper.fadeAnimation(this.top100_slots[t],"fadeIn",100)}})}})}showBoxDonat(){helper.fadeAnimation(this.box_donat.shadow_mc,"fadeIn",500,(()=>{gsap.to(this.box_donat.panel_mc,{y:210,ease:"back.out(1.3)",duration:1,onComplete:()=>this.box_don_goanim=!1})})),this.box_donat.panel_mc.slot_mc.visible=!1,this.box_donat.panel_mc.butt_mc.visible=!1,this.box_donat.panel_mc.no_rewards_txt.visible=!0,this.box_donat.panel_mc.lvl_txt.text=udata.box_donat.level+" уровень",udata.box_donat.rewards.weapons&&(udata.box_donat.rewards=Object.assign({weapon3:udata.box_donat.rewards.weapons[0]},udata.box_donat.rewards),udata.box_donat.rewards=Object.assign({weapon4:udata.box_donat.rewards.weapons[1]},udata.box_donat.rewards),udata.box_donat.rewards=Object.assign({weapon5:udata.box_donat.rewards.weapons[2]},udata.box_donat.rewards),delete udata.box_donat.rewards.weapons),udata.box_donat.rewards.key_donat_boss&&(udata.box_donat.rewards["key_donat_boss_"+udata.box_donat.rewards.key_donat_boss.id]=udata.box_donat.rewards.key_donat_boss.count,delete udata.box_donat.rewards.key_donat_boss);let t=Object.keys(udata.box_donat.rewards);if(this.box_slots)for(let t=this.box_slots.length-1;t>=0;t--)this.box_donat.panel_mc.removeChild(this.box_slots[t]);if(this.box_slots=[],this.slot_x=[30,145,260,30,145,260,30,145,260],this.slot_y=[56,58,60,115,117,119,174,176,178],t.length>0){for(let e=0;e<t.length;e++){let s=helper.duplicate(this.box_donat_slot);s.x=this.slot_x[e],s.y=this.slot_y[e],s.reward_mc.gotoAndPlay(t[e]),s.reward_mc.gotoAndStop(t[e]),s.count_txt.text="+"+helper.shortText(udata.box_donat.rewards[t[e]]),"wear"==t[e]&&(s.count_txt.text="+"+helper.shortText(udata.box_donat.rewards[t[e]][1])),"coins"==t[e]&&(s.count_txt.x=s.count_txt.x-5),this.box_slots.push(s)}this.box_donat.panel_mc.butt_mc.visible=!0,this.box_donat.panel_mc.no_rewards_txt.visible=!1}for(let t=this.box_slots.length-1;t>=0;t--)this.box_donat.panel_mc.addChild(this.box_slots[t]);this.box_donat.panel_mc.butt_mc.on("pointerdown",(()=>{modules.checkFlags(["notify"],(()=>{notify.accept_fun=()=>TS.php("fights.get_box_donat",{},(t=>this.getRewardsBoxDonat(t)),rootClass.onError),notify.accept.win.tf_txt.text=5,notify.accept.win.val_mc.gotoAndStop("t_coin"),notify.showAccept()}))})),this.box_donat.blow_mc.price_conserve_txt.text="-5",root.layer1_mc.addChild(this.box_donat)}getRewardsBoxDonat(t){this.box_don_goanim||(udata.box_donat.rewards.wear&&fights_windows.showCraft(udata.box_donat.rewards.wear[0]),iface.updateUp(),achives.refresh(t.achives_level),iface.showChotko(),this.fight.box_donat_boss.visible=!1,fights.box_donat.panel_mc.y=-339,fights.box_donat.shadow_mc.alpha=.01,root.layer1_mc.removeChild(this.box_donat))}clickXXX(t,e){if(this.active_weap==t){if(this.anim)return;this.anim=!0;let s=t,i=this.xxx_obmen.indexOf(e.currentTarget);this.xxx_obmen[i].visible=!1,7==i?(this.xxx_obmen[0].visible=!0,this.xx_obmen[s-3]=this.damage_coef[0]):(this.xxx_obmen[i+1].visible=!0,this.xx_obmen[s-3]=this.damage_coef[i+1]),this.obmen_by_coef=1*this.xx_obmen[s-3],this.obmen.win_fight.take_scroll.x=this.obmen_startX,this.updObmen(),this.anim=!1}}clickAutoUdar(t){this.auto_multiudar?this.auto_multiudar=this.obmen.win_fight.check_auto_udar_mc.visible=this.setup_automultiudar=!1:this.auto_multiudar=this.obmen.win_fight.check_auto_udar_mc.visible=!0,this.auto_multiudar&&(this.auto_udar_weap=t,this.auto_udar_time=0)}obmenWeap(t){if(this.active_weap<6||0==this.data.armor){switch(this.damage=Math.floor((parseInt(damages[this.active_weap])+parseInt(this.this_mandat)+parseInt(this.this_wear))*udata.damage_coef[this.active_weap]),t.target.name){case"indic_garant_mc":this.nado=parseInt(bosses[this.data.bid].mods[this.data.mode].val_garant)-parseInt(udata.maxdamage);break;case"indic_wear_mc":this.nado=parseInt(bosses[this.data.bid].mods[this.data.mode].wear_garant)-parseInt(udata.maxdamage)>0?parseInt(bosses[this.data.bid].mods[this.data.mode].wear_garant)-parseInt(udata.maxdamage):parseInt(bosses[this.data.bid].mods[this.data.mode].wear_garant)*(parseInt(this.data.dop)+2)-parseInt(udata.maxdamage);break;case"indic_bronik_mc":this.nado=parseInt(this.data.armor)}this.use_weap_pack=Math.ceil(this.nado/this.damage),this.use_weap_pack>9&&(this.crit=udata.mandat_critical/10,this.use_weap_pack=Math.ceil(this.use_weap_pack/(100+this.crit)/.01)),this.use_weap_pack>9999?(this.xxx_obmen[4].visible=!0,this.xxx_obmen[0].visible=this.xxx_obmen[1].visible=this.xxx_obmen[2].visible=this.xxx_obmen[3].visible=!1,this.xx_use_weap_pack=this.damage_coef[4]):this.use_weap_pack>999?(this.xxx_obmen[3].visible=!0,this.xxx_obmen[0].visible=this.xxx_obmen[1].visible=this.xxx_obmen[2].visible=this.xxx_obmen[4].visible=!1,this.xx_use_weap_pack=this.damage_coef[3]):this.use_weap_pack>99?(this.xxx_obmen[2].visible=!0,this.xxx_obmen[0].visible=this.xxx_obmen[1].visible=this.xxx_obmen[3].visible=this.xxx_obmen[4].visible=!1,this.xx_use_weap_pack=this.damage_coef[2]):this.use_weap_pack>9?(this.xxx_obmen[1].visible=!0,this.xxx_obmen[0].visible=this.xxx_obmen[2].visible=this.xxx_obmen[3].visible=this.xxx_obmen[4].visible=!1,this.xx_use_weap_pack=this.damage_coef[1]):(this.xxx_obmen[0].visible=!0,this.xxx_obmen[1].visible=this.xxx_obmen[2].visible=this.xxx_obmen[3].visible=this.xxx_obmen[4].visible=!1,this.xx_use_weap_pack=this.damage_coef[0]),this.scroll_pack_ar[this.active_weap-3]=this.obmen_startX+this.use_weap_pack/this.xx_use_weap_pack*(this.obmen_endX/100),this.scroll_pack_ar[this.active_weap-3]>this.obmen_startX+this.obmen_endX&&(this.scroll_pack_ar[this.active_weap-3]=this.obmen_startX+this.obmen_endX),this.obmen.win_fight.take_scroll.x=this.scroll_pack_ar[this.active_weap-3],this.obmen_by_coef=1*this.xx_use_weap_pack,this.xx_obmen[this.active_weap-3]=this.xx_use_weap_pack,this.obmen.win_fight.by2_mc.tf_txt.text=helper.shortText(this.use_weap_pack),this.lineProgress(Math.ceil(this.nado/this.damage)),this.updObmen}}blowIndic(t){switch(this.damage=Math.floor((parseInt(damages[this.active_weap])+parseInt(this.this_mandat)+parseInt(this.this_wear))*udata.damage_coef[this.active_weap]),t.currentTarget.name){case"indic_garant_mc":this.obmen.win_fight.blow_indic_mc.name_txt.text="Гарант награды",this.obmen.win_fight.blow_indic_mc.x=this.obmen.win_fight.indic_garant_mc.x-32.5,this.nado=parseInt(bosses[this.data.bid].mods[this.data.mode].val_garant)-parseInt(udata.maxdamage);break;case"indic_wear_mc":this.obmen.win_fight.blow_indic_mc.name_txt.text="Гарант шмота",this.obmen.win_fight.blow_indic_mc.x=this.obmen.win_fight.indic_wear_mc.x-32.5,this.nado=parseInt(bosses[this.data.bid].mods[this.data.mode].wear_garant)-parseInt(udata.maxdamage)>0?parseInt(bosses[this.data.bid].mods[this.data.mode].wear_garant)-parseInt(udata.maxdamage):parseInt(bosses[this.data.bid].mods[this.data.mode].wear_garant)*(parseInt(this.data.dop)+2)-parseInt(udata.maxdamage);break;case"indic_bronik_mc":this.obmen.win_fight.blow_indic_mc.name_txt.text="Броник",this.obmen.win_fight.blow_indic_mc.x=this.obmen.win_fight.indic_bronik_mc.x-32.5,this.nado=parseInt(this.data.armor),6==this.active_weap&&(this.nado=0);break;case"indic_fight_mc":this.obmen.win_fight.blow_indic_mc.name_txt.text="Убить босса (добить)",this.obmen.win_fight.blow_indic_mc.x=this.obmen.win_fight.indic_fight_mc.x-32.5,this.nado=parseInt(this.data.xp)+parseInt(this.data.armor)-parseInt(udata.maxdamage)}this.useW=Math.ceil(this.nado/this.damage),this.obmen.win_fight.blow_indic_mc.count_txt.text=helper.getNumberRazdel(this.useW),helper.fadeAnimation(this.obmen.win_fight.blow_indic_mc,"fadeIn")}showComboBox(t=!1){let e=this.combo.boxes_mc["box"+udata.combo_info["boss"+this.data.bid]];t.wear?this.combo_gift.win.wear_mc.gotoAndStop("w"+t.wear):this.combo_gift.win.wear_mc.gotoAndStop(0),this.combo_gift.win.coins_txt.text=t.coins,this.combo_gift.win.gold_txt.text=t.gold,this.combo_gift.win.weap1_txt.text=t.weapons[0],this.combo_gift.win.weap2_txt.text=t.weapons[1],this.combo_gift.win.weap3_txt.text=t.weapons[2],helper.fadeAnimation(this.combo,"fadeIn",2e3,(()=>{e.gotoAndPlay(1),this.combo_gift.alpha=0,helper.fadeAnimation(this.combo,"fadeOut",4e3,(()=>{root.layer1_mc.removeChild(this.combo)})),root.layer1_mc.addChild(this.combo_gift),helper.fadeAnimation(this.combo_gift,"fadeIn",2e3)})),this.combo.boxes_mc.box1.visible=this.combo.boxes_mc.box2.visible=this.combo.boxes_mc.box3.visible=!1,e.visible=!0,root.layer1_mc.addChild(this.combo)}exitFight(){this.exit.alpha=this.exit.man_mc.blow_mc.alpha=0,this.exit.man_mc.x=936,helper.fadeAnimation(this.exit,"fadeIn",300,(()=>{gsap.to(this.exit.man_mc,{duration:.3,x:498,onComplete:()=>{helper.fadeAnimation(this.exit.man_mc.blow_mc,"fadeIn",300)}})})),root.layer1_mc.addChild(this.exit)}animateMandat(t){if((!this.setup_mandat||"start"!=t)&&("stop"==t&&(this.setup_mandat=!1),"start"==t)){let t=()=>{this.setup_mandat&&helper.alphaAnimation(this.fight.mandat_mc.icon_mc,.3,300,e)},e=()=>{helper.alphaAnimation(this.fight.mandat_mc.icon_mc,1,300,t)};helper.alphaAnimation(this.fight.mandat_mc.icon_mc,.3,300,e),this.setup_mandat=!0}}updateBoxKalmar(){Array.isArray(udata.maxdamage_kalmar)||(udata.maxdamage_kalmar=[]),udata.maxdamage_kalmar[this.data.mode]=udata.maxdamage_kalmar[this.data.mode]||0;let t=Math.floor(udata.maxdamage_kalmar[this.data.mode]/bosses[this.data.bid].mods[this.data.mode].box.damage),e=udata.maxdamage_kalmar[this.data.mode]-bosses[this.data.bid].mods[this.data.mode].box.damage*t;this.fight.box_donat_boss.lvl_txt.text=t,this.fight.box_donat_boss.damage_txt.text=helper.shortText(e)+"/"+helper.shortText(bosses[this.data.bid].mods[this.data.mode].box.damage),gsap.to(this.fight.box_donat_boss.line_mc.full_mc,{duration:.3,x:e/bosses[this.data.bid].mods[this.data.mode].box.damage*111-111})}updateBoss(){TIMERS.timers.boss_timer.init||(TIMERS.timers.boss_timer={init:!0,tick:t=>{this.weaponTick(t)}}),this.weaponTick(TIMERS.bossTimerControl()),gsap.to(this.fight.combo_mc.line_mc.full_mc,{x:this.data.combo/9*180-180,duration:.1}),udata.combo_info["boss"+this.data.bid]=udata.combo_info["boss"+this.data.bid]||0;let t=udata.combo_info["boss"+this.data.bid];1==udata.combo_info.get||3==t?this.fight.combo_mc.visible=!1:this.fight.combo_mc.visible=!0,this.active_umen[0].y=this.active_umen[1].y=this.active_umen[2].y=220,this.blow_active_umen[0].y=this.blow_active_umen[1].y=this.blow_active_umen[2].y=155,1==this.data.check_friends&&(this.active_umen[0].y=this.active_umen[1].y=this.active_umen[2].y=200,this.blow_active_umen[0].y=this.blow_active_umen[1].y=this.blow_active_umen[2].y=136);for(let e=1;e<4;e++)this.fight.combo_mc["box"+e+"_mc"].visible=!(e<=t);let e=this.data.xp/bosses[this.data.bid].mods[this.data.mode].xp,s=this.data.armor/bosses[this.data.bid].mods[this.data.mode].armor;if(e>=.7&&(window.stage_boss=1),e<.7&&(window.stage_boss=2),e<=.3&&(window.stage_boss=3),helper.scaleAnimation(this.fight.panel_mc.lifes_mc.lifeline_mc,e,300),helper.scaleAnimation(this.fight.panel_mc.bronik_mc.lifeline_mc,s,300),this.updateXXX(),this.fight.mandat_mc.damage_txt.text="максимум",udata.mandat_level<2?parseInt(udata.mandat_lvl)<mandats_info.l[udata.mandat_level].length+mandats_info.l[0].length*udata.mandat_level?(this.fight.mandat_mc.damage_txt.text=helper.shortText(udata.mandat_dmg)+"/"+helper.shortText(mandats_info.l[udata.mandat_level][parseInt(udata.mandat_lvl)-mandats_info.l[0].length*udata.mandat_level]),gsap.to(this.fight.mandat_mc.line_mc.full_mc,{duration:.3,x:parseInt(udata.mandat_dmg)/parseInt(mandats_info.l[udata.mandat_level][parseInt(udata.mandat_lvl)-mandats_info.l[0].length*udata.mandat_level])*111-111})):gsap.to(this.fight.mandat_mc.line_mc.full_mc,{duration:.3,x:0}):(this.fight.mandat_mc.damage_txt.text="мандаты",gsap.to(this.fight.mandat_mc.line_mc.full_mc,{duration:.3,x:0})),parseInt(udata.mandat_lvl)-parseInt(udata.mandat_use)>0?helper.animateEl("start",this.fight.mandat_mc.icon_mc):helper.animateEl("stop",this.fight.mandat_mc.icon_mc),bosses[this.data.bid].mods[this.data.mode].exp_garant){this.fight.mandat_mc.bg1.visible=!1,this.fight.mandat_mc.bg2.visible=!0;let t=bosses[this.data.bid].mods[this.data.mode].val_garant,e=bosses[this.data.bid].mods[this.data.mode].wear_garant;if(udata.maxdamage>=t){this.fight.mandat_mc.bg2.exp_line.full_mc.x=0;let t=udata.mandat_dmg_bonus[6]||0,e=udata.wear_dmg_bonus[3]||0,s=Math.ceil((damages[6]+t+e)*udata.damage_coef[6]),i=100*([5,8,10][this.data.mode]/100+s/7e4);this.fight.mandat_mc.bg2.exp_txt.text="прибыль "+Math.floor(i)+"%"}else this.fight.mandat_mc.bg2.exp_txt.text="еще "+helper.shortText(t-udata.maxdamage),gsap.to(this.fight.mandat_mc.bg2.exp_line.full_mc,{duration:.3,x:udata.maxdamage/t*111-111});udata.maxdamage>=e&&-1==udata.buying.indexOf(bosses[this.data.bid].mods[this.data.mode].craft_wear)||-1==bosses[this.data.bid].mods[this.data.mode].craft_wear?(this.fight.mandat_mc.bg2.wear_line.full_mc.x=0,-1!=bosses[this.data.bid].mods[this.data.mode].craft_wear?this.fight.mandat_mc.bg2.wear_txt.text="шанс 90%":this.fight.mandat_mc.bg2.wear_txt.text="недоступно"):-1==udata.buying.indexOf(bosses[this.data.bid].mods[this.data.mode].craft_wear)?(this.fight.mandat_mc.bg2.wear_txt.text="еще "+helper.shortText(e-udata.maxdamage),gsap.to(this.fight.mandat_mc.bg2.wear_line.full_mc,{duration:.3,x:udata.maxdamage/e*111-111})):(this.fight.mandat_mc.bg2.wear_line.full_mc.x=0,this.fight.mandat_mc.bg2.wear_txt.text="собрано")}else this.fight.mandat_mc.bg2.visible=!1,this.fight.mandat_mc.bg1.visible=!0;this.fight.stats_mc.alpha=.3-.3*e,this.fight.stats_mc.visible=!0;let i=this.bosses[this.data.bid];if(0==this.data.armor&&i.anim&&i.anim.body?(i.anim.body.bronik_mc&&(i.anim.body.bronik_mc.visible=!1),i.anim.bronik_up&&(i.anim.bronik_up.visible=!1)):i.anim&&i.anim.body&&(i.anim.body.bronik_mc&&(i.anim.body.bronik_mc.visible=!0),i.anim.bronik_up&&(i.anim.bronik_up.visible=!0)),this.fight.box_donat_boss.visible=this.fight.box_donat_boss.bl_open_mc.visible=!1,this.fight.panel_mc.kalmar_top_mc.visible=Boolean("calmar"==bosses[this.data.bid].types),this.fight.send_friends_mc.visible=!Boolean(parseInt(this.data.check_friends)),this.exit.man_mc.blow_mc.save_damages_mc.visible=this.fight.panel_mc.kalmar_top_mc.visible,this.fight.box_donat_boss.y=538,"donat_boss"==bosses[this.data.bid].types&&bosses[this.data.bid].mods[this.data.mode].box){this.fight.box_donat_boss.list_barsetka_mc.gotoAndStop(0),0==udata.box_donat.get&&(this.fight.box_donat_boss.visible=!0),this.fight.box_donat_boss.lvl_txt.text=0,udata.box_donat&&(this.fight.box_donat_boss.lvl_txt.text=udata.box_donat.level),this.fight.box_donat_boss.damage_txt.text="максимум";let t=udata.box_donat.damage,e=0;for(let s=0;s<bosses[this.data.bid].mods[this.data.mode].box.levels.length;s++)t>=bosses[this.data.bid].mods[this.data.mode].box.levels[s]&&(t-=bosses[this.data.bid].mods[this.data.mode].box.levels[s]),e+=bosses[this.data.bid].mods[this.data.mode].box.levels[s];udata.box_donat.damage<e?(this.fight.box_donat_boss.damage_txt.text=helper.shortText(t)+"/"+helper.shortText(bosses[this.data.bid].mods[this.data.mode].box.levels[udata.box_donat.level]),gsap.to(this.fight.box_donat_boss.line_mc.full_mc,{duration:.3,x:t/bosses[this.data.bid].mods[this.data.mode].box.levels[udata.box_donat.level]*111-111})):gsap.to(this.fight.box_donat_boss.line_mc.full_mc,{duration:.3,x:0})}else if("calmar"==bosses[this.data.bid].types)this.fight.box_donat_boss.list_barsetka_mc.gotoAndStop(1),this.fight.box_donat_boss.visible=this.fight.box_donat_boss.bl_open_mc.visible=!0,this.fight.box_donat_boss.bl_open_mc.price_txt.text="-"+bosses[this.data.bid].mods[this.data.mode].box.open,this.updateBoxKalmar();else if(1==this.data.type){this.fight.box_donat_boss.list_barsetka_mc.gotoAndStop(2),this.fight.box_donat_boss.y=310;let t=bosses[this.data.bid].mods[this.data.mode].wear_garant;if(bosses[this.data.bid].mods[this.data.mode].wear_garant&&-1!=bosses[this.data.bid].mods[this.data.mode].craft_wear&&-1==udata.buying.indexOf(bosses[this.data.bid].mods[this.data.mode].craft_wear)&&this.data.dop<2){this.fight.box_donat_boss.visible=!0;let e=0;this.fight.box_donat_boss.lvl_txt.text=this.data.dop,udata.maxdamage>=t&&(e=udata.maxdamage-t-this.data.dop*t<0?0:udata.maxdamage-t-this.data.dop*t),this.fight.box_donat_boss.damage_txt.text=helper.shortText(e)+"/"+helper.shortText(t),gsap.to(this.fight.box_donat_boss.line_mc.full_mc,{duration:.3,x:e/t*111-111})}}helper.numberAnimation(this.fight.panel_mc.bronik_mc.tf_txt,this.data.armor,90,!0,"",null,"."),helper.numberAnimation(this.fight.panel_mc.lifes_mc.tf_txt,this.data.xp,100,!0,"",(()=>{let t=this.fight.panel_mc.lifes_mc.tf_txt.getLocalBounds(),e=this.fight.panel_mc.bronik_mc.tf_txt.getLocalBounds();this.fight.panel_mc.lifes_mc.icon_mc.x=t.width+this.fight.panel_mc.lifes_mc.tf_txt.x+t.x,this.data.xp<1e3&&(this.fight.panel_mc.lifes_mc.icon_mc.x+=3),this.fight.panel_mc.bronik_mc.icon_mc.x=e.width+this.fight.panel_mc.bronik_mc.tf_txt.x+e.x,this.data.armor<1e3&&(this.fight.panel_mc.bronik_mc.icon_mc.x+=3)}),"."),this.top_position=0,this.updateTop(),learn.check()}activeUmen(){this.active_umen[0].visible=this.active_umen[1].visible=this.active_umen[2].visible=!1;let t=0;for(let e=0;e<udata.umen_active.length;e++){let s=udata.umen_active[e].id,i=parseInt(udata.umen_active[e].time)+parseInt(umen_info.umens[s].time);if(i>TIME){switch(setButton(this.active_umen[t]),this.active_umen[t].icon_mc.gotoAndStop(s),this.active_umen[t].cat_mc.gotoAndStop(umen_info.umens[s].type_icon),this.blow_active_umen[t].name_txt.text=umen_info.umens[s].name,umen_info.umens[s].bonus.type){case"emax_bonus":this.blow_active_umen[t].bonus_txt.text="+"+umen.ifCoef(s)+" к максимальной энергии",this.blow_active_umen[t].bonus_txt.y=2.45;break;case"damage_coef":this.blow_active_umen[t].bonus_txt.text="+"+umen.ifCoef(s)+" к "+umen.weapon_names[umen_info.umens[s].bonus.dop_type],this.blow_active_umen[t].bonus_txt.y=12;break;case"umen_bonus boss_coins":this.blow_active_umen[t].bonus_txt.text="x"+umen_info.umens[s].bonus.current+" монет за награду над боссом",this.blow_active_umen[t].bonus_txt.y=2.45;break;case"umen_bonus boss_key":this.blow_active_umen[t].bonus_txt.text="x"+umen_info.umens[s].bonus.current+" ключей за награду над подражателем",this.blow_active_umen[t].bonus_txt.y=2.45;break;case"umen_bonus open_all_bosses":this.blow_active_umen[t].bonus_txt.text="открытие всех залетных боссов",this.blow_active_umen[t].bonus_txt.y=2.45}this.blow_active_umen[t].time_txt.text=helper.timeString(i-TIME),this.active_umen[t].removeChild(this.active_umen[t].name_txt),this.active_umen[t].visible=!0,-1==helper.setup_element.indexOf(this.active_umen[t])&&i-TIME<300&&helper.animateEl("start",this.active_umen[t]),this.blow_active_umen[t].visible||(this.blow_active_umen[t].visible=!0),t++}else-1!=helper.setup_element.indexOf(this.active_umen[t])&&helper.animateEl("stop",this.active_umen[t]),this.blow_active_umen[t].visible=!1}}upTop(){0!=this.top_position&&(this.top_position--,this.updateTop())}downTop(){this.data.damagers.length-this.top_position-3<=0||(this.top_position++,this.updateTop())}updateTop(){let t=[];for(let e=0;e<this.data.damagers.length;e++)t.push(this.data.damagers[e].id);helper.loadNames(t,(()=>this.updateTopBody()))}updateTopBody(){for(this.top_damagers=[];this.fight.panel_mc.top_mc.children.length;)this.fight.panel_mc.top_mc.removeChildAt(0);for(let t=this.top_position;t<this.data.damagers.length&&t-this.top_position<3;t++){let e=new PIXI.Graphics;switch(this.top_damagers[t]=helper.duplicate(modules.names.fights.fight_topslot),this.top_damagers[t].name_txt.text=this.top_damagers[t].dmg_txt.text="-"+helper.shortText(this.data.damagers[t].damage),helper.loadNames(this.data.damagers[t].id,(e=>this.top_damagers[t].name_txt.text=e[0].first_name+" "+e[0].last_name.substr(0,1)+".")),this.top_damagers[t].ball_mc.addChild(e),t){case 0:e.beginFill(16764183);break;case 1:e.beginFill(12703449);break;case 2:e.beginFill(14391102);break;default:e.beginFill(6575435)}e.drawCircle(2,2,2.5),e.endFill(),this.top_damagers[t].y=18*(t-this.top_position),this.fight.panel_mc.top_mc.addChild(this.top_damagers[t]),setButton(this.top_damagers[t].butt_mc),this.top_damagers[t].butt_mc.on("pointerdown",(t=>{iface.goGuest(this.data.damagers[this.top_damagers.indexOf(t.currentTarget.parent)].id)}))}}startObmen(){this.obmen.bg_mc.visible=!1,this.obmen.shadow_mc.alpha=.01,this.obmen_goanim=!0,helper.fadeAnimation(this.obmen.shadow_mc,"fadeIn",500,(()=>{helper.fadeAnimation(this.obmen.bg_mc,"fadeIn",1e3),gsap.to(this.obmen.win_fight,{y:80,ease:"back.out(1.3)",duration:1,onComplete:()=>this.obmen_goanim=!1})})),this.updObmen(),root.layer1_mc.addChild(this.obmen)}stopObmen(){this.obmen_goanim||(this.obmen.win_fight.y=-339,this.obmen.shadow_mc.alpha=.01,root.layer1_mc.removeChild(this.obmen))}updObmen(){this.obmen_realvalue=1+parseInt((this.obmen.win_fight.take_scroll.x-this.obmen_startX)/this.obmen_endX*100),this.obmen.win_fight.by2_mc.tf_txt.text=helper.shortText(this.obmen_by_coef*this.obmen_realvalue),this.obmen.win_fight.by2_mc.val.gotoAndStop(this.obmen_vals),this.use_weap_pack=this.obmen_by_coef*this.obmen_realvalue,this.lineProgress(this.use_weap_pack)}lineProgress(t){this.damage=Math.floor((parseInt(damages[this.active_weap])+parseInt(this.this_mandat)+parseInt(this.this_wear))*udata.damage_coef[this.active_weap])*t+parseInt(udata.maxdamage),this.get_x=0,-1==boss_modes[0].indexOf(parseInt(this.data.bid))?(this.obmen.win_fight.indic_bronik_mc.visible=!1,-1!=udata.buying.indexOf(bosses[this.data.bid].mods[this.data.mode].craft_wear)&&(this.obmen.win_fight.indic_wear_mc.visible=!1),this.data.mode<3?(parseInt(bosses[this.data.bid].mods[this.data.mode].val_garant)>parseInt(udata.maxdamage)?(this.nado=parseInt(bosses[this.data.bid].mods[this.data.mode].val_garant),this.get_x+=parseInt(this.damage)/parseInt(this.nado)*100*this.garant_line/100,this.get_x>this.garant_line&&(this.get_x=this.garant_line)):(this.get_x=this.garant_line,this.obmen.win_fight.indic_garant_mc.visible=!1),-1!=bosses[this.data.bid].mods[this.data.mode].craft_wear?parseInt(3*bosses[this.data.bid].mods[this.data.mode].wear_garant)>parseInt(udata.maxdamage)&&-1==udata.buying.indexOf(bosses[this.data.bid].mods[this.data.mode].craft_wear)?this.garant_line==this.get_x&&(this.nado=parseInt(bosses[this.data.bid].mods[this.data.mode].wear_garant),this.get_x+=parseInt(this.damage)/parseInt(this.nado)*100*(this.wear_line-this.garant_line)/100,this.get_x>this.wear_line&&(this.get_x=this.wear_line)):(parseInt(bosses[this.data.bid].mods[this.data.mode].wear_garant)<parseInt(udata.maxdamage)&&(this.get_x=this.wear_line),-1!=udata.buying.indexOf(bosses[this.data.bid].mods[this.data.mode].craft_wear)&&(this.wear_line=this.garant_line),this.obmen.win_fight.indic_wear_mc.visible=!1):(this.wear_line=this.garant_line,this.obmen.win_fight.indic_wear_mc.visible=!1),this.nado=parseInt(this.data.xp),this.wear_line==this.get_x&&(this.get_x+=parseInt(this.damage)/parseInt(this.nado)*100*(1-this.wear_line)/100)):this.obmen.win_fight.indic_garant_mc.visible=this.obmen.win_fight.indic_wear_mc.visible=!1):(this.obmen.win_fight.indic_garant_mc.visible=this.obmen.win_fight.indic_wear_mc.visible=!1,parseInt(this.active_weap)<6&&(parseInt(this.data.armor)>0?(this.nado=parseInt(this.data.armor),this.get_x+=parseInt(this.damage)/parseInt(this.nado)*100*this.bronik_line/100,this.get_x>this.bronik_line&&(this.get_x=this.bronik_line)):(this.get_x=this.bronik_line,this.obmen.win_fight.indic_bronik_mc.visible=!1)),this.nado=parseInt(this.data.xp)+parseInt(this.data.armor),this.bronik_line==this.get_x&&(this.get_x+=parseInt(this.damage)/parseInt(this.nado)*100*(1-this.bronik_line)/100)),helper.scaleAnimation(this.obmen.win_fight.line.line_mc,this.get_x,100)}downObmen(t){this.obmen_bool=!0,this.obmen_downX=t.data.global.x-this.obmen.win_fight.take_scroll.worldTransform.tx}updPosition(t){this.obmen.win_fight.take_scroll.x=this.obmen_startX-(this.obmen_startX+this.obmen.win_fight.x-t.data.global.x),this.updObmen()}lifetimeTick(t){if("max"==t.status)return TIMERS.timers.boss_ftime.init=!1,void TS.php("fights.check",{},(t=>{main_menu.fightStatus(t)}),rootClass.onError);this.fight.panel_mc.time_mc.tf_txt.text=helper.timeString(t.time),helper.scaleAnimation(this.fight.panel_mc.time_mc.livesline_mc,t.time/this.data.all_time,100)}weaponTick(t){if("max"!=t.status){for(let e=0;e<this.timers.length;e++)this.timers[e].tf_txt.text="",e==fights.data.timer&&(this.timers[e].tf_txt.text=helper.timeString(t.time)),this.timers[e].visible=!0;notify.reload.parent&&notify.showReload(t)}else{TIMERS.timers.boss_timer.init=!1;for(let t=0;t<this.timers.length;t++)this.timers[t].visible=!1}}weaponTickAutoUdar(){if(this.auto_multiudar){if(this.setup_automultiudar){if(this.auto_udar_time>=0&&(this.auto_udar_time=this.auto_udar_time-1),this.auto_udar_time<1&&this.fight.parent&&(0==this.auto_udar_time&&(this.timers_autoudar[this.auto_udar_weap-3].tf_txt.text=this.auto_udar_time),-1==this.auto_udar_time&&(this.clickWeapon(this.auto_udar_weap,!0),this.updObmen(),this.auto_udar_time=2)),this.auto_udar_time<0)return;this.timers_autoudar[this.auto_udar_weap-3].tf_txt.text=this.auto_udar_time,this.timers_autoudar[this.auto_udar_weap-3].visible||(this.timers_autoudar[this.auto_udar_weap-3].visible=!0)}}else for(let t=0;t<this.timers_autoudar.length;t++)this.timers_autoudar[t].visible=!1}clickWeapon(t,e=!1){this.wid=t;let s=1,i=0;this.last_fight=t,e?(s=this.use_weap_pack,i=this.damage_coef.indexOf(this.xx_obmen[t-3])):t>2&&(s=this.damage_coef[localStore.weapons[t-3]],i=localStore.weapons[t-3]),TS.php("fights.damage",{wid:t,num:s,coef:i},(t=>{this.weaponAnimation(t)}),(t=>{this.auto_multiudar&&(this.auto_multiudar=this.obmen.win_fight.check_auto_udar_mc.visible=this.setup_automultiudar=!1),this.errorWeapon(t)})),e&&!this.auto_multiudar&&this.stopObmen();for(let t=0;t<this.weapon_blows.length;t++)this.weapon_blows[t].alpha=0}weaponAnimation(t){let e=.3-t.boss.xp/bosses[t.boss.bid].mods[t.boss.mode].xp*.3;helper.alphaAnimation(this.fight.stats_mc,e+.3,150,(()=>helper.alphaAnimation(this.fight.stats_mc,e,150))),sounds.playWeapon(this.wid),main_menu.fightStatus(t),this.updateBoss()}errorWeapon(t){console.log(t),24==t.code&&notify.showReload(),16==t.code&&notify.showNoWeapon()}updateXXX(){let t=udata.weapons;for(let e=0;e<this.xxx_array.length;e++){switch(localStore.weapons[e]){case 0:this.xxx_array[e].x1_mc.visible=!0,this.xxx_array[e].x10_mc.visible=this.xxx_array[e].x100_mc.visible=this.xxx_array[e].x1k_mc.visible=this.xxx_array[e].x10k_mc.visible=this.xxx_array[e].x100k_mc.visible=this.xxx_array[e].x500k_mc.visible=this.xxx_array[e].x1kk_mc.visible=!1;break;case 1:this.xxx_array[e].x10_mc.visible=!0,this.xxx_array[e].x1_mc.visible=this.xxx_array[e].x100_mc.visible=this.xxx_array[e].x1k_mc.visible=this.xxx_array[e].x10k_mc.visible=this.xxx_array[e].x100k_mc.visible=this.xxx_array[e].x500k_mc.visible=this.xxx_array[e].x1kk_mc.visible=!1;break;case 2:this.xxx_array[e].x100_mc.visible=!0,this.xxx_array[e].x10_mc.visible=this.xxx_array[e].x1_mc.visible=this.xxx_array[e].x1k_mc.visible=this.xxx_array[e].x10k_mc.visible=this.xxx_array[e].x100k_mc.visible=this.xxx_array[e].x500k_mc.visible=this.xxx_array[e].x1kk_mc.visible=!1;break;case 3:this.xxx_array[e].x1k_mc.visible=!0,this.xxx_array[e].x10_mc.visible=this.xxx_array[e].x100_mc.visible=this.xxx_array[e].x1_mc.visible=this.xxx_array[e].x10k_mc.visible=this.xxx_array[e].x100k_mc.visible=this.xxx_array[e].x500k_mc.visible=this.xxx_array[e].x1kk_mc.visible=!1;break;case 4:this.xxx_array[e].x10k_mc.visible=!0,this.xxx_array[e].x10_mc.visible=this.xxx_array[e].x100_mc.visible=this.xxx_array[e].x1_mc.visible=this.xxx_array[e].x1k_mc.visible=this.xxx_array[e].x100k_mc.visible=this.xxx_array[e].x500k_mc.visible=this.xxx_array[e].x1kk_mc.visible=!1;break;case 5:this.xxx_array[e].x100k_mc.visible=!0,this.xxx_array[e].x10_mc.visible=this.xxx_array[e].x100_mc.visible=this.xxx_array[e].x1_mc.visible=this.xxx_array[e].x1k_mc.visible=this.xxx_array[e].x10k_mc.visible=this.xxx_array[e].x500k_mc.visible=this.xxx_array[e].x1kk_mc.visible=!1;break;case 6:this.xxx_array[e].x500k_mc.visible=!0,this.xxx_array[e].x10_mc.visible=this.xxx_array[e].x100_mc.visible=this.xxx_array[e].x1_mc.visible=this.xxx_array[e].x1k_mc.visible=this.xxx_array[e].x10k_mc.visible=this.xxx_array[e].x100k_mc.visible=this.xxx_array[e].x1kk_mc.visible=!1;break;case 7:this.xxx_array[e].x1kk_mc.visible=!0,this.xxx_array[e].x10_mc.visible=this.xxx_array[e].x100_mc.visible=this.xxx_array[e].x1_mc.visible=this.xxx_array[e].x1k_mc.visible=this.xxx_array[e].x10k_mc.visible=this.xxx_array[e].x100k_mc.visible=this.xxx_array[e].x500k_mc.visible=!1}this.fight.panel_mc["num"+(e+1)+"_txt"].text=helper.shortText(parseInt(t[e]/this.damage_coef[localStore.weapons[e]]))}for(let t=0;t<this.weapon_blows.length;t++){let e=udata.mandat_dmg_bonus[t]||0,s=udata.wear_dmg_bonus[t-3]||0;if(t<3&&(this.weapon_blows[t].time_txt.text=helper.timeString(weapons[t])),t>2){let i=Math.ceil((damages[t]+e+s)*this.damage_coef[localStore.weapons[t-3]]*udata.damage_coef[t]);this.weapon_blows[t].dmg_txt.text="-"+helper.shortText(i)+"хп"}else this.weapon_blows[t].dmg_txt.text="-"+helper.shortText(damages[t]+e+s)+" хп"}}initButtons(){setButton(this.fight.update_mc.butt_mc),setButton(this.fight.exit_mc.butt_mc),setButton(this.fight.percs_mc.butt_mc),setButton(this.exit.man_mc.blow_mc.nonex_mc),setButton(this.exit.man_mc.blow_mc.butt_mc),setButton(this.fight.mandat_mc.butt_mc),setButton(this.fight.panel_mc.up_bt),setButton(this.fight.panel_mc.down_bt),setButton(this.combo_gift.win.get_mc),setButton(this.obmen.win_fight.close_mc),setButton(this.obmen.win_fight.butt_fight_mc),setButton(this.obmen.win_fight.line1_mc),setButton(this.obmen.win_fight.take_scroll),setButton(this.obmen.win_fight.indic_garant_mc),setButton(this.obmen.win_fight.indic_wear_mc),setButton(this.obmen.win_fight.indic_bronik_mc),setButton(this.obmen.win_fight.indic_fight_mc),setButton(this.obmen.win_fight.square_auto_udar_mc),setButton(this.fight.box_donat_boss.list_barsetka_mc.icon_barsetka),setButton(this.fight.box_donat_boss.list_barsetka_mc.icon_barsetka_kalmar),setButton(this.box_donat.panel_mc.close_mc),setButton(this.box_donat.panel_mc.butt_mc),setButton(this.fight.send_friends_mc),setButton(this.fight.panel_mc.kalmar_top_mc),setButton(this.kalmar_top.win.arrows_mc.prev_bt),setButton(this.kalmar_top.win.arrows_mc.next_bt),setButton(this.kalmar_top.win.close_mc),setButton(this.exit.man_mc.blow_mc.save_damages_mc.chb)}initUnics(){this.bgs[2].addChild(helper.duplicate(modules.names.home.fight_bg3)),this.bgs[0].bg.addChild(helper.duplicate(modules.names.home.fight_bg1)),this.fight.mandat_mc.addChild(helper.duplicate(modules.names.menu.menu_selector.win.mandat_mc)),this.fight.mandat_mc=this.fight.mandat_mc.children[0],this.fight.mandat_mc.bg2.exp_ico.addChild(helper.duplicate(modules.unical.exp)),this.fight.mandat_mc.icon_mc.addChild(helper.duplicate(modules.unical.mnd_ico)),this.combo.light.addChild(helper.duplicate(modules.unical.light)),this.kalmar_top.win.close_mc.addChild(helper.duplicate(modules.unical.close))}}class h{constructor(t,e,s,i,o){this.windef=s,this.windef_slot=i,this.craft=o,this.selector=t,this.boss_slot=e,this.selector_slots=[],this.selector_goanim=!0,this.anim_interval=null,this.top3_damagers=[],this.loaderArr=[],this.boss_mode=1,this.setup_mandat=!1,this.windef.interactive=this.selector.interactive=this.craft.interactive=!0,this.initUnics(),this.initButtons(),this.selector.win.close_mc.on("pointerdown",(()=>this.hideBossSelector())),this.selector.win.arrows_mc.prev_bt.on("pointerdown",(()=>this.goPrevSelector())),this.selector.win.arrows_mc.next_bt.on("pointerdown",(()=>this.goNextSelector())),this.selector.win.mandat_mc.butt_mc.on("pointerdown",(()=>mandats.showMandats())),this.selector.win.umen_mc.on("pointerdown",(()=>{umen.showUmen()})),this.windef.window_mc.close_mc.on("pointerdown",(()=>this.hideWinOrDef())),this.selector.win.mode0_mc.butt.on("pointerdown",(()=>this.newMode(1))),this.selector.win.mode1_mc.butt.on("pointerdown",(()=>this.newMode(2))),this.selector.win.mode3_mc.on("pointerdown",(()=>this.newMode(3))),this.windef.window_mc.replay_mc.on("pointerdown",(()=>this.replayFight())),TIMERS.timers.custom.init=!0,TIMERS.timers.custom.tick.push((()=>this.updOpenTimers()))}replayFight(){TS.php("fights.start",{id:fights.data.bid,mode:fights.data.mode},(t=>{main_menu.fightStatus(t),this.hideWinOrDef()}),rootClass.onError)}showCraft(t){for(;this.craft.wear_mc.photo_mc.children.length;)this.craft.wear_mc.photo_mc.removeChildAt(0);let e=udata.craft;this.craft.wear_mc.visible=!1,this.craft.open_butt.visible=!0,this.craft.take_butt.visible=!1,this.craft.alpha=0,this.craft.wear_mc.tf_txt.text=e[t]+"/"+wears.w[t].wanted[1],this.craft.wear_mc.photo_mc.addChild(helper.duplicate(icon_wears[t])),parseInt(e[t])==parseInt(wears.w[t].wanted[1])?(udata.buying.push(t),this.craft.wear_mc.odet_mc.visible=!0):this.craft.wear_mc.odet_mc.visible=!1,this.craft.open_butt._events.pointerdown||this.craft.open_butt.on("pointerdown",(()=>{this.craft.wear_mc.visible=!0,this.craft.wear_mc.anim_mc.tf_txt.text="+1",helper.fadeAnimation(this.craft.wear_mc.anim_mc,"fadeIn",300),gsap.to(this.craft.wear_mc.anim_mc,{y:50,duration:.3,onComplete:()=>{helper.fadeAnimation(this.craft.wear_mc.anim_mc,"fadeOut",500),gsap.to(this.craft.wear_mc.anim_mc,{duration:.5,onComplete:()=>{this.craft.wear_mc.anim_mc.y=30}})}}),this.craft.open_butt.visible=!1,this.craft.take_butt.visible=!0})),this.craft.take_butt._events.pointerdown||this.craft.take_butt.on("pointerdown",(()=>{helper.fadeAnimation(this.craft,"fadeOut",300)})),this.craft.wear_mc.odet_mc._events.pointerdown||this.craft.wear_mc.odet_mc.on("pointerdown",(()=>{TS.php("shop.putOn",{id:t},(t=>{udata.mywears=t.mywears,udata.wear_dmg_bonus=t.wear_dmg_bonus,padik.refreshWears()})),helper.fadeAnimation(this.craft,"fadeOut",300)})),helper.fadeAnimation(this.craft,"fadeIn",300),root.layer1_mc.addChild(this.craft),fights.data.cftOK=0}constructorRewards(){this.windef.window_mc.exp_mc.x=299,this.windef.window_mc.exp_mc.list_rewards.x=0,this.windef.window_mc.coins_mc.tf_txt.y=this.windef.window_mc.exp_mc.tf_txt.y=5,this.windef.window_mc.coins_mc.visible=this.windef.window_mc.exp_mc.visible=!1,this.windef.window_mc.coins_mc.x=240;for(let t=0;t<this.list_rewards.length-2*this.windef_pages&&t<2;t++){if(1==t&&(this.windef.window_mc.coins_mc.x=210),this.rewards[t].visible=!0,this.rewards[t].list_rewards.gotoAndStop(this.list_rewards[t+2*this.windef_pages]),this.rewards[t].tf_txt.text="+"+helper.shortText(fights.data[this.list_rewards[t+2*this.windef_pages]]),"win_dop_0"==this.list_rewards[t+2*this.windef_pages]&&(this.rewards[t].tf_txt.text="+"+helper.shortText(fights.data.win_dop)),helper.clearButton(this.rewards[t]),this.windef.window_mc.exp_mc.tf_txt.x=-55,"wearOK"==this.list_rewards[t+2*this.windef_pages]){for(this.rewards[t].tf_txt.text="Шмот",this.windef.window_mc.exp_mc.tf_txt.x=-60,this.windef.window_mc.exp_mc.x=298;this.windef.window_mc.wear_blow.wear_mc.children.length;)this.windef.window_mc.wear_blow.wear_mc.removeChildAt(0);this.windef.window_mc.wear_blow.wear_mc.addChild(helper.duplicate(icon_wears[fights.data.wearID])),-1==udata.buying.indexOf(fights.data.wearID)&&udata.buying.push(fights.data.wearID),setButton(this.rewards[t]),this.rewards[t].on("mouseover",(()=>helper.alphaAnimation(this.windef.window_mc.wear_blow,1,300))),this.rewards[t].on("mouseout",(()=>helper.alphaAnimation(this.windef.window_mc.wear_blow,0,300))),this.windef.window_mc.wear_blow.x=0==t?234:300}"bgOK"==this.list_rewards[t+2*this.windef_pages]&&(this.rewards[t].tf_txt.text="Ключ")}this.windef.window_mc.exp_mc.visible&&(this.windef.window_mc.exp_mc.list_rewards.x=7.5*fights_windows.windef.window_mc.exp_mc.tf_txt.text.length-55+2)}showBossWin(){for(fights.auto_multiudar&&(fights.auto_multiudar=fights.obmen.win_fight.check_auto_udar_mc.visible=fights.setup_automultiudar=!1),fights.fight.crit_mc.gotoAndStop(0),1==this.windef.window_mc.wear_blow.alpha&&helper.alphaAnimation(this.windef.window_mc.wear_blow,0,300),this.windef.window_mc.def_mc.visible=!1,this.windef.window_mc.win_mc.visible=!0,this.windef.window_mc.title_mc.text="Ты победил!",setTextStyle(this.windef.window_mc.title_mc,{fill:"#496715"}),sounds.playKrasava(),fights.data.wearOK=fights.data.wearOK||0,this.windef.window_mc.snow_mc.visible=this.windef.window_mc.key_mc.visible=this.windef.window_mc.dop_win.visible=this.windef.window_mc.page_next_mc.visible=this.windef.window_mc.page_prev_mc.visible=!1,this.list_rewards=[],helper.clearButton(this.windef.window_mc.page_next_mc),helper.clearButton(this.windef.window_mc.page_prev_mc),setButton(this.windef.window_mc.page_next_mc),setButton(this.windef.window_mc.page_prev_mc),1==parseInt(fights.data.bgOK)&&this.list_rewards.push("bgOK"),parseInt(fights.data.wearOK)>0&&this.list_rewards.push("wearOK"),parseInt(fights.data.win_snow)>0&&this.list_rewards.push("win_snow"),parseInt(fights.data.win_coins)>0&&this.list_rewards.push("win_coins"),parseInt(fights.data.win_exp)>0&&this.list_rewards.push("win_exp"),parseInt(fights.data.win_gold)>0&&this.list_rewards.push("win_gold"),parseInt(fights.data.win_dop)>0&&"birds"==fights.data.win_dop_type&&this.list_rewards.push("win_dop_0"),parseInt(fights.data.win_automat)>0&&this.list_rewards.push("win_automat"),bosses[fights.data.bid].keys_rewards&&fights.data["key_donat_boss_"+bosses[fights.data.bid].keys_rewards.id]&&parseInt(fights.data["key_donat_boss_"+bosses[fights.data.bid].keys_rewards.id])>0&&this.list_rewards.push("key_donat_boss_"+bosses[fights.data.bid].keys_rewards.id),this.windef_pages=0,this.windef_all_pages=Math.ceil(this.list_rewards.length/2),this.windef_all_pages>1&&(this.windef.window_mc.page_next_mc.visible=!0),this.rewards=[this.windef.window_mc.coins_mc,this.windef.window_mc.exp_mc],this.constructorRewards(),this.windef.window_mc.page_next_mc.on("pointerdown",(()=>this.nextRewardPages())),this.windef.window_mc.page_prev_mc.on("pointerdown",(()=>this.prevRewardPages()));this.windef.window_mc.icon_mc.children.length;)this.windef.window_mc.icon_mc.removeChildAt(0);for(;this.windef.window_mc.damager3_mc.children.length;)this.windef.window_mc.damager3_mc.removeChildAt(0);fights.data.xp=Math.max(fights.data.xp,0),this.windef.window_mc.lifes_mc.tf_txt.text=helper.shortText(fights.data.xp);let t=this.windef.window_mc.lifes_mc.tf_txt.getLocalBounds();this.windef.window_mc.lifes_mc.icn_mc.x=-30+t.x+t.width,this.windef.window_mc.icon_mc.addChild(helper.duplicate(modules.names.menu["boss_ico"+(parseInt(fights.data.bid)+1)])),this.windef.window_mc.name_txt.text=helper.decode64(bosses[fights.data.bid].name).toUpperCase(),this.windef.window_mc.x=-400,this.windef.window_mc.top20_mc.y=130,gsap.to(this.windef.window_mc,{duration:.3,x:194,onComplete:()=>{fights.data.damagers.length>3&&gsap.to(this.windef.window_mc.top20_mc,{duration:.3,y:230,ease:"expo.in"})}}),this.windefRating(),root.layer1_mc.addChild(this.windef),udata.box_donat.rewards&&0==udata.box_donat.get&&bosses[fights.data.bid].mods[fights.data.mode].box&&Object.keys(udata.box_donat.rewards).length>0&&fights.showBoxDonat()}showBossDefeat(){for(fights.auto_multiudar&&(fights.auto_multiudar=fights.obmen.win_fight.check_auto_udar_mc.visible=fights.setup_automultiudar=!1),fights.fight.crit_mc.gotoAndStop(0),1==this.windef.window_mc.wear_blow.alpha&&helper.alphaAnimation(this.windef.window_mc.wear_blow,0,300),sounds.playLoshara(),this.windef.window_mc.snow_mc.visible=this.windef.window_mc.key_mc.visible=this.windef.window_mc.dop_win.visible=this.windef.window_mc.page_next_mc.visible=this.windef.window_mc.page_prev_mc.visible=!1,this.windef.window_mc.def_mc.visible=!0,this.windef.window_mc.win_mc.visible=!1,this.windef.window_mc.title_mc.text="Поражение...",setTextStyle(this.windef.window_mc.title_mc,{fill:"#672a15"}),this.windef.window_mc.exp_mc.x=299,this.windef.window_mc.coins_mc.x=210,this.windef.window_mc.exp_mc.tf_txt.x=-55,this.windef.window_mc.exp_mc.list_rewards.x=0,this.windef.window_mc.coins_mc.tf_txt.y=this.windef.window_mc.exp_mc.tf_txt.y=5,this.windef.window_mc.wear_mc.visible=!1,this.windef.window_mc.exp_mc.tf_txt.text="0",this.windef.window_mc.coins_mc.tf_txt.text="0",this.list_rewards=[],this.windef.window_mc.coins_mc.visible=this.windef.window_mc.exp_mc.visible=!0,this.windef.window_mc.coins_mc.list_rewards.gotoAndStop("win_coins"),this.windef.window_mc.exp_mc.list_rewards.gotoAndStop("win_exp"),helper.clearButton(this.windef.window_mc.coins_mc),helper.clearButton(this.windef.window_mc.exp_mc),this.windef.window_mc.exp_mc.list_rewards.x=this.windef.window_mc.exp_mc.tf_txt.x+7.5*fights_windows.windef.window_mc.exp_mc.tf_txt.text.length+2;this.windef.window_mc.icon_mc.children.length;)this.windef.window_mc.icon_mc.removeChildAt(0);for(;this.windef.window_mc.damager3_mc.children.length;)this.windef.window_mc.damager3_mc.removeChildAt(0);this.windef.window_mc.lifes_mc.tf_txt.text=helper.getNumber(fights.data.xp);let t=this.windef.window_mc.lifes_mc.tf_txt.getLocalBounds();this.windef.window_mc.lifes_mc.icn_mc.x=-30+t.x+t.width,this.windef.window_mc.icon_mc.addChild(helper.duplicate(modules.names.menu["boss_ico"+(parseInt(fights.data.bid)+1)])),this.windef.window_mc.name_txt.text=helper.decode64(bosses[fights.data.bid].name).toUpperCase(),this.windef.window_mc.x=-400,this.windef.window_mc.top20_mc.y=130,gsap.to(this.windef.window_mc,{duration:.3,x:194,onComplete:()=>{fights.data.damagers.length>3&&gsap.to(this.windef.window_mc.top20_mc,{duration:.3,y:230,ease:"expo.in"})}}),this.windefRating(),root.layer1_mc.addChild(this.windef)}nextRewardPages(){this.windef_pages++,this.windef.window_mc.page_prev_mc.visible=!0,this.constructorRewards(),this.windef_pages>=this.windef_all_pages-1&&(this.windef.window_mc.page_next_mc.visible=!1)}prevRewardPages(){this.windef_pages--,this.windef.window_mc.page_next_mc.visible=!0,this.constructorRewards(),0==this.windef_pages&&(this.windef.window_mc.page_prev_mc.visible=!1)}hideWinOrDef(){gsap.to(this.windef.window_mc,{duration:.3,x:900,onComplete:()=>{root.layer1_mc.removeChild(this.windef),fights.data.cftOK=fights.data.cftOK||0,Boolean(fights.data.cftOK)&&this.showCraft(parseInt(fights.data.cftID))}})}windefRating(){let t="",e=fights.data.damagers,s=e.length;s>3&&(s=3);let i=[];this.top3_damagers=[];for(let s=0;s<3&&s<e.length;s++)t+=e[s].id+",";for(let t=3;t<e.length;t++)i.push(e[t].id);bridge.sendPromise("VKWebAppCallAPIMethod",{method:"users.get",params:{fields:"photo_50",user_ids:t,access_token:VK_token,v:VK_version}}).then((t=>{t=t.response;for(let i=0;i<3&&i<e.length;i++)this.top3_damagers[i]=helper.duplicate(this.windef_slot),0==i&&parseInt(e[0].id)!==parseInt(udata.id)&&"win"==fights.data.status?this.top3_damagers[i].thanks_mc.visible=!0:this.top3_damagers[i].thanks_mc.visible=!1,this.top3_damagers[i].bg_mc.gotoAndStop(i),this.top3_damagers[i].x=110.5-221/6*s+77*i,this.top3_damagers[i].dmg_txt.text=helper.shortText(e[i].damage),helper.loadPhoto50(e[i].id,(t=>this.top3_damagers[i].photo_mc.addChild(t)),t[i].photo_50),this.windef.window_mc.damager3_mc.addChild(this.top3_damagers[i]);setButton(this.top3_damagers[0].thanks_mc),helper.linkControl(fights.data.hash),this.top3_damagers[0].thanks_mc.on("pointerdown",(()=>{let t;helper.loadNames(fights.data.damagers[0].id,(e=>{t=helper.links[fights.data.hash]?"@id"+fights.data.damagers[0].id+"("+e[0].first_name+"), спасибо за помощь в бою! Я тут приготовил ништяков на 5 человек, забирай! "+helper.links[fights.data.hash]:"@id"+fights.data.damagers[0].id+"("+e[0].first_name+"), спасибо за помощь в бою! Я тут приготовил ништяков на 5 человек, забирай! https://vk.com/app"+vk_params.api_id+"#"+fights.data.hash,bridge.send("VKWebAppShowWallPostBox",{message:t,attachments:bosses[fights.data.bid].photo_win}).then((t=>{TS.php("security.validatePost",{id:t.post_id,hash:fights.data.hash},(()=>achives.refresh()))}))}))}))})),this.windef.window_mc.top20_mc.all_top1.text="",this.windef.window_mc.top20_mc.all_top2.text="",helper.loadNames(i,(()=>{for(let t=3;t<6&&t<e.length;t++)helper.loadNames(e[t].id,(s=>this.windef.window_mc.top20_mc.all_top1.text+=t+1+". "+s[0].first_name+" "+s[0].last_name.substr(0,1)+". - "+helper.shortText(e[t].damage)+"\n"));for(let t=6;t<e.length&&t<9;t++)helper.loadNames(e[t].id,(s=>this.windef.window_mc.top20_mc.all_top2.text+=t+1+". "+s[0].first_name+" "+s[0].last_name.substr(0,1)+". - "+helper.shortText(e[t].damage)+"\n"))}))}checkBossMode(){switch(helper.getLevel(udata.exp)>=12?this.selector.win.mode1_mc.mov.gotoAndStop(0):this.selector.win.mode1_mc.mov.gotoAndStop(1),this.boss_mode){case 1:this.selector.win.mode0_mc.alpha=1,this.selector.win.mode1_mc.alpha=.5,this.selector.win.mode2_mc.alpha=.5,this.selector.win.mode3_mc.alpha=.5;break;case 2:this.selector.win.mode0_mc.alpha=.5,this.selector.win.mode1_mc.alpha=1,this.selector.win.mode2_mc.alpha=.5,this.selector.win.mode3_mc.alpha=.5;break;case 3:this.selector.win.mode0_mc.alpha=.5,this.selector.win.mode1_mc.alpha=.5,this.selector.win.mode2_mc.alpha=.5,this.selector.win.mode3_mc.alpha=1;break;case 4:this.selector.win.mode0_mc.alpha=.5,this.selector.win.mode1_mc.alpha=.5,this.selector.win.mode2_mc.alpha=1,this.selector.win.mode3_mc.alpha=.5}}newMode(t){2==t&&1==this.selector.win.mode1_mc.mov.currentFrame||t==this.boss_mode||(modules.flags.pit&&pit.hidePit(),this.selector.win.mandat_mc.visible=this.selector.win.umen_mc.visible=this.selector.win.arrows_mc.visible=!0,this.generateSelectorSlots(t))}modePit(){if(4!=this.boss_mode){for(;this.selector.win.slots_mc.children.length;)this.selector.win.slots_mc.removeChildAt(0);this.selector.win.mandat_mc.visible=this.selector.win.umen_mc.visible=this.selector.win.arrows_mc.visible=!1,this.boss_mode=4,this.checkBossMode(),pit.init()}}showBossSelector(){this.selector.win.y=-600,this.selector.shadow_mc.alpha=this.selector.box_shadow.alpha=.01,this.selector.bg_mc.visible=!1,this.selector_goanim=!0,this.selector.win.mode0_mc.x=this.selector.win.mode1_mc.x=this.selector.win.mode2_mc.x=this.selector.win.mode3_mc.x=212,this.selector.win.mandat_mc.visible=this.selector.win.umen_mc.visible=this.selector.win.arrows_mc.visible=!0,helper.fadeAnimation(this.selector.shadow_mc,"fadeIn",500,(()=>{gsap.to(this.selector.win,{duration:1,y:104,ease:"back.out(2)"}),helper.fadeAnimation(this.selector.bg_mc,"fadeIn",1e3),this.anim_interval=setInterval((()=>{clearInterval(this.anim_interval),gsap.to(this.selector.win.mode0_mc,{duration:.5,x:386,ease:"back.out(2)"}),gsap.to(this.selector.win.mode1_mc,{duration:.5,x:390,ease:"back.out(2)"}),gsap.to(this.selector.win.mode2_mc,{duration:.5,x:370,ease:"back.out(2)"}),gsap.to(this.selector.win.mode3_mc,{duration:.5,x:398,ease:"back.out(2)"}),helper.fadeAnimation(this.selector.box_shadow,"fadeIn",500,(()=>{this.selector_goanim=!1}))}),800)})),this.selector.parent||(this.generateSelectorSlots(),root.layer1_mc.addChild(this.selector),learn.check())}generateSelectorSlots(t){this.boss_mode=t||1,this.checkBossMode(),this.selector_slots=[];let e=udata.locs,s=udata.fwins;for(;this.selector.win.slots_mc.children.length;)this.selector.win.slots_mc.removeChildAt(0);for(let t=0;t<boss_modes[this.boss_mode-1].length;t++){let i=helper.duplicate(this.boss_slot),o=s[boss_modes[this.boss_mode-1][t]]||0;this.showSelectorSlot(i,0,boss_modes[this.boss_mode-1][t],e,s),setButton(i.medals_mc.br_btn),setButton(i.medals_mc.sil_btn),setButton(i.medals_mc.gold_btn),setButton(i.medals_mc.platinum_btn),i.open_timer.tf_txt.text="загрузка данных..",this.selector_slots.push(i),i.real_wins=o,i.keys_don_boss.visible=3==this.boss_mode,udata.keys_donat_boss[t]=udata.keys_donat_boss[t]||0,i.keys_don_boss.keys_txt.text=helper.shortText(udata.keys_donat_boss[t]),i.keys_don_boss.keys.gotoAndStop(t),i.medals_mc.br_btn.on("pointerdown",(t=>this.fightMode(this.selector_slots.indexOf(t.currentTarget.parent.parent),0))),o>=50&&i.medals_mc.sil_btn.on("pointerdown",(t=>this.fightMode(this.selector_slots.indexOf(t.currentTarget.parent.parent),1))),o>=100&&i.medals_mc.gold_btn.on("pointerdown",(t=>this.fightMode(this.selector_slots.indexOf(t.currentTarget.parent.parent),2))),o>=1&&i.medals_mc.platinum_btn.on("pointerdown",(t=>this.fightMode(this.selector_slots.indexOf(t.currentTarget.parent.parent),3))),i.medals_mc.br_btn.on("mouseover",(t=>this.showSelectorSlotBlow(t.currentTarget,0))),i.medals_mc.sil_btn.on("mouseover",(t=>this.showSelectorSlotBlow(t.currentTarget,1))),i.medals_mc.gold_btn.on("mouseover",(t=>this.showSelectorSlotBlow(t.currentTarget,2))),i.medals_mc.platinum_btn.on("mouseover",(t=>this.showSelectorSlotBlow(t.currentTarget,3))),i.medals_mc.br_btn.on("mouseout",(t=>this.hideSelectorSlotBlow(t.currentTarget))),i.medals_mc.sil_btn.on("mouseout",(t=>this.hideSelectorSlotBlow(t.currentTarget))),i.medals_mc.gold_btn.on("mouseout",(t=>this.hideSelectorSlotBlow(t.currentTarget))),i.medals_mc.platinum_btn.on("mouseout",(t=>this.hideSelectorSlotBlow(t.currentTarget))),this.selector_slots[t].type_limit_slot="limit",i.y=150*t}for(let t=this.selector_slots.length-1;t>=0;t--)this.selector.win.slots_mc.addChild(this.selector_slots[t])}showSelectorSlotBlow(t,e){switch(t.parent.blow_mc.x=Math.floor(t.x-10),this.slot_bool=!0,e){case 1:t.parent.parent.real_wins<50?t.parent.blow_mc.tf_txt.text="Недоступен":t.parent.blow_mc.tf_txt.text="Пацанский";break;case 2:t.parent.parent.real_wins<100?t.parent.blow_mc.tf_txt.text="Недоступен":t.parent.blow_mc.tf_txt.text="Авторитетный";break;case 3:t.parent.parent.real_wins<1?t.parent.blow_mc.tf_txt.text="Недоступен":t.parent.blow_mc.tf_txt.text="С глазу на глаз";break;default:t.parent.blow_mc.tf_txt.text="Обычный"}helper.alphaAnimation(t.parent.blow_mc)}hideSelectorSlotBlow(t){this.slot_bool=!1,t.parent.parent.slot_int=setInterval((e=>{this.slot_bool||helper.alphaAnimation(t.parent.blow_mc,0),clearInterval(t.parent.parent.slot_int)}),100)}fightMode(t,e){let s=udata.locs,i=udata.fwins;this.showSelectorSlot(this.selector_slots[t],e,boss_modes[this.boss_mode-1][t],s,i)}showSelectorSlot(t,e,s,i,o){let a=bosses[s].mods[e].wears,n=o[s]||0;if(t.mode=e,t.butt_mc.butt.removeAllListeners(),helper.clearButton(t.wear_mc),a.length){setButton(t.wear_mc),t.wear_mc.on("mouseover",(()=>helper.alphaAnimation(t.wear_blow,1,300))),t.wear_mc.on("mouseout",(()=>helper.alphaAnimation(t.wear_blow,0,300))),t._wears=a,t._i=0,t.wear_blow.wear_mc.addChild(helper.duplicate(icon_wears[a[0]])),t._int&&clearInterval(t._int),t._int=setInterval((()=>{for(t._i++,t._i>=t._wears.length&&(t._i=0);t.wear_blow.wear_mc.children.length;)t.wear_blow.wear_mc.removeChildAt(0);t.wear_blow.wear_mc.addChild(helper.duplicate(icon_wears[a[t._i]]))}),1e3),t.wear_mc.visible=!1;for(let e=0;e<a.length;e++)if(-1==udata.buying.indexOf(a[e])){t.wear_mc.visible=!0;break}}else t.wear_mc.visible=!1;-1==bosses[s].mods[e].bg?t.key_mc.visible=!1:t.key_mc.visible=!0;let h=Math.floor((udata.bosstimer-28800+bosses[s].timer)/3600),l=udata.mandat_dmg_bonus[6]||0,r=udata.wear_dmg_bonus[3]||0,m=Math.ceil((damages[6]+l+r)*udata.damage_coef[6]);t.alltime_txt.text=h+" "+helper.numberEndFlower(h,"hours");let _=100*([5,8,10][e]/100+m/7e4);t.name_txt.text=helper.decode64(bosses[s].name).toUpperCase(),bosses[s].mods[t.mode].coins_garant?t.coins_txt.text=Math.floor(_)+"%":t.coins_txt.text="+"+helper.getNumber(bosses[s].mods[t.mode].coins*udata.umen_bonus.boss_coins),bosses[s].mods[t.mode].exp_garant?t.exp_txt.text="до "+helper.getNumber(bosses[s].mods[t.mode].exp_garant):t.exp_txt.text="+"+helper.getNumber(bosses[s].mods[t.mode].exp),t.price_icon.gotoAndStop(0),bosses[s].mods[t.mode].snow&&(t.coins_txt.text="+"+helper.shortText(bosses[s].mods[t.mode].snow),t.price_icon.gotoAndStop(2)),bosses[s].mods[t.mode].gold&&(t.coins_txt.text="+"+helper.shortText(bosses[s].mods[t.mode].gold),t.price_icon.gotoAndStop(1)),t.blow_mc.en_txt.text="-"+bosses[s].energy,t.lifes_mc.tf_txt.text=helper.getNumber(bosses[s].mods[t.mode].xp),t.wins_txt.text=n.toString(),t.blow_keys.energy_txt.text="-"+bosses[s].energy,t.photo_mc.addChild(helper.duplicate(modules.names.menu["boss_ico"+(s+1)]));let c=t.lifes_mc.tf_txt.getLocalBounds();switch(t.lifes_mc.icn_mc.x=-41+c.x+c.width,e){case 1:t.medals_mc.sil_mc.alpha=1,t.medals_mc.br_mc.alpha=t.medals_mc.gold_mc.alpha=t.medals_mc.platinum_mc.alpha=.5;break;case 2:t.medals_mc.gold_mc.alpha=1,t.medals_mc.br_mc.alpha=t.medals_mc.sil_mc.alpha=t.medals_mc.platinum_mc.alpha=.5;break;case 3:t.medals_mc.platinum_mc.alpha=1,t.medals_mc.sil_mc.alpha=t.medals_mc.gold_mc.alpha=t.medals_mc.br_mc.alpha=.5;break;default:t.medals_mc.br_mc.alpha=1,t.medals_mc.sil_mc.alpha=t.medals_mc.gold_mc.alpha=t.medals_mc.platinum_mc.alpha=.5}t.blow_mc.visible=t.blow_keys.visible=!1,t.blow_mc.alpha=t.blow_keys.alpha=0,t.butt_mc.butt.interactive=t.butt_mc.butt.buttonMode=!0,t.butt_mc.gotoAndStop(0),this.statusSelectorButton(t,s)}hideBossSelector(){this.selector_goanim||(this.bosses_mode=1,this.selector.parent&&root.layer1_mc.removeChild(this.selector),modules.flags.pit&&pit.hidePit())}goPrevSelector(){if(this.selector_goanim)return;let t,e=0;for(this.selector_goanim=!0,e=0;e<this.selector_slots.length;e++)this.selector_slots[e].y==150*(this.selector_slots.length-1)&&(t=e);for(e=0;e<this.selector_slots.length;e++)e!==t&&gsap.to(this.selector_slots[e],{duration:.3,y:this.selector_slots[e].y+150});helper.fadeAnimation(this.selector_slots[t],"fadeOut",100),gsap.to(this.selector_slots[t].scale,{duration:.1,x:.8,y:.8,onComplete:()=>{TweenLite.to(this.selector_slots[t],.1,{y:0,onComplete:()=>{helper.fadeAnimation(this.selector_slots[t],"fadeIn",100),gsap.to(this.selector_slots[t].scale,{duration:.1,x:1,y:1,onComplete:()=>{this.selector_goanim=!1}})}})}})}goNextSelector(){if(this.selector_goanim)return;let t,e=0;for(this.selector_goanim=!0,e=0;e<this.selector_slots.length;e++)0==this.selector_slots[e].y&&(t=e);for(e=0;e<this.selector_slots.length;e++)e!==t&&gsap.to(this.selector_slots[e],{duration:.3,y:this.selector_slots[e].y-150});helper.fadeAnimation(this.selector_slots[t],"fadeOut",200),gsap.to(this.selector_slots[t].scale,{duration:.1,x:.8,y:.8,onComplete:()=>{gsap.to(this.selector_slots[t],{duration:.1,y:150*(this.selector_slots.length-1),onComplete:()=>{gsap.to(this.selector_slots[t].scale,.1,{duration:.1,x:1.1,y:1.1,onComplete:()=>{this.selector_goanim=!1,this.selector_slots[t].scale.x=this.selector_slots[t].scale.y=1}}),helper.fadeAnimation(this.selector_slots[t],"fadeIn",100)}})}})}tickSelectorSlots(t){if(4!=this.boss_mode)if("max"!=t.status)for(let e=0;e<this.selector_slots.length;e++){let s=boss_modes[this.boss_mode-1][e];udata.flimits[s]>=udata.boss_limit&&(this.selector_slots[e].want_txt.text="Доступен через \n"+helper.timeString(t.time))}else{if(!TIMERS.timers.boss_limit.init)return;if(TIMERS.timers.boss_limit.init=!1,!this.selector.parent)return;TS.php("fights.check",{},(()=>{for(let t=0;t<this.selector_slots.length;t++){let e=t,s=this.selector_slots[t].mode,i=udata.flimits[e];this.selector_slots[t].type_limit_slot="limit",0==i&&(TIMERS.timers.boss_limit.init=!1),this.fightMode(e,s)}}))}}updOpenTimers(){if(this.selector.parent&&4!=this.boss_mode)for(let t=0;t<this.selector_slots.length;t++){let e=boss_modes[this.boss_mode-1][t];if(bosses[e].open_special){let s=bosses[e].open_special.value,i=helper.checkLastDate(s[0],s[1]);i[0]>TIME&&i[1]>TIME&&(this.selector_slots[t].open_timer.tf_txt.text="Будет через:\n"+helper.timeString(i[0]-TIME)),i[1]>TIME&&(i[0]>i[1]||TIME>i[0])&&(this.selector_slots[t].open_timer.tf_txt.text="Cвалит через:\n"+helper.timeString(i[1]-TIME))}}}statusSelectorButton(t,e){let s=udata.locs,i=udata.fwins,o=s[bosses[e].loc]||0;t.smk_pnl_buy_mc.visible=!1,t.blow_mc.gotoAndStop(0),bosses[e].open_special&&0==udata.umen_bonus.open_all_bosses&&(t.open_timer.alpha=1,helper.clearButton(t.open_timer),setButton(t.open_timer),helper.clickControl(t.open_timer,null,(()=>{helper.alphaAnimation(t.open_timer,1==t.open_timer.alpha?.01:1,100)}))),i[0]=i[0]||0,TIMERS.timers.boss_limit.init||(TIMERS.timers.boss_limit={init:!0,tick:t=>{this.tickSelectorSlots(t)}}),udata.flimits[e]<udata.boss_limit?(t.want_txt.text="До лимита \n",t.want_txt.text+="напасть "+(udata.boss_limit-udata.flimits[e])+" "+helper.numberEnd(udata.boss_limit-udata.flimits[e])):(t.butt_mc.gotoAndStop(2),t.blow_mc.gotoAndStop(1),t.type_limit_slot="time",t.blow_mc.en_txt.text="-"+bosses[e].unlim),bosses[e].blocked>0&&(t.want_txt.text="Персонаж \n",t.want_txt.text+="заблокирован",t.butt_mc.gotoAndStop(2)),o<1&&(t.want_txt.text="Нужно захватить \n"+helper.decode64(window.locs.l[bosses[e].loc].name).toLocaleLowerCase(),t.butt_mc.gotoAndStop(2)),helper.getLevel(udata.exp)<8&&(t.want_txt.text="Для нападения \n",t.want_txt.text+="достигни 8 уровня",t.butt_mc.gotoAndStop(2)),helper.clearButton(t.want_txt),setButton(t.want_txt),helper.clickControl(t.want_txt,null,(()=>{2!=t.butt_mc.currentFrame&&("limit"==t.type_limit_slot?udata.flimits[e]<udata.boss_limit&&(t.type_limit_slot="time",t.want_txt.text="Доступен через \n00:00:00",udata.bosslimittimer-(TIME-udata.ftimer)>0&&udata.flimits[e]>0&&(t.want_txt.text="Доступен через \n"+helper.timeString(udata.bosslimittimer-(TIME-udata.ftimer)))):(t.type_limit_slot="limit",t.want_txt.text="До лимита \nнапасть "+(udata.boss_limit-udata.flimits[e])+" "+helper.numberEnd(udata.boss_limit-udata.flimits[e])))})),helper.clearButton(t.pl_mc.semka_panels_mc),helper.clearButton(t.smk_pnl_buy_mc.buy_limit_0_mc),helper.clearButton(t.smk_pnl_buy_mc.buy_limit_1_mc),setButton(t.pl_mc.semka_panels_mc),setButton(t.smk_pnl_buy_mc.buy_limit_0_mc),setButton(t.smk_pnl_buy_mc.buy_limit_1_mc),-1!=bosses[e].unlim[2]&&udata.boss_unlim[e]>=10*bosses[e].unlim[2]?t.pl_mc.visible=!1:t.pl_mc.visible=!0,0==parseInt(bosses[e].unlim[0])&&(t.pl_mc.visible=!1),helper.clickControl(t.pl_mc.semka_panels_mc,null,(()=>{t.smk_pnl_buy_mc.visible=!t.smk_pnl_buy_mc.visible})),helper.clickControl(t.smk_pnl_buy_mc.buy_limit_0_mc,null,(t=>{let e=boss_modes[this.boss_mode-1][this.selector_slots.indexOf(t.currentTarget.parent.parent)],s=this.selector_slots.indexOf(t.currentTarget.parent.parent),i=this.selector_slots[this.selector_slots.indexOf(t.currentTarget.parent.parent)].mode;modules.checkFlags(["notify"],(()=>{notify.accept_fun=()=>TS.php("fights.unlim",{id:e,num:1},(()=>{this.fightMode(s,i),iface.showChotko(),iface.updateUp()}),rootClass.onError);let t=helper.getUnlim(e),o=Math.floor(t/10);notify.accept.win.tf_txt.text=helper.shortText(o-Math.floor(o*(udata.mandat_unlimit_boss/10/100))),notify.accept.win.val_mc.gotoAndStop("semki"),notify.showAccept()}))})),helper.clickControl(t.smk_pnl_buy_mc.buy_limit_1_mc,null,(t=>{let e=boss_modes[this.boss_mode-1][this.selector_slots.indexOf(t.currentTarget.parent.parent)],s=this.selector_slots.indexOf(t.currentTarget.parent.parent),i=this.selector_slots[this.selector_slots.indexOf(t.currentTarget.parent.parent)].mode;modules.checkFlags(["notify"],(()=>{notify.accept_fun=()=>TS.php("fights.unlim",{id:e},(()=>{this.fightMode(s,i),iface.showChotko(),iface.updateUp()}),rootClass.onError);let t=helper.getUnlim(e);notify.accept.win.tf_txt.text=helper.shortText(t-Math.floor(t*(udata.mandat_unlimit_boss/10/100))),notify.accept.win.val_mc.gotoAndStop("semki"),notify.showAccept()}))})),t.butt_mc.butt.on("mouseover",(s=>{2!==t.butt_mc.currentFrame&&(3!==t.butt_mc.currentFrame&&t.butt_mc.gotoAndStop(1),bosses[e].keys_start&&-1!=bosses[e].keys_start.id?(t.blow_keys.keys_txt.text="-"+bosses[e].keys_start.count,t.blow_keys.list_keys.gotoAndStop(bosses[e].keys_start.id),helper.fadeAnimation(t.blow_keys,"fadeIn")):helper.fadeAnimation(t.blow_mc,"fadeIn"))})),t.butt_mc.butt.on("mouseout",(s=>{2!==t.butt_mc.currentFrame&&(3!==t.butt_mc.currentFrame&&t.butt_mc.gotoAndStop(0),bosses[e].keys_start?helper.fadeAnimation(t.blow_keys,"fadeOut"):helper.fadeAnimation(t.blow_mc,"fadeOut"))})),t.butt_mc.currentFrame<2?helper.clickControl(t.butt_mc.butt,null,(t=>{let e=boss_modes[this.boss_mode-1][this.selector_slots.indexOf(t.currentTarget.parent.parent)];fights.obmen.win_fight.take_scroll.x=fights.obmen_startX,TS.php("fights.start",{id:e,mode:this.selector_slots[this.selector_slots.indexOf(t.currentTarget.parent.parent)].mode},(t=>main_menu.fightStatus(t)),rootClass.onError)})):3==t.butt_mc.currentFrame&&helper.clickControl(t.butt_mc.butt,null,(t=>{let e=boss_modes[this.boss_mode-1][this.selector_slots.indexOf(t.currentTarget.parent.parent)],s=this.selector_slots.indexOf(t.currentTarget.parent.parent),i=this.selector_slots[this.selector_slots.indexOf(t.currentTarget.parent.parent)].mode;modules.checkFlags(["notify"],(()=>{notify.accept_fun=()=>TS.php("fights.unlim",{id:e},(()=>{this.fightMode(s,i),iface.showChotko()}),rootClass.onError),notify.accept.win.tf_txt.text=bosses[e].unlim,notify.accept.win.val_mc.gotoAndStop("semki"),notify.showAccept()}))}))}initButtons(){setButton(this.selector.win.close_mc),setButton(this.selector.win.arrows_mc.prev_bt),setButton(this.selector.win.arrows_mc.next_bt),setButton(this.selector.win.mandat_mc.butt_mc),setButton(this.selector.win.umen_mc),setButton(this.windef.window_mc.close_mc),setButton(this.windef.window_mc.wear_mc),setButton(this.windef.window_mc.replay_mc),setButton(this.windef.window_mc.page_next_mc),setButton(this.windef.window_mc.page_prev_mc),setButton(this.craft.open_butt),setButton(this.craft.take_butt),setButton(this.craft.wear_mc.odet_mc),setButton(this.selector.win.mode0_mc.butt),setButton(this.selector.win.mode1_mc.butt),setButton(this.selector.win.mode3_mc)}initUnics(){this.selector.box_shadow.addChild(helper.duplicate(modules.unical.wood_shadow)),this.selector.win.close_mc.addChild(helper.duplicate(modules.unical.close)),this.selector.win.mandat_mc.icon_mc.addChild(helper.duplicate(modules.unical.mnd_ico)),this.selector.win.mandat_mc.bg2.exp_ico.addChild(helper.duplicate(modules.unical.exp)),this.selector.win.arrows_mc.addChild(helper.duplicate(modules.unical.arrows)),this.selector.win.arrows_mc=this.selector.win.arrows_mc.children[0]}}class l{constructor(t,e,s,i,o,a,n,h,l){this.noenergy=t,this.result=e,this.complete_loc=s,this.noweapon=i,this.reload=o,this.nomoney=a,this.buy=n,this.newlevel=h,this.accept=l,this.random_name=["Что-то тут не так...","Астанавитесь!","Опаньки","Не торопись..."],this.initUnics(),this.initButtons(),this.noenergy.win.blow_mc.ok_btn.on("pointerdown",(()=>{main_menu.toDoping(),this.hideNoEnergy(),window.fights_windows&&(fights_windows.hideBossSelector(),(fights_windows.windef.window_mc.def_mc||fights_windows.windef.window_mc.win_mc)&&fights_windows.hideWinOrDef())})),this.result.win.ok_btn.on("pointerdown",(()=>{this.hideResult()})),this.noenergy.win.ok_btn.on("pointerdown",(()=>{this.hideNoEnergy()})),this.complete_loc.win.ok_btn.on("pointerdown",(()=>{this.hideCompleteLocation()})),this.reload.win.close_mc.on("pointerdown",(()=>{this.hideReload()})),this.noweapon.win.close_mc.on("pointerdown",(()=>{this.hideNoWeapon()})),this.nomoney.win.close_mc.on("pointerdown",(()=>{this.hideNoMoney()})),this.buy.win.close_mc.on("pointerdown",(()=>{this.hideBuy()})),this.newlevel.win.close_mc.on("pointerdown",(()=>{this.hideNewLevel()})),helper.clickControl(this.accept.win.close_mc,null,(()=>this.hideAccept())),this.accept.win.butt_mc.on("pointerdown",(()=>{this.accept_fun(),this.hideAccept()})),this.nomoney.win.buy_rubles.on("pointerdown",(()=>{bridge.send("VKWebAppShowOrderBox",{type:"item",item:"item2"}),bank.fight_donut=!1,bank.set_donut=2,this.hideNoMoney()})),this.nomoney.win.buy_semki.on("pointerdown",(()=>{bridge.send("VKWebAppShowOrderBox",{type:"item",item:"item11"}),bank.fight_donut=!1,bank.set_donut=11,this.hideNoMoney()})),this.nomoney.win.obmen_mc.on("pointerdown",(()=>{iface.startObmen(),this.hideNoMoney()})),this.noweapon.win.blow_mc.butt_mc.on("pointerdown",(()=>{modules.checkFlags(["menu"],(()=>main_menu.toArmor())),this.hideNoWeapon()})),this.reload.win.butt_mc.on("pointerdown",(()=>{TS.php("fights.weaponReload",{},(t=>main_menu.fightStatus(t)),rootClass.onError),this.hideReload()})),this.buy.win.share_btn.on("pointerdown",(()=>{bridge.send("VKWebAppShowWallPostBox",{message:"Парни, ну вы гляньте какой я модный в игре https://vk.com/app"+vk_params.api_id,attachments:"photo112354918_457241311"})})),this.noenergy.interactive=this.noweapon.interactive=this.accept.interactive=this.newlevel.interactive=this.buy.interactive=this.nomoney.interactive=this.reload.interactive=this.complete_loc.interactive=this.result.interactive=!0,setTextStyle(this.result.win.title_txt,{dropShadow:!0,dropShadowAngle:60,dropShadowColor:"#000000",dropShadowDistance:2,dropShadowAlpha:.3,dropShadowBlur:4})}showAccept(){this.accept.win.y=-350,this.accept.shadow_mc.alpha=0,helper.fadeAnimation(this.accept.shadow_mc,"fadeIn",300),gsap.to(this.accept.win,{y:148,duration:.5,ease:"back.out(1.7)"}),root.layer1_mc.addChild(this.accept)}hideAccept(){root.layer1_mc.removeChild(this.accept)}showNoEnergy(){this.noenergy.win.x=-416,this.noenergy.shadow_mc.alpha=0,this.noenergy.win.blow_mc.alpha=0,helper.fadeAnimation(this.noenergy.shadow_mc,"fadeIn",300),gsap.to(this.noenergy.win,{x:209,duration:.5,ease:"back.out(1.7)",onComplete:()=>{helper.fadeAnimation(this.noenergy.win.blow_mc,"fadeIn",200),sounds.playLarek()}}),root.layer1_mc.addChild(this.noenergy),learn.check()}hideNoEnergy(){helper.fadeAnimation(this.noenergy.shadow_mc,"fadeOut",500),gsap.to(this.noenergy.win,{x:800,duration:.3,onComplete:()=>{root.layer1_mc.removeChild(this.noenergy)}})}showResult(t){this.result.win.x=-416,this.result.shadow_mc.alpha=0;let e=Math.floor(Math.random()*this.random_name.length);this.result.win.title_txt.text=this.random_name[e],sounds.playError(e);try{this.result.win.info_txt.text=helper.decode64(t.text)}catch(e){this.result.win.info_txt.text=t.text}helper.fadeAnimation(this.result.shadow_mc,"fadeIn",300),gsap.to(this.result.win,{x:209,duration:.5,ease:"back.out(1.7)"}),root.layer1_mc.addChild(this.result)}hideResult(){helper.fadeAnimation(this.result.shadow_mc,"fadeOut",500),gsap.to(this.result.win,{x:800,duration:.3,onComplete:()=>{root.layer1_mc.removeChild(this.result)}})}showCompleteLocation(){this.complete_loc.win.x=-416,this.complete_loc.shadow_mc.alpha=0,this.complete_loc.win.blow_mc.alpha=0,this.complete_loc.win.decor_mc.little_resp.x=104,this.complete_loc.win.decor_mc.little_resp.x=160,this.complete_loc.win.decor_mc.kastet.x=58,this.complete_loc.win.decor_mc.kastet.x=66,this.complete_loc.win.decor_mc.big_resp.x=62,this.complete_loc.win.decor_mc.big_resp.x=58,this.complete_loc.win.decor_mc.up_money.x=176,this.complete_loc.win.decor_mc.up_money.x=40,helper.fadeAnimation(this.complete_loc.shadow_mc,"fadeIn",300),gsap.to(this.complete_loc.win,{x:232,duration:.5,ease:"back.out(1.7)",onComplete:()=>{gsap.to(this.complete_loc.win.decor_mc.little_resp,{x:159,y:139,duration:.6,ease:"back.out(1.7)"}),gsap.to(this.complete_loc.win.decor_mc.kastet,{x:-35,y:66,duration:.2}),gsap.to(this.complete_loc.win.decor_mc.big_resp,{x:0,y:0,duration:.4,ease:"back.out(1.7)"}),gsap.to(this.complete_loc.win.decor_mc.up_money,{x:242,y:7,duration:.3,ease:"back.out(1.7)"})}}),root.layer1_mc.addChild(this.complete_loc)}hideCompleteLocation(){helper.fadeAnimation(this.complete_loc.shadow_mc,"fadeOut",500),gsap.to(this.complete_loc.win,{x:800,duration:.3,onComplete:()=>{root.layer1_mc.removeChild(this.complete_loc),learn.check()}})}showReload(t){t||(t=TIMERS.bossTimerControl()),this.reload.parent||root.layer1_mc.addChild(this.reload),this.reload.win.weapon_mc.gotoAndStop(fights.wid);let e=t.time,s=parseInt(e/60),i=parseInt(s/60);this.reload.win.time_txt.text="Будет доступно через "+helper.timeString(t.time),0==i&&i++,this.reload.win.money_txt.text="Ускорить за "+i}hideReload(){this.reload.parent&&root.layer1_mc.removeChild(this.reload)}showNoWeapon(){this.noweapon.win.blow_mc.alpha=0;for(let t=1;t<=3;t++)this.noweapon.win["weap"+t+"_txt"].text=helper.shortText(udata.weapons[t-1]);helper.fadeAnimation(this.noweapon.win.blow_mc,"fadeIn",600),this.noweapon.parent||root.layer1_mc.addChild(this.noweapon)}hideNoWeapon(){this.noweapon.parent&&root.layer1_mc.removeChild(this.noweapon)}showNoMoney(){modules.checkFlags(["bank"],(()=>{donat.gold.saletime-TIME>0?bank.gold_mode="sale":bank.gold_mode="default";let t=donat.semki.saletime-TIME>0?"sale":"default";notify.nomoney.win.rubles_txt.text=donat.gold[bank.gold_mode][bank.getDonatLevel()][2],notify.nomoney.win.semki_txt.text=donat.semki[t][bank.getDonatLevel()][3],notify.nomoney.parent||root.layer1_mc.addChild(notify.nomoney)}))}hideNoMoney(){this.nomoney.parent&&root.layer1_mc.removeChild(this.nomoney)}showBuy(){if(!(udata.learn.wr0&&udata.learn.wr1&&udata.learn.wr2&&udata.learn.wr3))return;sounds.playShop();let t=helper.duplicate(icon_wears[shop.actionID]);for(t.rotation=Math.PI/180*-14,this.buy.win.slot_bg.gotoAndStop(Math.floor(3*Math.random()));this.buy.win.slot_mc.numChildren;)this.buy.win.slot_mc.removeChildAt(0);this.buy.win.slot_mc.addChild(t),this.buy.parent||root.layer1_mc.addChild(this.buy)}hideBuy(){this.buy.parent&&root.layer1_mc.removeChild(this.buy)}showNewLevel(){this.newlevel.win.left_mc.x=10,this.newlevel.win.left_mc.y=30,this.newlevel.win.up_mc.y=50,this.newlevel.win.right_mc.x=166,this.newlevel.win.level_txt.text=helper.getLevel(udata.exp)+" уровень",this.newlevel.win.semki_txt.text="+"+(100+Math.floor(3.5*helper.getLevel(udata.exp))),gsap.to(this.newlevel.win.left_mc,{x:-69,y:21,duration:.6,ease:"back.out(1.7)"}),gsap.to(this.newlevel.win.up_mc,{y:-80,duration:.4,ease:"back.out(1.7)"}),gsap.to(this.newlevel.win.right_mc,{x:283,duration:.3,ease:"back.out(1.7)"}),this.newlevel.parent||root.layer1_mc.addChild(this.newlevel),learn.check()}hideNewLevel(){this.newlevel.parent&&root.layer1_mc.removeChild(this.newlevel),learn.check()}initButtons(){setButton(this.noenergy.win.blow_mc.ok_btn),setButton(this.result.win.ok_btn),setButton(this.noenergy.win.ok_btn),setButton(this.complete_loc.win.ok_btn),setButton(this.reload.win.close_mc),setButton(this.noweapon.win.close_mc),setButton(this.nomoney.win.close_mc),setButton(this.buy.win.close_mc),setButton(this.newlevel.win.close_mc),setButton(this.nomoney.win.buy_rubles),setButton(this.nomoney.win.buy_semki),setButton(this.nomoney.win.obmen_mc),setButton(this.noweapon.win.blow_mc.butt_mc),setButton(this.reload.win.butt_mc),setButton(this.buy.win.share_btn),setButton(this.accept.win.butt_mc),setButton(this.accept.win.close_mc)}initUnics(){this.accept.win.close_mc.addChild(helper.duplicate(modules.unical.close))}}class r{constructor(t,e,s,i){this.atm=t,this.obmen=e,this.semki=s,this.semki_slot=i,this.vesy_counter=0,this.vesy_bool=!1,this.semki_mode=1,this.set_donut=0,this.buttons_atm=[this.atm.bm1_mc,this.atm.bm2_mc,this.atm.bm3_mc,this.atm.bm4_mc],this.texts_atm=[this.atm.monitor_mc.tf1,this.atm.monitor_mc.tf2,this.atm.monitor_mc.tf3,this.atm.monitor_mc.tf4],this.slots=[this.atm.monitor_mc.minigame_mc.slot1.anim_mc,this.atm.monitor_mc.minigame_mc.slot2.anim_mc,this.atm.monitor_mc.minigame_mc.slot3.anim_mc],this.slots_check=[this.atm.monitor_mc.minigame_mc.check_mc.check1,this.atm.monitor_mc.minigame_mc.check_mc.check2,this.atm.monitor_mc.minigame_mc.check_mc.check3],this.rand_butt=this.atm["bl"+(Math.floor(4*Math.random())+1)+"_mc"],this.start_slots=!1,this.slot_frames={};for(let t=0;t<this.buttons_atm.length;t++)setButton(this.buttons_atm[t]),this.buttons_atm[t].on("pointerdown",(t=>{this.atm.monitor_mc.minigame_mc.visible||(this.set_donut=this.buttons_atm.indexOf(t.currentTarget),bridge.send("VKWebAppShowOrderBox",{type:"item",item:"item"+this.set_donut.toString()}))}));this.semki_mode="s",this.semki_page=0,this.initUnics(),this.initButtons(),this.semki.interactive=!0,this.semki.win.close_mc.on("pointerdown",(()=>this.hideSemki())),bridge.subscribe((t=>{"VKWebAppShowOrderBoxResult"==t.detail.type&&this.successDonat(t)}));for(let t=0;t<this.slots[0]._labels.length;t++)this.slot_frames[this.slots[0]._labels[t].label]=this.slots[0]._labels[t].position;this.rand_butt.on("pointerdown",(()=>{this.atm.monitor_mc.minigame_mc.visible?this.init():this.initSlots()})),this.atm.monitor_mc.minigame_mc.butt.on("pointerdown",(()=>{this.start_slots||TS.php("slotmachine.start",{},(t=>this.startSpin(t)),rootClass.onError)})),helper.clickControl(this.atm.monitor_mc.minigame_mc.buy_spin,null,(()=>{0===this.atm.money_mc.currentFrame&&TS.php("slotmachine.buy",{id:1},(t=>this.buySpin(t)),rootClass.onError)}),(()=>{iface.obmen_fun=()=>TS.php("slotmachine.buy",{id:Math.abs(iface.obmen_realvalue)},(t=>this.buySpin(t)),rootClass.onError),iface.obmen.win.box_obmen_all.visible=iface.obmen.win.obmen_all_mc.visible=!1,iface.obmen_vals=["gold","spins"],iface.obmen_by_coef=[30],iface.obmen_to_coef=1,iface.startObmen()})),this.semki.win.arrows_mc.prev_bt.on("pointerdown",(()=>this.prevSemkiPage())),this.semki.win.arrows_mc.next_bt.on("pointerdown",(()=>this.nextSemkiPage())),this.semki.win.tcoin_ic.on("pointerdown",(()=>{this.semki_mode="t",this.semki.win.tcoin_ic.alpha=1,this.semki.win.semki_ic.alpha=.7,this.semki.win.rubles_ic.alpha=.7,this.showSemkiSlots()})),this.semki.win.semki_ic.on("pointerdown",(()=>{this.semki_mode="s",this.semki.win.tcoin_ic.alpha=.7,this.semki.win.semki_ic.alpha=1,this.semki.win.rubles_ic.alpha=.7,this.showSemkiSlots()})),this.semki.win.rubles_ic.on("pointerdown",(()=>{this.semki_mode="r",this.semki.win.tcoin_ic.alpha=.7,this.semki.win.semki_ic.alpha=.7,this.semki.win.rubles_ic.alpha=1,this.showSemkiSlots()})),helper.blowController("slot_machine",[this.atm.monitor_mc.minigame_mc.buy_spin],this.atm.monitor_mc.minigame_mc.blow_mc)}init(){helper.goLocation(10),DATE.getHours()>=21||DATE.getHours()<6?this.atm.night_mc.visible=!0:this.atm.night_mc.visible=!1,donat.gold.saletime-TIME>0?this.gold_mode="sale":this.gold_mode="default",this.atm.bm4_mc.visible=!0,this.atm.monitor_mc.minigame_mc.visible=!1;for(let t=0;t<this.texts_atm.length;t++)this.texts_atm[t].text=donat.gold.price[t]/7+" VK — "+donat.gold[this.gold_mode][this.getDonatLevel()][t]+" руб.";this.atm.parent||root.layer0_mc.addChild(this.atm)}initSlots(){if(!this.atm.monitor_mc.minigame_mc.visible){this.atm.bm4_mc.visible=!1,this.atm.monitor_mc.minigame_mc.visible=!0,this.start_slots=!1;for(let t=0;t<this.slots.length;t++)this.slots[t].gotoAndStop(Math.floor(Math.random()*this.slots[t]._totalFrames)),this.slots_check[t].gotoAndStop(1);this.atm.monitor_mc.minigame_mc.spins_txt.text=udata.slot_machine_spins}}startSpin(t){this.start_slots=!0;for(let t=0;t<this.slots.length;t++)this.slots[t].play(),this.slots_check[t].gotoAndStop(1);this.atm.monitor_mc.minigame_mc.spins_txt.text=udata.slot_machine_spins;let e=0,s=()=>{let t=setInterval((()=>{clearInterval(t),i()}),1600)},i=()=>{let i=setInterval((()=>{this.slots[e].currentFrame==this.slot_frames[t.info.slots[e]]&&(this.slots[e].stop(),t.info.slots[e]==t.info.slots[0]&&this.slots_check[e].gotoAndStop(0),e++,clearInterval(i),3==e?this.finishSlots(t):s())}),1)};s()}finishSlots(t){if("default"==t.info.type)return this.start_slots=!1;let e=!1;this.atm.monitor_mc.minigame_mc.win_mc.icon_mc.gotoAndStop(t.info.type),this.atm.monitor_mc.minigame_mc.win_mc.tf_txt.text="+"+helper.getNumber(t.info.win,".");for(let t=0;t<this.slots.length;t++){let e=0,i=()=>{helper.alphaAnimation(this.slots[t].parent,.5,300,(()=>{helper.alphaAnimation(this.slots[t].parent,1,300,(()=>{e++,3==e?s():i()}))}))};i()}let s=()=>{if(!e){e=!0;for(let t=0;t<this.slots.length;t++)helper.alphaAnimation(this.slots[t].parent,0);helper.alphaAnimation(this.atm.monitor_mc.minigame_mc.win_mc,1,350,(()=>{achives.refresh(udata.achives_level),iface.updateUp();let t=setInterval((()=>{clearInterval(t);for(let t=0;t<this.slots.length;t++)helper.alphaAnimation(this.slots[t].parent,1,350);helper.alphaAnimation(this.atm.monitor_mc.minigame_mc.win_mc,0,100,(()=>this.start_slots=!1))}),3500)}))}}}buySpin(){this.atm.money_mc.gotoAndPlay(113),iface.stopObmen(),achives.refresh(),iface.updateUp(),this.atm.monitor_mc.minigame_mc.spins_txt.text=udata.slot_machine_spins}showSemki(){TIMERS.timers.sale.init||(TIMERS.timers.sale={init:!0,tick:t=>this.semkiTick(t)}),this.semki.shadow_mc.alpha=this.semki.shadow_box.alpha=this.semki.win.blow_mc.alpha=0,this.semki.win.y=-600,this.semki.bg_mc.visible=!1,this.semki.win.mcft_anim.gotoAndStop(0),this.semki_page=0,"s"==this.semki_mode?this.semki.win.vesy.display_mc.anim_mc.gotoAndStop(19):this.semki.win.vesy.display_mc.anim_mc.gotoAndStop(0),this.showSemkiSlots(),helper.fadeAnimation(this.semki.shadow_mc,"fadeIn",300,(()=>{helper.fadeAnimation(this.semki.bg_mc,"fadeIn",1e3),gsap.to(this.semki.win,{y:59,duration:1,ease:"back.out(1.3)",onComplete:()=>{helper.fadeAnimation(this.semki.shadow_box,"fadeIn",100),helper.alphaAnimation(this.semki.win.blow_mc,1,300),this.semki.win.mcft_anim.gotoAndPlay(1),"s"==this.semki_mode?this.semki.win.vesy.display_mc.anim_mc.gotoAndPlay(20):this.semki.win.vesy.display_mc.anim_mc.gotoAndPlay(1)}})})),root.layer1_mc.addChild(this.semki)}showSemkiSlots(){for(;this.semki.win.slots_mc.children.length;)this.semki.win.slots_mc.removeChildAt(0);let t="s"==this.semki_mode?"semki":"t_coin";"r"==this.semki_mode&&(t="gold");let e="gold"==t?0:donat.gold.price.length,s="s"==this.semki_mode||"r"==this.semki_mode?0:donat.semki.price.length,i=donat[t].saletime>TIME;this.semki.win.blow_mc.visible=donat[t].saleday;for(let o=0;o<4;o++){let a=Math.floor(o/2),n=helper.duplicate(this.semki_slot),h=donat[t].price[o+4*this.semki_page]/7;n.y=127*a,n.x=119*o-2*a*119,setTextStyle(n.counter_big.percent_txt,{miterLimit:3,stroke:"#cf0202",strokeThickness:3}),n.counter_mini.win_txt.text="x"+donat[t].default[this.getDonatLevel()][0]*h,n.price_txt.text=h+" "+helper.numberEndFlower(h,"votes"),0!=o||0!=this.semki_page||i?n.counter_mini.bg.gotoAndStop(0):(n.counter_big.visible=!1,n.counter_mini.bg.gotoAndStop(1)),n.counter_big.win_txt.text="x"+donat[t][i?"sale":"default"][this.getDonatLevel()][o+4*this.semki_page],n.counter_big.percent_txt.text="+"+Math.ceil((donat[t][i?"sale":"default"][this.getDonatLevel()][o+4*this.semki_page]-donat[t].default[this.getDonatLevel()][0]*h)/(donat[t].default[this.getDonatLevel()][0]*h)*100)+"%",n.icon_mc.gotoAndStop(this.semki_mode+Math.min(3,o+4*this.semki_page)),setButton(n.buy_mc),n.buy_mc.on("pointerdown",(t=>{this.set_donut=e+o+4*this.semki_page+s,bridge.send("VKWebAppShowOrderBox",{type:"item",item:"item"+this.set_donut.toString()})})),this.semki.win.slots_mc.addChild(n)}let o=udata.donat,a=1;this.semki.win.exp_txt.text="максимум";let n=0;for(let e=0;e<=donat[t].donat_levels.length;e++){if(e==donat[t].donat_levels.length){this.semki.win.level_txt.text=a,0!=this.semki.win.line_mc.full_mc.x&&gsap.to(this.semki.win.line_mc.full_mc,{duration:.3,x:0});break}if(donat[t].donat_levels[e]>o){this.semki.win.level_txt.text=a,this.semki.win.exp_txt.text=o-n+"/"+(donat[t].donat_levels[e]-n),this.semki.win.line_mc.full_mc.x!=(o-n)/(donat[t].donat_levels[e]-n)*111-111&&gsap.to(this.semki.win.line_mc.full_mc,{duration:.3,x:(o-n)/(donat[t].donat_levels[e]-n)*111-111});break}a++,n=donat[t].donat_levels[e]}this.semki.win.slots_mc.y=257,this.semki.win.arrows_mc.y=5}nextSemkiPage(){let t="s"==this.semki_mode?"semki":"t_coin";donat[t].price.length/4<=this.semki_page+1||(this.semki_page++,this.showSemkiSlots())}prevSemkiPage(){0!=this.semki_page&&(this.semki_page--,this.showSemkiSlots())}hideSemki(){this.semki.parent&&root.layer1_mc.removeChild(this.semki)}semkiTick(t){if("max"==t.status)return void(this.semki.win.blow_mc.time_txt.text="Sale Day окончен");let e=t.time,s=parseInt(e/60),i=parseInt(s/60),o=parseInt(i/24);e%=60,s%=60,i%=24,this.semki.win.blow_mc.time_txt.text=o+"д "+i+"ч "+s+"мин "+e+"сек"}successDonat(t){let e=donat.gold.saletime>TIME?"sale":"default",s=donat.semki.saletime>TIME?"sale":"default",i=donat.t_coin.saletime>TIME?"sale":"default";this.set_donut<donat.gold.price.length?(udata.gold=parseInt(udata.gold)+parseInt(donat.gold[e][this.getDonatLevel()][this.set_donut]),udata.donat=parseInt(udata.donat)+donat.gold.price[this.set_donut]/7,iface.updateUp(),iface.showChotko()):this.set_donut>=donat.gold.price.length&&this.set_donut<donat.gold.price.length+donat.semki.price.length?(udata.semki=parseInt(udata.semki)+parseInt(donat.semki[s][this.getDonatLevel()][this.set_donut-donat.gold.price.length]),udata.donat=parseInt(udata.donat)+donat.semki.price[this.set_donut-donat.gold.price.length]/7,iface.updateUp(),iface.showChotko()):(udata.t_coin=parseInt(udata.t_coin)+parseInt(donat.t_coin[i][this.getDonatLevel()][this.set_donut-donat.gold.price.length-donat.semki.price.length]),udata.donat=parseInt(udata.donat)+donat.semki.price[this.set_donut-donat.gold.price.length-donat.semki.price.length]/7,iface.updateUp(),iface.showChotko()),this.showSemkiSlots()}getDonatLevel(){let t=0,e=udata.donat;for(let s=0;s<donat.gold.donat_levels.length;s++)e>=donat.gold.donat_levels[s]&&t++;return t}initButtons(){setButton(this.semki.win.close_mc),setButton(this.semki.win.vesy.display_mc),setButton(this.atm.monitor_mc.minigame_mc.butt),setButton(this.atm.monitor_mc.minigame_mc.buy_spin),setButton(this.rand_butt),setButton(this.semki.win.arrows_mc.prev_bt),setButton(this.semki.win.arrows_mc.next_bt),setButton(this.semki.win.tcoin_ic),setButton(this.semki.win.semki_ic),setButton(this.semki.win.rubles_ic)}initUnics(){this.semki.shadow_mc.addChild(helper.duplicate(modules.unical.wood_shadow)),this.semki.win.close_mc.addChild(helper.duplicate(modules.unical.close)),this.semki.win.arrows_mc.addChild(helper.duplicate(modules.unical.arrows)),this.semki.win.arrows_mc=this.semki.win.arrows_mc.children[0]}}class m{constructor(t,e,s){this.loc=t,this.bigP=e,this.pomp=s,this.pomps={},this.xWin=[170,420,680,220,420,680],this.yWin=[210,260,330,430,480,540],this.blowsLoc=[this.loc.blow1,this.loc.blow2,this.loc.blow3,this.loc.blow4,this.loc.blow5,this.loc.blow6],this.loc.search_mc.alpha=0,setButton(this.loc.work_mc.work_mc),this.loc.work_mc.work_mc.on("pointerdown",(()=>this.toWorks()))}init(){helper.goLocation(3),this.pomps={},udata.set_loc=map.setLoc,this.loc.work_mc.work_mc.visible=Boolean(udata.locs[map.setLoc]),this.updateWorkLevel(),this.tickTime({date:DATE}),TIMERS.timers.city.init||(TIMERS.timers.city={init:!0,tick:t=>this.tickTime(t)});for(let t=0;t<this.blowsLoc.length;t++){let e=0,s=locs.l[map.setLoc].quests[t];if(this.blowsLoc[t].qw_blow.alpha=0,this.blowsLoc[t].ql_blow.alpha=0,this.blowsLoc[t].qt_blow.alpha=0,this.blowsLoc[t].name_txt.text=helper.decode64(locs.q[s].name),this.blowsLoc[t].moneyprice_txt.text="+"+locs.q[s].coins,this.blowsLoc[t].expprice_txt.text="+"+locs.q[s].exp,this.blowsLoc[t].energy_txt.text="-"+locs.q[s].energy,this.blowsLoc[t].level_mc.level_txt.text=locs.q[locs.l[map.setLoc].quests[t]].want.level,this.blowsLoc[t].daynight_mc.gotoAndStop(locs.q[locs.l[map.setLoc].quests[t]].want.time),this.blowsLoc[t].qt_blow.gotoAndStop(locs.q[locs.l[map.setLoc].quests[t]].want.time),-1==locs.q[locs.l[map.setLoc].quests[t]].want.wear)this.blowsLoc[t].wear_mc.visible=!1;else{for(this.blowsLoc[t].wear_mc.visible=!0;this.blowsLoc[t].qw_blow.wear_mc.children.length;)this.blowsLoc[t].qw_blow.wear_mc.removeChildAt(0);this.blowsLoc[t].qw_blow.wear_mc.addChild(helper.duplicate(icon_wears[locs.q[locs.l[map.setLoc].quests[t]].want.wear]))}for(this.blowsLoc[t].button_mc._events.pointerdown||(setButton(this.blowsLoc[t].button_mc),setButton(this.blowsLoc[t].level_mc),setButton(this.blowsLoc[t].wear_mc),this.blowsLoc[t].daynight_mc.interactive=this.blowsLoc[t].daynight_mc.buttonMode=!0,this.blowsLoc[t].qt_blow.alpha=this.blowsLoc[t].ql_blow.alpha=this.blowsLoc[t].qw_blow.alpha=0,this.blowsLoc[t].button_mc.on("pointerdown",(t=>this.goQuest(t))),this.blowsLoc[t].daynight_mc.on("mouseover",(t=>helper.fadeAnimation(this.blowsLoc[this.blowsLoc.indexOf(t.currentTarget.parent)].qt_blow,"fadeIn"))),this.blowsLoc[t].daynight_mc.on("mouseout",(t=>helper.fadeAnimation(this.blowsLoc[this.blowsLoc.indexOf(t.currentTarget.parent)].qt_blow,"fadeOut"))),this.blowsLoc[t].level_mc.on("mouseover",(t=>helper.fadeAnimation(this.blowsLoc[this.blowsLoc.indexOf(t.currentTarget.parent)].ql_blow,"fadeIn"))),this.blowsLoc[t].level_mc.on("mouseout",(t=>helper.fadeAnimation(this.blowsLoc[this.blowsLoc.indexOf(t.currentTarget.parent)].ql_blow,"fadeOut"))),this.blowsLoc[t].wear_mc.on("mouseover",(t=>helper.fadeAnimation(this.blowsLoc[this.blowsLoc.indexOf(t.currentTarget.parent)].qw_blow,"fadeIn"))),this.blowsLoc[t].wear_mc.on("mouseout",(t=>helper.fadeAnimation(this.blowsLoc[this.blowsLoc.indexOf(t.currentTarget.parent)].qw_blow,"fadeOut"))),this.blowsLoc[t].wear_mc.on("pointerdown",(t=>{main_menu.toShop("custom",[locs.q[locs.l[map.setLoc].quests[this.blowsLoc.indexOf(t.currentTarget.parent)]].want.wear])})));this.blowsLoc[t].pomps_mc.children.length;)this.blowsLoc[t].pomps_mc.removeChildAt(0);for(this.pomps[t]=[],e=0;e<parseInt(locs.q[s].rps);e++){this.pomps[t][e]=helper.duplicate(this.pomp);try{parseInt(udata.quests[s])>=e+1&&this.pomps[t][e].gotoAndStop(12)}catch(t){}this.pomps[t][e].x=(182-28*(parseInt(locs.q[s].rps)-1))/2+28*e,this.blowsLoc[t].pomps_mc.addChild(this.pomps[t][e])}for(;this.loc.background_mc.children.length;)this.loc.background_mc.removeChildAt(0);this.bigP[map.setLoc].stage||this.loc.background_mc.addChild(this.bigP[map.setLoc]);let i=udata.locsn[map.setLoc]||0;helper.numberAnimation(this.loc.myexp_mc.tf_txt,i,100,!1)}root.layer0_mc.addChild(this.loc),learn.check()}tickTime(t){this.loc.timer_mc.time_txt.text=helper.getZeros(t.date.getHours())+":"+helper.getZeros(t.date.getMinutes())}updateWorkLevel(){let t=works.getLevel();this.loc.work_mc.level_txt.text=t,this.loc.work_mc.nowork_txt.text="Если хочешь поднять реальных денег - иди и работай!"}toWorks(t=null){(14!=HYSTORY[HYSTORY.length-1]||TOBACK)&&(null==t&&(t=map.setLoc),TS.php("works.check",{loc:t,level:1},(e=>{works.work_info=e.info,iface.removeStage(),works.init(0,t),iface.showIcons()}),rootClass.onError))}goQuest(t){let e=this.blowsLoc.indexOf(t.currentTarget.parent);if(-1==e)return;let s=locs.l[map.setLoc].quests[e];TS.php("city.quest",{id:s,loc:map.setLoc},(t=>{achives.refresh(),udata.set_loc=map.setLoc;let i=udata.quests;if(Boolean(t.endLocation)||parseInt(i[s])-1<locs.q[s].rps&&this.pomps[e][parseInt(i[s])-1].play(),helper.numberAnimation(this.loc.myexp_mc.tf_txt,udata.locsn[map.setLoc],100,!1),helper.animatePrice(modules.names.interface.e,locs.q[s].exp,0,this.xWin[e],this.yWin[e],this.loc),helper.animatePrice(modules.names.interface.c,locs.q[s].coins,0,this.xWin[e],this.yWin[e],this.loc),Boolean(t.endLocation)?modules.checkFlags(["notify"],(()=>{for(let t=0;t<locs.l[map.setLoc].quests.length;t++)for(let e=0;e<this.pomps[t].length;e++)this.pomps[t][e].gotoAndStop(0);notify.showCompleteLocation();let t=udata.locs;sounds.playKrasava(),t[map.setLoc]=t[map.setLoc]||0,this.loc.work_mc.work_mc.visible||(this.loc.work_mc.work_mc.visible=Boolean(udata.locs[map.setLoc])),this.updateWorkLevel(),learn.check()})):(sounds.playBuba(),console.log(udata.locsn),learn.check()),iface.updateUp(),1==parseInt(t.weaponWin)||1==parseInt(t.wearWin)){if(1==parseInt(t.weaponWin)&&this.loc.search_mc.gotoAndStop("weapon"+t.weaponWinID),1==parseInt(t.wearWin)&&this.loc.search_mc.gotoAndStop("wear"),sounds.playNahodka(),this.loc.search_mc.alpha>0)return;this.loc.search_mc.alpha=0,this.loc.search_mc.y=600,helper.fadeAnimation(this.loc.search_mc,"fadeIn",700),gsap.to(this.loc.search_mc,{y:550,duration:.7,onComplete:()=>{helper.fadeAnimation(this.loc.search_mc,"fadeOut",1500)}})}t.item_win&&modules.checkFlags(["coll"],(()=>collections.showNahodka(t.item_id)))}),rootClass.onError)}}class _{constructor(t,e){this.map=t,this.miniP=e,this.blockButts=[this.map.block2,this.map.block3,this.map.block4,this.map.block5],this.blockBlows=[this.map.blb2,this.map.blb3,this.map.blb4,this.map.blb5],this.routes=[this.map.route1_mc,this.map.route2_mc,this.map.route3_mc,this.map.route4_mc,this.map.route5_mc],this.routeButts=[this.map.loc1_mc,this.map.loc2_mc,this.map.loc3_mc,this.map.loc4_mc,this.map.loc5_mc],this.routeBlows=[this.map.blow1_mc,this.map.blow2_mc,this.map.blow3_mc,this.map.blow4_mc,this.map.blow5_mc],this.tfR=[this.map.info1_txt,this.map.info2_txt,this.map.info3_txt,this.map.info4_txt,this.map.info5_txt],this.setLoc=0,this.setCity=0,this.initButtons();for(let t=0;t<this.routeButts.length;t++)setButton(this.routeButts[t]),this.routeButts[t].on("mouseover",(t=>this.routeOver(t))),this.routeButts[t].on("mouseout",(t=>this.routeOut(t))),this.routeButts[t].on("pointerdown",(t=>this.showInfo(t)));for(let t=0;t<this.blockButts.length;t++)setButton(this.blockButts[t]),this.blockButts[t].on("mouseover",(t=>helper.fadeAnimation(this.blockBlows[this.blockButts.indexOf(t.currentTarget)],"fadeIn",300))),this.blockButts[t].on("mouseout",(t=>helper.fadeAnimation(this.blockBlows[this.blockButts.indexOf(t.currentTarget)],"fadeOut",300)));this.map.i_mc.on("mouseover",(()=>helper.fadeAnimation(this.map.iBlow_mc,"fadeIn",300))),this.map.i_mc.on("mouseout",(()=>helper.fadeAnimation(this.map.iBlow_mc,"fadeOut",300))),this.map.i_mc.on("pointerdown",(()=>iface.toMenu())),this.map.infoloc_mc.close_mc.on("pointerdown",(()=>this.map.infoloc_mc.visible=!1)),this.map.infoloc_mc.craft_mc.on("mouseover",(()=>helper.fadeAnimation(this.map.infoloc_mc.blow_mc,"fadeIn",300))),this.map.infoloc_mc.craft_mc.on("mouseout",(()=>helper.fadeAnimation(this.map.infoloc_mc.blow_mc,"fadeOut",300))),this.map.infoloc_mc.button_mc.on("pointerdown",(()=>this.toLocation())),this.map.infoloc_mc.loader_mc.on("pointerdown",(()=>{udata.locs[0]>0&&iface.goGuest(loctop.ids[this.setLoc])})),this.map.infoloc_mc.interactive=!0}init(){let t=helper.getLevel(udata.exp);helper.goLocation(2);for(let e=0;e<this.routeButts.length;e++){let s=parseInt(locs.q[locs.l[e].quests[0]].want.level);if(s>t)this.blockButts[e-1].visible=!0,this.tfR[e].text="с "+s+" уровня";else{e>0&&(this.blockButts[e-1].visible=!1);let t=udata.locs[e]||0;this.tfR[e].text="захвачен "+t+" "+helper.numberEnd(t)}}this.map.infoloc_mc.visible=!1,this.map.infoloc_mc.visible=!1,root.layer0_mc.addChild(this.map),learn.check()}toLocation(){(3!=HYSTORY[HYSTORY.length-1]||TOBACK)&&(iface.removeStage(),iface.hideIcons(),city.init())}showInfo(t){if(this.setLoc=this.routeButts.indexOf(t.currentTarget),-1!=this.setLoc){for(this.map.infoloc_mc.name_txt.text=helper.decode64(loctop.name[this.setLoc]),this.map.infoloc_mc.exp_txt.text=helper.shortText(parseInt(loctop.locsn[this.setLoc])),this.map.infoloc_mc.locname_txt.text=helper.decode64(locs.l[this.setLoc].name),this.map.infoloc_mc.history_txt.text=helper.decode64(locs.l[this.setLoc].history),this.map.infoloc_mc.moneyprice_txt.text="+"+locs.l[this.setLoc].price.money,this.map.infoloc_mc.expprice_txt.text="+"+locs.l[this.setLoc].price.exp,-1!==locs.l[this.setLoc].price.w?(this.map.infoloc_mc.craft_mc.visible=!0,this.map.infoloc_mc.craftprice_txt.text="шанс",this.map.infoloc_mc.blow_mc.wear_mc.addChild(helper.duplicate(icon_wears[locs.l[this.setLoc].price.w]))):(this.map.infoloc_mc.craft_mc.visible=!1,this.map.infoloc_mc.craftprice_txt.text=""),helper.loadPhoto100(loctop.ids[this.setLoc],(t=>{for(;this.map.infoloc_mc.loader_mc.children.length;)this.map.infoloc_mc.loader_mc.removeChildAt(0);this.map.infoloc_mc.loader_mc.addChild(t)}),loctop.photos[this.setLoc]);this.map.infoloc_mc.photo_mc.children.length;)this.map.infoloc_mc.photo_mc.removeChildAt(0);this.map.infoloc_mc.photo_mc.addChild(helper.duplicate(this.miniP[this.setLoc])),parseInt(locs.q[locs.l[this.setLoc].quests[0]].want.level)>helper.getLevel(udata.exp)?this.map.infoloc_mc.button_mc.visible=!1:this.map.infoloc_mc.button_mc.visible=!0,this.map.infoloc_mc.visible=!0,learn.check()}}routeOver(t){let e=this.routeButts.indexOf(t.currentTarget);helper.fadeAnimation(this.routeBlows[e],"fadeIn",300),helper.fadeAnimation(this.routes[e],"fadeIn",300)}routeOut(t){let e=this.routeButts.indexOf(t.currentTarget);helper.fadeAnimation(this.routeBlows[e],"fadeOut",300),helper.fadeAnimation(this.routes[e],"fadeOut",300)}initButtons(){setButton(this.map.infoloc_mc.loader_mc),setButton(this.map.i_mc),setButton(this.map.infoloc_mc.close_mc),setButton(this.map.infoloc_mc.craft_mc),setButton(this.map.infoloc_mc.button_mc),setButton(this.map.infoloc_mc.loader_mc)}}class c{constructor(t,e,s,i,o,a){this.works=t,this.works_neutral=e,this.works_defeat=s,this.works_win=i,this.slot_level=o,this.slot=a,this._myworks=[0,0,0,0,0],this.loc_names=["вокзальном","автобанском","лапинском","армейском","проходном"],this.bosses=["Барыгу","Санту","Мажика","Фому","Пятницу","Очкарика"],this.show_nap={visible:!0,parent:!1},this.works_win.interactive=this.works_neutral.interactive=this.works_defeat.interactive=this.works.box_mc.interactive=!0,helper.blowController("works_enter",[this.works.leaf_mc.enter_mc.start_mc],this.works.leaf_mc.enter_mc.blow_txt);for(let t=0;t<5;t++)helper.clickControl(this.works.locs_mc["loc"+t],null,(()=>{this.loc=t,this.lvl=0,this.updateStatus()}));for(let t=1;t<=3;t++)helper.blowController("works_info"+t,[this.works.leaf_mc.works_mc["work"+t].line],this.works.leaf_mc.works_mc["work"+t].blow_mc),setButton(this.works.leaf_mc.works_mc["work"+t].info_mc.icon_mc),this.works.leaf_mc.works_mc["work"+t].info_mc.icon_mc.visible=!1,2!==t?helper.blowController("works_help"+t,[this.works.leaf_mc.works_mc["work"+t].info_mc.icon_mc],this.works.leaf_mc.works_mc["work"+t].info_mc.blow_mc):this.works.leaf_mc.works_mc["work"+t].info_mc.icon_mc.on("pointerdown",(()=>{this.show_nap={visible:!0,parent:!0},learn.check()}));window.addEventListener("focus",(()=>this.setUPD())),window.addEventListener("blur",(()=>this.removeUPD())),helper.clickControl(this.works.leaf_mc.enter_mc.start_mc,null,(()=>TS.php("works.start",{loc:this.loc,level:this.lvl+1},(t=>this.enterWork(t.info)),rootClass.onError))),helper.clickControl(this.works.leaf_mc.works_mc.out_mc,null,(()=>this.hideTop())),helper.clickControl(this.works_neutral.win.close_mc,null,(t=>this.hideResult(t))),helper.clickControl(this.works_defeat.win.close_mc,null,(t=>this.hideResult(t))),helper.clickControl(this.works_win.win.close_mc,null,(t=>this.hideResult(t))),this.initButtons()}init(t=null,e=null){helper.goLocation(14),this.works.box_mc.first_txt.text="",this.loc=null!==e?e:0,this.lvl=null!==t?t:0,this.work_info.ids&&(this.work_info_local=helper.copyJSON(this.work_info)),this.statusLevel(),this.works.parent||(root.layer0_mc.addChild(this.works),learn.check())}removeUPD(){clearInterval(this.interval),this.init_timers=!1}setUPD(){this.init_timers||(this.interval=setInterval((()=>{if(!this.works.parent)return this.removeUPD();this.updateStatus()}),1e4),this.init_timers=!0)}statusLevel(){if(udata.works_levels||(udata.works_levels=helper.copyJSON(this._myworks)),this.setUPD(),"neutral"==this.work_info.status)this.neutralStatus(),TIMERS.timers.work_refresh.init||(TIMERS.timers.work_refresh={init:!0,tick:t=>this.enterTick(t)}),this.enterTick(TIMERS.workRefreshControl());else if("processed"==this.work_info.status){this.processStatus();let t=TIMERS.workWorkControl();"max"==t.status&&(t.time=1380),!TIMERS.timers.work_wait.init&&t.time>=1200?(TIMERS.timers.work_work.init=!1,TIMERS.timers.work_wait={init:!0,tick:t=>this.waitTick(t)}):t.time<=1200&&(TIMERS.timers.work_wait.init=!1,TIMERS.timers.work_work={init:!0,tick:t=>this.workTick(t)})}else"win"==this.work_info.status?(this.showWinDef(),this.updateStatus()):"def"==this.work_info.status?(this.showWinDef(this.works_defeat),this.updateStatus()):"nogamers"==this.work_info.status&&(this.showNG(),this.updateStatus());this.locInfo(),this.generateLevels()}neutralStatus(){this.works.box_mc.x=800,this.works.locs_mc.alpha=1,this.works.levels_mc.alpha=1,this.works.leaf_mc.enter_mc.visible=!0,this.works.leaf_mc.works_mc.visible=!1,this.showQuests()}processStatus(){this.works.leaf_mc.enter_mc.visible=!1,this.works.leaf_mc.works_mc.visible=!0,gsap.to(this.works.box_mc,{duration:.1,x:400,onComplete:()=>{}}),helper.alphaAnimation(this.works.locs_mc,0),helper.alphaAnimation(this.works.levels_mc,0),this.qst=works_info.works[parseInt(this.work_info.info.type)],this.all_work=this.work_info.info.info.users;for(let t=0;t<this.all_work.length;t++)this.all_work[t].id==udata.id&&(this.my_work=this.all_work[t].info);if(76==parseInt(this.work_info.info.type))for(let t=1;t<=3;t++)this.works.leaf_mc.works_mc["work"+t].info_mc.icon_mc.visible=!0;this.showComboWork(),this.calculatePosition()}hideTop(){gsap.to(this.works.box_mc,{duration:.1,x:800,onComplete:()=>{}}),helper.alphaAnimation(this.works.locs_mc,1),helper.alphaAnimation(this.works.levels_mc,1)}showQuests(){let t=works_info.works[this.work_info.ids[this.loc][this.lvl]];switch(0==udata.learn.w0&&(t=works_info.works[76]),this.works.leaf_mc.enter_mc.blow_txt.value_txt.text=helper.shortText(works_info.blat[this.loc][this.lvl]),this.works.leaf_mc.enter_mc.parameters_txt.text="- Набрать "+t.exp+" авторитета",parseInt(t.locexp)>0&&(this.works.leaf_mc.enter_mc.parameters_txt.text+="\n- Набрать "+t.locexp+" опыта в "+this.loc_names[this.loc]),t.boss&&(this.works.leaf_mc.enter_mc.parameters_txt.text+="\n- Завалить "+this.bosses[t.boss[0]]+" "+t.boss[1]+" "+helper.numberEnd(t.boss[1])),t.act){case"hobo":this.works.leaf_mc.enter_mc.parameters_txt.text+="\n- Разогнать "+t.value+" бомжей во дворе";break;case"naperstki":this.works.leaf_mc.enter_mc.parameters_txt.text+="\n- Сыграть "+t.value+" "+helper.numberEnd(t.value)+" в наперстки";break;case"kanobu":this.works.leaf_mc.enter_mc.parameters_txt.text+="\n- Сыграть "+t.value+" "+helper.numberEnd(t.value)+" в КНБ";break;case"shmon":this.works.leaf_mc.enter_mc.parameters_txt.text+="\n- Обшманать "+t.value+" "+helper.numberEnd(t.value)+" друзей";break;case"slots":this.works.leaf_mc.enter_mc.parameters_txt.text+="\n- Крутить "+t.value+" "+helper.numberEnd(t.value)+" слоты"}console.log(t)}updLocation(t=null){null==t&&(this.loc=0),t!=this.loc&&this.locInfo()}locInfo(){for(let t=0;t<this.loc_names.length;t++)this.works.locs_mc["loc"+t].close_mc.tf_txt.text="Нужно\nзахватить\n"+locs.l[t].name,this.works.locs_mc["loc"+t].close_mc.visible=Boolean(!udata.locs[t]),this.works.locs_mc["loc"+t].close_mc.interactive=!0,Boolean(udata.locs[t])&&setButton(this.works.locs_mc["loc"+t]),this.works.locs_mc["loc"+t].red_mc.alpha=udata.works_levels[t]?1:0,this.works.locs_mc["loc"+t].alpha=this.loc==t?1:.6}generateLevels(t=0){let e=this.getLevel(this.loc);for(this.lvl_slots=[];this.works.levels_mc.children.length;)this.works.levels_mc.removeChildAt(0);let s=10;this.work_info.ids&&(s=this.work_info_local.ids[this.loc].length);for(let t=0;t<s;t++){let s=helper.duplicate(this.slot_level),i=Math.floor(t/5);s.close_mc.tf_txt.text="Захватить\n"+locs.l[this.loc].name+"\n"+this.countLoc(t)+helper.numberEnd(this.countLoc(t)),s.close_mc.visible=e<=t,e>t&&setButton(s),s.tf_txt.text=t+1,s.red_mc.alpha=udata.works_levels[this.loc]==t+1?1:0,s.x=77*t-385*i,s.y=92*i,s.alpha=t==this.lvl?1:.6,helper.clickControl(s,null,(()=>{this.lvl=t,this.updateStatus()})),this.works.levels_mc.addChild(s),this.lvl_slots.push(s)}}showComboWork(){switch(helper.scaleAnimation(this.works.leaf_mc.works_mc.work1.line.line_mc,parseInt(this.my_work[0])/parseInt(this.qst.exp),100),helper.scaleAnimation(this.works.leaf_mc.works_mc.work2.line.line_mc,parseInt(this.my_work[1])/parseInt(this.qst.value),100),this.works.leaf_mc.works_mc.work1.line.check_mc.visible=parseInt(this.my_work[0])/parseInt(this.qst.exp)>=1,this.works.leaf_mc.works_mc.work2.line.check_mc.visible=parseInt(this.my_work[1])/parseInt(this.qst.value)>=1,this.works.leaf_mc.works_mc.work1.name_txt.text="Набрать "+this.qst.exp+" очков \n авторитета",this.works.leaf_mc.works_mc.work1.blow_mc.num_txt.text=this.my_work[0]+"/"+this.qst.exp,this.works.leaf_mc.works_mc.work2.blow_mc.num_txt.text=this.my_work[1]+"/"+this.qst.value,this.qst.act){case"hobo":this.works.leaf_mc.works_mc.work2.name_txt.text="Разогнать "+this.qst.value+" бомжей \n во дворе";break;case"naperstki":this.works.leaf_mc.works_mc.work2.name_txt.text="Сыграть "+this.qst.value+" "+helper.numberEnd(this.qst.value)+" \n в наперстки";break;case"kanobu":this.works.leaf_mc.works_mc.work2.name_txt.text="Сыграть "+this.qst.value+" "+helper.numberEnd(this.qst.value)+" \n в камень ножницы бумага";break;case"shmon":this.works.leaf_mc.works_mc.work2.name_txt.text="Обшманать "+this.qst.value+" "+helper.numberEnd(this.qst.value)+"\n друзей";break;case"slots":this.works.leaf_mc.works_mc.work2.name_txt.text="Крутить "+this.qst.value+" "+helper.numberEnd(this.qst.value)+"\n слотмашину"}parseInt(this.qst.locexp)>0&&(this.works.leaf_mc.works_mc.work3.name_txt.text="Набрать "+this.qst.locexp+" опыта \n в "+this.loc_names[this.loc],helper.scaleAnimation(this.works.leaf_mc.works_mc.work3.line.line_mc,parseInt(this.my_work[2])/parseInt(this.qst.locexp),100),this.works.leaf_mc.works_mc.work3.line.check_mc.visible=parseInt(this.my_work[2])/parseInt(this.qst.locexp)>=1,this.works.leaf_mc.works_mc.work3.blow_mc.num_txt.text=this.my_work[2]+"/"+this.qst.locexp),this.qst.boss&&(this.works.leaf_mc.works_mc.work3.name_txt.text="Завалить "+this.bosses[this.qst.boss[0]]+"\n"+this.qst.boss[1]+" "+helper.numberEnd(this.qst.boss[1]),helper.scaleAnimation(this.works.leaf_mc.works_mc.work3.line.line_mc,parseInt(this.my_work[2])/parseInt(this.qst.boss[1]),100),this.works.leaf_mc.works_mc.work3.line.check_mc.visible=parseInt(this.my_work[2])/parseInt(this.qst.boss[1])>=1,this.works.leaf_mc.works_mc.work3.blow_mc.num_txt.text=this.my_work[2]+"/"+this.qst.boss[1])}calculatePosition(){for(this.slots=[];this.works.box_mc.slots_mc.children.length;)this.works.box_mc.slots_mc.removeChildAt(0);for(let t=0;t<this.all_work.length;t++){let e=helper.duplicate(this.slot);e.y=105*t,e.line.line_mc.scale.x=this.all_work[t].percents/100,e.line.check_mc.visible=parseInt(this.all_work[t].percents)>=100,helper.loadPhoto50(this.all_work[t].id,(t=>e.photo.photo_mc.addChild(t))),e.photo.bg_mc.gotoAndStop(t),e.coins_mc.tf_txt.text="+"+works_info.locs[this.loc].wins[this.lvl][t].coins,e.exp_mc.tf_txt.text="+"+works_info.locs[this.loc].wins[this.lvl][t].exp,works_info.locs[this.loc].wins[this.lvl][t].semki?e.semki_mc.tf_txt.text="+"+works_info.locs[this.loc].wins[this.lvl][t].semki:e.semki_mc.visible=!1;let s=0;works_info.locs[this.loc].wins[this.lvl][t].caps&&(s=works_info.locs[this.loc].wins[this.lvl][t].caps,s+=Math.floor(s*(udata.mandat_caps_work/100))),works_info.locs[this.loc].wins[this.lvl][t].caps?e.caps_mc.tf_txt.text="+"+s:e.caps_mc.visible=!1,this.slots.push(e),this.works.box_mc.slots_mc.addChild(e)}}showWinDef(t=null){t||(t=this.works_win);let e=this.work_info.info.info.users;for(let s=0;s<4;s++)0==s?helper.loadPhoto100(e[s].id,(e=>t.win["photo"+(s+1)+"_mc"].addChild(e))):e[s]?helper.loadPhoto50(e[s].id,(e=>t.win["photo"+(s+1)+"_mc"].addChild(e))):helper.loadPhoto50("null",(e=>t.win["photo"+(s+1)+"_mc"].addChild(e)),null_photo50),t.win["coins"+(s+1)+"_mc"].tf_txt.text="+"+works_info.locs[this.loc].wins[this.work_info.level][s].coins,t.win["exp"+(s+1)+"_mc"].tf_txt.text="+"+works_info.locs[this.loc].wins[this.work_info.level][s].exp,t.win["semki"+(s+1)+"_mc"].tf_txt.text="+"+works_info.locs[this.loc].wins[this.work_info.level][s].semki,parseInt(works_info.locs[this.loc].wins[this.work_info.level][s].semki)>0?t.win["semki"+(s+1)+"_mc"].visible=!0:t.win["semki"+(s+1)+"_mc"].visible=!1;t||root.layer1_mc.addChild(t)}showNG(){this.works_neutral.win.coins_mc.tf_txt.text="+"+this.work_info.info,helper.loadPhoto100(udata.id,(t=>this.works_neutral.win.photo_mc.addChild(t))),this.works_neutral.parent||root.layer1_mc.addChild(this.works_neutral)}hideResult(t){let e=t.currentTarget.parent.parent;e.parent&&e.parent.removeChild(e)}enterTick(t){if("max"==t.status)return TIMERS.timers.work_refresh.init=this.works.leaf_mc.enter_mc.start_mc.visible=!1,void(this.works.time_txt.text="Вакансия закрыта, заходи позже!");this.works.time_txt.text="Вакансия закроется через "+helper.timeString(t.time,!1,!1),this.works.leaf_mc.enter_mc.start_mc.visible=!0}waitTick(t){if("max"==t.status)return TIMERS.timers.work_wait.init=!1,this.works.time_txt.text="Оу ес, братишка!",void(this.works.parent&&this.updateStatus());this.works.time_txt.text="Работа начнется через "+helper.timeString(t.time,!1,!1)}workTick(t){if("max"==t.status)return TIMERS.timers.work_work.init=!1,this.works.time_txt.text="Время на работку вышло",console.log("work"),this.works.parent&&this.updateStatus(),void learn.check();this.works.time_txt.text="Зарплата через "+helper.timeString(t.time,!1,!1)}countLoc(t=1){return Math.ceil(parseInt(works_info.levels[this.loc][t])/(parseInt(works_info.levels[this.loc][1])/10))}getLevel(t=null){null==t&&(t=map.setLoc);let e=udata.locsn[t]||0,s=0;for(let i=0;i<works_info.levels[t].length;i++)parseInt(e)>=parseInt(works_info.levels[t][i])&&s++;return s}updateStatus(){TS.php("works.check",{loc:this.loc,level:this.lvl+1},(t=>{this.work_info=t.info,this.works.parent&&this.init(this.lvl,this.loc)}),rootClass.onError)}enterWork(t){TIMERS.timers.work_refresh.init=!1,this.work_info=t,this.init(this.lvl,this.loc),learn.check()}initButtons(){setButton(this.works.leaf_mc.enter_mc.start_mc),setButton(this.works.leaf_mc.works_mc.out_mc),setButton(this.works_neutral.win.close_mc),setButton(this.works_defeat.win.close_mc),setButton(this.works_win.win.close_mc),setButton(this.works.leaf_mc.works_mc.work1.line),setButton(this.works.leaf_mc.works_mc.work2.line),setButton(this.works.leaf_mc.works_mc.work3.line)}}class d{constructor(t){this.knb=t,this.mode="gold",this.stampX=[54,140,221],this.hand1_buttons=[this.knb.setter_mc.hand_k,this.knb.setter_mc.hand_n,this.knb.setter_mc.hand_b],this.my_mode="k",this.anim_hand1=!1,this.startX=44,this.endX=207,this.downX=0,this.stavka=1,this.load_game=!1,this.initButtons();for(let t=0;t<this.hand1_buttons.length;t++)setButton(this.hand1_buttons[t]),this.hand1_buttons[t].on("pointerdown",(t=>{this.newMyMode(this.hand1_buttons.indexOf(t.currentTarget))}));this.knb.stavka_mc.scroll_btn.on("pointerdown",(t=>{this.down_scroll=!0,this.downX=t.data.global.x-this.knb.stavka_mc.scroll_btn.worldTransform.tx,console.log(this.downX)})),this.knb.stavka_mc.rubles_btn.on("pointerdown",(()=>{this.mode="gold",this.updateMode()})),this.knb.stavka_mc.semki_btn.on("pointerdown",(()=>{this.mode="semki",this.updateMode()})),this.knb.stavka_mc.stavka_btn.on("pointerdown",(()=>this.startGame())),this.knb.stavka_mc.take_btn.on("pointerdown",(()=>this.endGame())),root.on("pointermove",(t=>this.moveScroll(t))),root.on("pointerup",(()=>this.down_scroll=!1))}init(){main_menu.hideMinigames(),helper.goLocation(12),this.my_mode="k",this.knb.hand2_mc.visible=this.knb.hand3_mc.visible=!1,this.knb.hand1_mc.gotoAndStop(0),this.knb.setter_mc.stamp_mc.visible=!0,this.knb.setter_mc.stamp_mc.x=this.stampX[0],this.knb.icon_win.gotoAndStop(1),this.knb.icon2_win.gotoAndStop(0),this.updateMode(),root.layer0_mc.addChild(this.knb),learn.check()}startGame(){this.load_game||(this.load_game=!0,gsap.to(this.knb.hand1_mc,{duration:.3,x:-400}),gsap.to(this.knb.hand3_mc,{duration:.3,x:821}),gsap.to(this.knb.hand2_mc,{duration:.3,y:-361,onComplete:()=>{TS.php("kanobu.start",{val:this.stavka,mode:this.mode,knb:this.my_mode},(t=>{this.resultGame(t)}),(t=>{rootClass.onError(t),this.load_game=!1}))}}))}resultGame(t){sounds.playKNB(),achives.refresh(t.achives_level),this.knb.hand2_mc.gotoAndStop(t.user2),this.knb.hand3_mc.gotoAndStop(t.user3),this.knb.hand2_mc.visible=this.knb.hand3_mc.visible=!0,gsap.to(this.knb.hand1_mc,{duration:.3,x:-50}),gsap.to(this.knb.hand3_mc,{duration:.3,x:471}),gsap.to(this.knb.hand2_mc,{duration:.3,y:-11,onComplete:()=>{this.load_game=!1,this.updateSumm()}}),iface.updateUp(),learn.check()}endGame(){TS.php("kanobu.getMoney",{},(t=>{udata.kanobu=t.kanobu,udata.semki=t.semki,udata.gold=t.gold,this.updateSumm(),iface.updateUp()}),rootClass.onError)}updateMode(){"gold"==this.mode?(this.knb.stavka_mc.rubles_check.visible=!0,this.knb.stavka_mc.semki_check.visible=!1):"semki"==this.mode&&(this.knb.stavka_mc.rubles_check.visible=!1,this.knb.stavka_mc.semki_check.visible=!0),this.knb.stavka_mc.scroll_btn.x=this.startX,this.updateSumm()}newMyMode(t){this.anim_hand1||(this.anim_hand1=!0,gsap.to(this.knb.hand2_mc,{duration:.3,y:-361}),gsap.to(this.knb.hand3_mc,{duration:.3,x:821}),gsap.to(this.knb.hand1_mc,{duration:.3,x:-400,onComplete:()=>{0==t&&(this.my_mode="k"),1==t&&(this.my_mode="n"),2==t&&(this.my_mode="b"),this.knb.hand1_mc.gotoAndStop(t),gsap.to(this.knb.hand1_mc,{duration:.3,x:-50,onComplete:()=>this.anim_hand1=!1})}}),this.knb.setter_mc.stamp_mc.x=this.stampX[t])}moveScroll(t){if(!this.down_scroll)return;let e=this.startX-(this.startX+this.knb.stavka_mc.x-t.data.global.x);this.knb.stavka_mc.scroll_btn.x=e-this.downX,e-this.downX>=this.endX&&(this.knb.stavka_mc.scroll_btn.x=this.endX),e-this.downX<=this.startX&&(this.knb.stavka_mc.scroll_btn.x=this.startX),(t.data.global.x<20||t.data.global.x>750)&&(this.down_scroll=!1),this.updateSumm()}updateSumm(){let t=Math.min(1,.01+(this.knb.stavka_mc.scroll_btn.x-this.startX)/(this.endX-this.startX));this.stavka=Math.abs(4*Math.floor(100*t)),this.knb.stavka_mc.value_txt.text=this.stavka.toString();let e=udata.kanobu,s=e.semki||0,i=e.gold||0;this.knb.win_txt.text=i.toString(),this.knb.win2_txt.text=s.toString()}initButtons(){setButton(this.knb.stavka_mc.stavka_btn),setButton(this.knb.stavka_mc.take_btn),setButton(this.knb.stavka_mc.rubles_btn),setButton(this.knb.stavka_mc.semki_btn),setButton(this.knb.stavka_mc.scroll_btn)}}class p{constructor(t){this.game=t,this.stakanArr=[this.game.stakan1,this.game.stakan2,this.game.stakan3],this.bonus_array=[this.game.bonus1,this.game.bonus2,this.game.bonus3],this.startAnim=[36,44,58],this.timeAnim=[1100,834,367],this.endAnim=[69,99,129],this.ballX=[274,374,474],this.scroll_active=!1,this.coef={coins:50,gold:4},this.scroll_downX=0,this.scroll_bounds=[29,184],this.bonus=[0,0,0],this.first_game=!1,this.anim_interval=null,this.zaeb=1,this.all=0,this.my=0,this.stakan=0,this.mode="coins",this.summ=50,this.initButtons(),this.game.blow_mc.gotoAndStop(0),root.on("pointermove",(t=>this.moveScroll(t))),root.on("pointerup",(()=>this.scroll_active=!1)),this.game.stavka_mc.scroll_mov.scroll_mc.on("pointerdown",(t=>{this.scroll_active=!0,this.scroll_downX=t.data.global.x-this.game.stavka_mc.scroll_mov.worldTransform.tx})),this.game.stavka_mc.gold_btn.on("pointerdown",(()=>{this.game.stavka_mc.scroll_mov.x=this.scroll_bounds[0],this.mode="gold",this.updateSumm()})),this.game.stavka_mc.coins_btn.on("pointerdown",(()=>{this.game.stavka_mc.scroll_mov.x=this.scroll_bounds[0],this.mode="coins",this.updateSumm()})),this.game.level_mc.butt_mc.on("mouseover",(()=>{helper.fadeAnimation(this.game.level_mc.blow_mc,"fadeIn",300)})),this.game.level_mc.butt_mc.on("mouseout",(()=>{helper.fadeAnimation(this.game.level_mc.blow_mc,"fadeOut",300)}));for(let t=0;t<this.stakanArr.length;t++)setButton(this.stakanArr[t]),this.stakanArr[t].on("pointerdown",(t=>this.setStakan(t)))}init(){helper.goLocation(8),main_menu.hideMinigames(),this.game.stavka_mc.scroll_mov.x=this.scroll_bounds[0],this.mode="coins",this.bonus=udata.naperstki_bonus,this.updateSumm(),this.nullData();for(let t=0;t<this.stakanArr.length;t++)this.bonus[t]?this.stakanArr[t].visible=!1:this.stakanArr[t].visible=!0;this.game.stavka_mc.gaming_mc.interactive=!0,this.game.stavka_mc.gaming_mc._events.pointerdown||this.game.stavka_mc.gaming_mc.on("pointerdown",(()=>{this.toGame()})),root.layer0_mc.addChild(this.game),this.updateGames()}moveScroll(t){if(!this.scroll_active)return;let e=this.scroll_bounds[0]-(this.scroll_bounds[0]+this.game.stavka_mc.x-t.data.global.x);this.game.stavka_mc.scroll_mov.x=e-this.scroll_downX,e-this.scroll_downX>=this.scroll_bounds[0]+this.scroll_bounds[1]&&(this.game.stavka_mc.scroll_mov.x=this.scroll_bounds[0]+this.scroll_bounds[1]),e-this.scroll_downX<=this.scroll_bounds[0]&&(this.game.stavka_mc.scroll_mov.x=this.scroll_bounds[0]),(t.data.global.x<20||t.data.global.x>730)&&(this.scroll_active=!1),this.updateSumm()}updateSumm(){let t=Math.min(1,.01+(this.game.stavka_mc.scroll_mov.x-this.scroll_bounds[0])/this.scroll_bounds[1]);this.summ=Math.abs(Math.floor(100*t)*this.coef[this.mode]),this.game.stavka_mc.scroll_mov.tf_txt.text=this.summ.toString(),"coins"==this.mode?(this.game.stavka_mc.check_coins.visible=!0,this.game.stavka_mc.check_gold.visible=!1):"gold"==this.mode&&(this.game.stavka_mc.check_coins.visible=!1,this.game.stavka_mc.check_gold.visible=!0)}toGame(){this.first_game=!0,this.nullData(),this.summ<this.coef[this.mode]&&(this.summ=this.coef[this.mode]),TS.php("naperstki.start",{mode:this.mode,val:Math.abs(Math.floor(this.summ))},(t=>{sounds.playNap(),this.game.stavka_mc.gaming_mc.interactive=!1,achives.refresh(t.achives_level),iface.updateUp(),this.updateGames(),this.anim_interval=setInterval((()=>{clearInterval(this.anim_interval),this.game.ball.visible=!1,this.anim_interval=setInterval((()=>{clearInterval(this.anim_interval),this.randomAnim()}),1334)}),900),this.game.anim_mc.gotoAndPlay(1)}),(t=>{this.onError(t)}))}setStakan(t){let e=this.stakan=this.stakanArr.indexOf(t.currentTarget);if(!(e<0)){if(this.first_game)return Math.random()<.5&&!this.zaeb?(this.game.blow_mc.gotoAndStop(1),void(this.zaeb=1)):void TS.php("naperstki.getMoney",{stakan:e},(t=>{if(t.info.wear=t.info.wear||0,Boolean(t.info.wear)){if(shop.actionID=57,sounds.playNahodka(),this.game.search_mc.gotoAndStop("wear"),this.game.search_mc.alpha>0)return;this.game.search_mc.alpha=0,this.game.search_mc.y=550,helper.fadeAnimation(this.game.search_mc,"fadeIn",700),gsap.to(this.game.search_mc,{y:500,duration:.7,onComplete:()=>{helper.fadeAnimation(this.game.search_mc,"fadeOut",1500)}})}Boolean(t.info.win)?this.playWin(t.info.type,t.info.win_value):this.playDefeat(),achives.refresh(udata.achives_level),iface.updateUp(),this.updateGames(),this.nullData(),this.game.anim_mc.gotoAndPlay(this.endAnim[e]+1),this.game.ball.x=this.ballX[t.info.stakan],this.game.ball.visible=!0,this.game.stavka_mc.gaming_mc.interactive=!0}),(t=>{this.game.stavka_mc.gaming_mc.interactive=!0,iface.updateUp(),this.updateGames(),this.nullData(),rootClass.onError(t)}));TS.php("naperstki.bonusGame",{stakan:e},(t=>{this.game.ball.visible=this.stakanArr[e].visible=!1,this.bonus_array[e].visible=!0,this.bonus_array[e].gotoAndStop(t.win),iface.updateUp(),this.game.anim_mc.gotoAndPlay(this.endAnim[e]+1)}),rootClass.onError)}}randomAnim(){if(0==this.all&&(this.all=parseInt(6*Math.random())+1),this.my==this.all)return void this.showBlow();let t=parseInt(Math.random()*this.startAnim.length);this.anim_interval=setInterval((()=>{clearInterval(this.anim_interval),this.randomAnim()}),this.timeAnim[t]),this.game.anim_mc.gotoAndPlay(this.startAnim[t]),this.my++}showBlow(){if(!(this.game.blow_mc.alpha>0)){this.game.blow_mc.alpha<1&&helper.fadeAnimation(this.game.blow_mc,"fadeIn",300);for(let t=0;t<this.stakanArr.length;t++)this.stakanArr[t].visible=!0}}updateGames(){let t=helper.getMinigamesLevel(udata.naperstki.exp),e=0;this.game.allgames_mc.tf_txt.text="Всего игр: "+udata.naperstki.games,this.game.allgames_mc.x=10,this.game.level_mc.level_txt.text=t.toString(),e=void 0!==mlevels[t]?((udata.naperstki.exp||0)-parseInt(mlevels[t-1]))/(parseInt(mlevels[t])-parseInt(mlevels[t-1])):0,helper.scaleAnimation(this.game.level_mc.line_mc,e,300),learn.check()}nullData(){this.my=0,this.all=0,clearInterval(this.anim_interval),this.game.blow_mc.alpha>0&&helper.fadeAnimation(this.game.blow_mc,"fadeOut",300,(()=>{this.game.blow_mc.gotoAndStop(0),this.zaeb=0})),this.game.anim_mc.gotoAndStop(0);for(let t=0;t<this.stakanArr.length;t++)this.stakanArr[t].visible=!1;for(let t=0;t<this.bonus_array.length;t++)this.bonus_array[t].visible=!1;this.game.ball.visible=!0,this.game.ball.x=this.ballX[0]}onError(t){this.updateGames(),this.nullData(),this.game.anim_mc.gotoAndStop(0),this.game.ball.x=this.ballX[0],rootClass.onError(t)}playWin(t,e){this.game.win_mc.gotoAndStop(t),this.game.win_mc.price_txt.text=e,this.game.win_mc.alpha=0,this.game.win_mc.x=390,this.game.win_mc.y=600,helper.fadeAnimation(this.game.win_mc,"fadeIn",700),gsap.to(this.game.win_mc,{y:525,duration:1.2,onComplete:()=>{gsap.to(this.game.win_mc,{y:600,duration:1.5}),helper.fadeAnimation(this.game.win_mc,"fadeOut",1500)}}),sounds.playKrasava()}playDefeat(){this.game.defeat_mc.alpha=0,this.game.defeat_mc.x=390,this.game.defeat_mc.y=600,helper.fadeAnimation(this.game.defeat_mc,"fadeIn",1e3),gsap.to(this.game.defeat_mc,{y:525,duration:1,onComplete:()=>{this.randomDefeat(),gsap.to(this.game.defeat_mc,{y:600,duration:1.2}),helper.fadeAnimation(this.game.defeat_mc,"fadeOut",1500)}}),sounds.playLoshara()}randomDefeat(){let t=Math.floor(3*Math.random());for(;this.stakan==t;)t=Math.floor(3*Math.random());this.game.ball.x=this.ballX[t],this.game.ball.visible=!0,this.game.anim_mc.gotoAndStop(this.endAnim[t]),this.game.anim_mc.play()}initButtons(){setButton(this.game.stavka_mc.scroll_mov.scroll_mc),setButton(this.game.stavka_mc.gold_btn),setButton(this.game.stavka_mc.coins_btn),setButton(this.game.level_mc.butt_mc),setButton(this.game.stavka_mc.gaming_mc)}}class u{constructor(t,e,s,i){this.achives=t,this.slot=e,this.slot_down=s,this.new_achive=i,this.goanim=!1,this.mode="user",this.slots=[],this.slots_down=[],this.lvls=[],this.my_lvls=[],this.new_achives=[],this.play_achive=!1,this.category=0,this.slot_ids=[],this.wait_slots=[],this.cat_movies=[this.achives.win.cat0,this.achives.win.cat1,this.achives.win.cat2,this.achives.win.cat3,this.achives.win.cat4,this.achives.win.cat5],this.achives.interactive=!0,this.initUnics(),this.initButtons(),this.achives.win.arrows_mc.prev_bt.on("pointerdown",(()=>this.goPrev())),this.achives.win.arrows_mc.next_bt.on("pointerdown",(()=>this.goNext())),this.achives.win.close_mc.on("pointerdown",(()=>this.hideAchives()))}showAchives(){this.achives.shadow_mc.alpha=this.achives.shadow_box.alpha=0,this.achives.win.y=-600,this.achives.bg_mc.visible=!1,this.category=0;let t=0,e=0;for(let s=0;s<achives_info.info.length;s++){this.lvls[s]=this.lvls[s]||0;for(let i=0;i<achives_info.info[s].win.value.length;i++)t+=achives_info.info[s].win.value[i],this.lvls[s]>i&&(e+=achives_info.info[s].win.value[i])}this.achives.win.progress_txt.text=e+"/"+t,this.achives.win.line_mc.golden_mc.x=e/t*240-240,this.constructList(),helper.fadeAnimation(this.achives.shadow_mc,"fadeIn",300,(()=>{helper.fadeAnimation(this.achives.bg_mc,"fadeIn",1e3),gsap.to(this.achives.win,{y:51,duration:1,ease:"back.out(1.3)",onComplete:()=>{helper.fadeAnimation(this.achives.shadow_box,"fadeIn",100)}})})),root.layer1_mc.addChild(this.achives)}updateCat(){this.slot_ids=achives_info.cats[this.category];for(let t=0;t<this.cat_movies.length;t++)t==this.category?this.cat_movies[t].alpha=1:this.cat_movies[t].alpha=.5,this.cat_movies[t]._events.pointerdown||(setButton(this.cat_movies[t]),this.cat_movies[t].on("pointerdown",(e=>this.newCategory(t))))}newCategory(t){t!=this.category&&(this.category=t,this.constructList())}constructList(){for(this.updateCat(),this.achives.win.slots_mc.y=this.achives.win.slots_down_mc.y=105;this.achives.win.slots_mc.children.length;)this.achives.win.slots_mc.removeChildAt(0);for(this.slots=[];this.achives.win.slots_down_mc.children.length;)this.achives.win.slots_down_mc.removeChildAt(0);this.slots_down=[];for(let t=0;t<this.slot_ids.length;t++){let e=helper.duplicate(this.slot);this.lvls[this.slot_ids[t]]=this.lvls[this.slot_ids[t]]||0,"friend"!==this.mode?this.showUserSlot(e,this.slot_ids[t]):this.showFriendSlot(e,this.slot_ids[t]);let s=0,i=0;for(let e=0;e<achives_info.info[this.slot_ids[t]].win.value.length;e++)s+=achives_info.info[this.slot_ids[t]].win.value[e],this.lvls[this.slot_ids[t]]>e&&(i+=achives_info.info[this.slot_ids[t]].win.value[e]);e.allstar_txt.text=i,e.star_mc.color_mc.x=i/s*46-46,this.slots.push(e),e.y=e.startY=this.slots[t].endY=59*(this.slots.length-1),0!==this.slots.length&&this.achives.win.slots_mc.addChild(this.slots[this.slots.length-1])}}showUserSlot(t,e){let s=helper.duplicate(modules.names.achives["achives_ic"+e]);this.count_push=1,t.icon_mc.addChild(s),t.upper_mc.gotoAndStop(0);let i=achives_info.info[e].levels.value_show;if(t.name_txt.text=achives_info.info[e].levels.naming_rus[0],t.want_txt.text=helper.decode64(achives_info.info[e].levels.wanted[0])+" "+helper.getNumber(achives_info.info[e].levels.value[0])+" "+helper.decode64(achives_info.info[e].levels.wanted[1]),i&&(t.want_txt.text=helper.decode64(achives_info.info[e].levels.wanted[0])+" "+helper.getNumber(i[0])+" "+helper.decode64(achives_info.info[e].levels.wanted[1])),t.newstar_txt.text=achives_info.info[e].win.value[0],this.lvls[e]>0)t.progress_txt.text=achives_info.info[e].levels.value[0]+"/"+achives_info.info[e].levels.value[0],t.line_mc.golden_mc.x=0,t.check_mc.addChild(helper.duplicate(modules.unical.check));else{let s=this.getNum(achives_info.info[e].field);t.check_mc.visible=!1,t.progress_txt.text=s+"/"+achives_info.info[e].levels.value[0],t.line_mc.golden_mc.x=s/achives_info.info[e].levels.value[0]*198-198}achives_info.info[e].levels.value.length<2||(setButton(t),s.gotoAndStop(0),t.on("mouseover",(()=>t.upper_mc.alpha=1)),t.on("mouseout",(()=>t.upper_mc.alpha=0)),t.on("pointerdown",(t=>this.pushDownSlots(t.currentTarget,e))))}showFriendSlot(t,e){let s=helper.duplicate(modules.names.achives["achives_ic"+e]);s._totalFrames>1&&(this.lvls[e]-1<0?s.gotoAndStop(0):s.gotoAndStop(this.lvls[e]-1)),t.icon_mc.addChild(s);let i=achives_info.info[e].levels.value_show;if(this.lvls[e]>0)t.progress_txt.text=achives_info.info[e].levels.value[this.lvls[e]-1]+"/"+achives_info.info[e].levels.value[this.lvls[e]-1],t.line_mc.golden_mc.x=0,t.name_txt.text=achives_info.info[e].levels.naming_rus[this.lvls[e]-1],t.want_txt.text=helper.decode64(achives_info.info[e].levels.wanted[0])+" "+helper.getNumber(achives_info.info[e].levels.value[this.lvls[e]-1])+" "+helper.decode64(achives_info.info[e].levels.wanted[1]),t.newstar_txt.text=achives_info.info[e].win.value[this.lvls[e]-1],t.check_mc.addChild(helper.duplicate(modules.unical.check));else{let s=0;t.check_mc.visible=!1,t.progress_txt.text=s+"/"+achives_info.info[e].levels.value[0],t.line_mc.golden_mc.x=s/achives_info.info[e].levels.value[0]*198-198,t.name_txt.text=achives_info.info[e].levels.naming_rus[0],t.want_txt.text=helper.decode64(achives_info.info[e].levels.wanted[0])+" "+helper.getNumber(achives_info.info[e].levels.value[0])+" "+helper.decode64(achives_info.info[e].levels.wanted[1]),t.newstar_txt.text=achives_info.info[e].win.value[0]}i&&(t.want_txt.text=helper.decode64(achives_info.info[e].levels.wanted[0])+" "+helper.getNumber(i[0])+" "+helper.decode64(achives_info.info[e].levels.wanted[1]))}pushDownSlots(t,e){if(this.goanim)return;if(1==t.upper_mc.currentFrame)return this.hideDownSlots(t,e);this.goanim=!0,t.upper_mc.gotoAndStop(1);let s=this.slot_ids.indexOf(e),i=achives_info.info[e].levels.value.length;this.slots_down.length;for(let i=1;i<achives_info.info[e].levels.value.length;i++){let o=helper.duplicate(this.slot_down),a=helper.duplicate(modules.names.achives["achives_ic"+e]);a.gotoAndStop(i),o.icon_mc.addChild(a);let n=achives_info.info[e].levels.value_show;if(o.name_txt.text=achives_info.info[e].levels.naming_rus[i],o.want_txt.text=helper.decode64(achives_info.info[e].levels.wanted[0])+" "+helper.getNumber(achives_info.info[e].levels.value[i])+" "+helper.decode64(achives_info.info[e].levels.wanted[1]),n&&(o.want_txt.text=helper.decode64(achives_info.info[e].levels.wanted[0])+" "+helper.getNumber(n[i])+" "+helper.decode64(achives_info.info[e].levels.wanted[1])),o.newstar_txt.text=achives_info.info[e].win.value[i],this.lvls[e]>i)o.progress_txt.text=achives_info.info[e].levels.value[i]+"/"+achives_info.info[e].levels.value[i],o.line_mc.golden_mc.x=0,o.check_mc.addChild(helper.duplicate(modules.unical.check));else{let t=this.getNum(achives_info.info[e].field);o.check_mc.visible=!1,o.progress_txt.text=t+"/"+achives_info.info[e].levels.value[i],o.line_mc.golden_mc.x=t/achives_info.info[e].levels.value[i]*198-198}o.y=t.endY,o.alpha=0,o.slot=s,o.level=i,o.type="down",this.slots_down.push(o),this.wait_slots.push(o)}for(let t=this.slots_down.length-1;t>=0;t--)this.slots_down[t].parent||this.achives.win.slots_down_mc.addChild(this.slots_down[t]);for(let t=s+1;t<this.slots.length;t++){this.slots[t].endY=this.slots[t].y+59*(i-1),gsap.to(this.slots[t],{duration:.05*(i-1),y:this.slots[t].endY});for(let e=0;e<this.slots_down.length;e++)this.slots_down[e].slot==t&&gsap.to(this.slots_down[e],{duration:.05*(i-1),y:this.slots_down[e].y+59*(i-1)})}for(let t=0;t<this.wait_slots.length;t++){let e=this.wait_slots[t].y+59*(t+1);gsap.to(this.wait_slots[t],{duration:.05*(t+1),y:e}),helper.alphaAnimation(this.wait_slots[t],1,50*(t+1))}let o=setInterval((()=>{clearInterval(o),this.wait_slots=[],this.goanim=!1}),50*this.wait_slots.length)}hideDownSlots(t,e){if(this.goanim)return;t.upper_mc.gotoAndStop(0),this.goanim=!0;let s=this.slot_ids.indexOf(e),i=achives_info.info[e].levels.value.length;for(let t=s+1;t<this.slots.length;t++){this.slots[t].endY=this.slots[t].y-59*(i-1),gsap.to(this.slots[t],{duration:.25,y:this.slots[t].endY});for(let e=0;e<this.slots_down.length;e++)this.slots_down[e].slot==t&&gsap.to(this.slots_down[e],{duration:.25,y:this.slots_down[e].y-59*(i-1)})}let o=[];for(let e=0;e<this.slots_down.length;e++)if(this.slots_down[e].slot==s){let s=this.slots_down[e];gsap.to(this.slots_down[e],{duration:.25,y:t.endY}),helper.alphaAnimation(this.slots_down[e],0,250,(()=>s.parent.removeChild(s)))}else o.push(this.slots_down[e]);this.slots_down=o;let a=setInterval((()=>{clearInterval(a),this.goanim=!1}),250)}hideAchives(){helper.fadeAnimation(this.achives,"fadeOut",350,(()=>{this.achives.parent&&root.layer1_mc.removeChild(this.achives),this.achives.alpha=1,this.achives.visible=!0}))}goPrev(){this.goanim||105==this.achives.win.slots_mc.y||(this.goanim=!0,gsap.to(this.achives.win.slots_mc,{duration:.05,y:this.achives.win.slots_mc.y+59}),gsap.to(this.achives.win.slots_down_mc,{duration:.05,y:this.achives.win.slots_down_mc.y+59,onComplete:()=>{this.goanim=!1}}))}goNext(){this.goanim||59*achives.slots_down.length-105+this.achives.win.slots_down_mc.y+59*(this.slots.length-1)<=382||this.achives.win.slots_mc.height<=413&&!this.slots_down.length||(this.goanim=!0,gsap.to(this.achives.win.slots_mc,{duration:.05,y:this.achives.win.slots_mc.y-59}),gsap.to(this.achives.win.slots_down_mc,{duration:.05,y:this.achives.win.slots_down_mc.y-59,onComplete:()=>{this.goanim=!1}}))}playNewAchive(){if(this.play_achive||this.new_achives.length<1)return;this.play_achive=!0;let t=this.new_achives.shift(),e=helper.duplicate(this.new_achive);e.l_an.addChild(helper.duplicate(modules.unical.light));let s=modules.names.achives["achives_ic"+t[0]];for(s._totalFrames>1&&s.gotoAndStop(t[1]),console.log(t),e.alpha=0,e.x=340,e.y=600,e.name_txt.text=achives_info.info[t[0]].levels.naming_rus[t[1]];e.icon_mc.children.length;)e.icon_mc.removeChildAt(0);e.icon_mc.addChild(s),e.win_txt.text=achives_info.info[t[0]].win.value[t[1]],root.layer2_mc.addChild(e),helper.fadeAnimation(e,"fadeIn",1200),gsap.to(e,{y:525,duration:1.1,onComplete:()=>{gsap.to(e,{y:600,duration:2.5}),helper.fadeAnimation(e,"fadeOut",2500,(()=>{this.play_achive=!1,this.new_achives.length>0&&this.playNewAchive()}))}})}gN(t){let e,s=0;for(s=0;s<achives_info.info[t].win.value[0].length;s++)achives_info.info[t].win.value[0][s]>0&&(e=s);return e}refresh(t=null){t=JSON.parse(JSON.stringify(udata.achives_level));for(let e=0;e<this.my_lvls.length;e++)for(let s=0;s<parseInt(t[e])-parseInt(this.my_lvls[e]);s++)this.new_achives.push([e,parseInt(this.my_lvls[e])+s]);this.my_lvls=t,this.new_achives.length>0&&this.playNewAchive()}getNum(t){let e=t.split(" "),s=0;return s=e[1]?udata[e[0]][e[1]]||0:udata[t]||0,s}initButtons(){setButton(this.achives.win.arrows_mc.prev_bt),setButton(this.achives.win.arrows_mc.next_bt),setButton(this.achives.win.close_mc)}initUnics(){this.achives.shadow_box.addChild(helper.duplicate(modules.unical.wood_shadow)),this.achives.win.close_mc.addChild(helper.duplicate(modules.unical.close)),this.achives.win.arrows_mc.addChild(helper.duplicate(modules.unical.arrows)),this.achives.win.arrows_mc=this.achives.win.arrows_mc.children[0]}}class w{constructor(t,e){this.larek=t,this.open=e,this.movsArr=[this.larek.buttmov1_mc,this.larek.buttmov2_mc,this.larek.buttmov3_mc,this.larek.buttmov4_mc,this.larek.buttmov5_mc,this.larek.buttmov6_mc,this.larek.buttmov7_mc,this.larek.buttmov8_mc],this.goanim=!1,this.replay_butt=[this.open.win.replay_open_0_mc,this.open.win.replay_open_1_mc,this.open.win.replay_open_2_mc],this.replay_txt=[this.open.win.replay_0_txt,this.open.win.replay_1_txt,this.open.win.replay_2_txt],this.open.interactive=this.larek.bb_blow.interactive=!0,this.initButtons();for(let t=0;t<this.movsArr.length;t++)setButton(this.movsArr[t]),this.movsArr[t].on("pointerdown",(t=>this.mClick(this.movsArr.indexOf(t.currentTarget))));this.larek.buttmov7_mc.on("mouseover",(()=>helper.fadeAnimation(this.larek.blow_mc,"fadeIn"))),this.larek.buttmov7_mc.on("mouseout",(()=>helper.fadeAnimation(this.larek.blow_mc,"fadeOut"))),this.larek.big_box.on("mouseover",(()=>{helper.fadeAnimation(this.larek.bb_blow,"fadeIn"),this.bb_b=!0})),this.larek.big_box.on("mouseout",(()=>{this.bb_b=!1;let t=setInterval((()=>{clearInterval(t),this.bb_b||this.bl_b||helper.fadeAnimation(this.larek.bb_blow,"fadeOut")}),100)})),this.larek.baul_mc.on("mouseover",(()=>{helper.fadeAnimation(this.larek.baul_blow,"fadeIn")})),this.larek.baul_mc.on("mouseout",(()=>{helper.fadeAnimation(this.larek.baul_blow,"fadeOut")})),this.larek.bb_blow.on("mouseover",(()=>this.bl_b=!0)),this.larek.bb_blow.on("mouseout",(()=>{this.bl_b=!1;let t=setInterval((()=>{clearInterval(t),this.bb_b||this.bl_b||helper.fadeAnimation(this.larek.bb_blow,"fadeOut")}),100)})),this.open.win.close_mc.on("pointerdown",(()=>this.hideBox())),this.larek.bb_blow.visible=!1,helper.clickControl(this.larek.bb_blow.buy_mc,null,(()=>this.buyBox())),helper.clickControl(this.larek.big_box,null,(()=>{for(let t=0;t<this.replay_butt.length;t++)this.replay_butt[t].visible=this.replay_txt[t].visible=!1;modules.checkFlags(["coll"],(()=>{TS.php("larek.openBox",{},(t=>this.openBox(t)),rootClass.onError)}))}),(()=>this.notifyBox())),this.larek.baul_mc.on("pointerdown",(()=>modules.checkFlags(["menu","fights"],(()=>this.constrBaul()))));for(let t=0;t<this.replay_butt.length;t++)this.replay_butt[t].on("pointerdown",(()=>{root.layer1_mc.removeChild(this.open),TS.php("fights.boxKalmar",{bid:t},(t=>{udata=t.udata,this.openBox(t),fights.updateBoxKalmar()}),rootClass.onError)}))}init(){TIMERS.timers.free.init||(TIMERS.timers.free={init:!0,tick:t=>this.updFree(t)}),this.larek.blow_mc.info_txt.text="+"+(100+parseInt(udata.mandat_podgon_energy))+" халявной энергии",this.getProgressBaul(),this.bl_b=this.bb_b=!1,helper.goLocation(5),DATE.getHours()>=21||DATE.getHours()<6?this.larek.night_mc.visible=!0:this.larek.night_mc.visible=!1,this.updateBB(),this.updFree(TIMERS.dopingControl()),root.layer0_mc.addChild(this.larek),learn.check()}constrBaul(){helper.fadeAnimation(fights.box_donat.shadow_mc,"fadeIn",500,(()=>{gsap.to(fights.box_donat.panel_mc,{y:210,ease:"back.out(1.3)",duration:1,onComplete:()=>fights.box_don_goanim=!1})}));let t=udata.baul;fights.box_donat.panel_mc.slot_mc.visible=!1,fights.box_donat.panel_mc.butt_mc.visible=!1,fights.box_donat.panel_mc.no_rewards_txt.visible=!0,t.level=t.level||0,fights.box_donat.panel_mc.lvl_txt.text=t.level+" уровень",t.rewards=t.rewards||[],t.rewards.weapons&&(t.rewards=Object.assign({weapon3:t.rewards.weapons[0]},t.rewards),t.rewards=Object.assign({weapon4:t.rewards.weapons[1]},t.rewards),t.rewards=Object.assign({weapon5:t.rewards.weapons[2]},t.rewards),delete t.rewards.weapons),t.rewards.key_donat_boss&&(t.rewards["key_donat_boss_"+t.rewards.key_donat_boss.id]=t.rewards.key_donat_boss.count,delete t.rewards.key_donat_boss);let e=Object.keys(t.rewards);if(fights.box_slots)for(let t=fights.box_slots.length-1;t>=0;t--)fights.box_donat.panel_mc.removeChild(fights.box_slots[t]);if(fights.box_slots=[],this.slot_x=[30,145,260,30,145,260,30,145,260],this.slot_y=[56,58,60,115,117,119,174,176,178],e.length>0){for(let s=0;s<e.length;s++){let i=helper.duplicate(fights.box_donat_slot);i.x=this.slot_x[s],i.y=this.slot_y[s],i.reward_mc.gotoAndPlay(e[s]),i.reward_mc.gotoAndStop(e[s]),i.count_txt.text="+"+helper.shortText(t.rewards[e[s]]),"wear"==e[s]&&(i.count_txt.text="+"+helper.shortText(t.rewards[e[s]].craft[1])),"coins"==e[s]&&(i.count_txt.x=i.count_txt.x-5),fights.box_slots.push(i)}fights.box_donat.panel_mc.butt_mc.visible=!0,fights.box_donat.panel_mc.no_rewards_txt.visible=!1}for(let t=fights.box_slots.length-1;t>=0;t--)fights.box_donat.panel_mc.addChild(fights.box_slots[t]);fights.box_donat.panel_mc.butt_mc.on("pointerdown",(()=>{modules.checkFlags(["notify"],(()=>{notify.accept_fun=()=>TS.php("larek.openBaul",{},(t=>this.openBaul(t)),rootClass.onError),notify.accept.win.tf_txt.text=20,notify.accept.win.val_mc.gotoAndStop("t_coin"),notify.showAccept()}))})),fights.box_donat.blow_mc.price_conserve_txt.text="-20",root.layer1_mc.addChild(fights.box_donat)}openBaul(t){t.baul.rewards.wear&&modules.checkFlags(["menu","fights"],(()=>{fights_windows.showCraft(t.baul.rewards.wear.craft[0])})),iface.updateUp(),achives.refresh(t.achives_level),iface.showChotko(),fights.fight.box_donat_boss.visible=!1,t.baul.rewards=udata.baul.rewards=[],this.getProgressBaul(),root.layer1_mc.removeChild(fights.box_donat)}getProgressBaul(){this.larek.baul_lvl_txt.text=udata.baul.level||0;let t=udata.baul.points||0;this.larek.baul_blow.progress_mc.num_txt.text="максимум";let e=0;for(let s=0;s<=baul.levels.length;s++){if(s==baul.levels.length){this.larek.baul_blow.progress_mc.line_mc.up_mc.x=0;break}if(baul.levels[s]>t){this.larek.baul_blow.progress_mc.num_txt.text=t-e+"/"+(baul.levels[s]-e),this.larek.baul_blow.progress_mc.line_mc.up_mc.x=(t-e)/(baul.levels[s]-e)*129-139;break}e=baul.levels[s]}}buyBox(){TS.php("larek.buyBox",{},(()=>this.updateBB()),rootClass.onError)}notifyBox(){modules.checkFlags(["notify"],(()=>{notify.accept_fun=()=>this.buyBox(),notify.accept.win.tf_txt.text=15,notify.accept.win.val_mc.gotoAndStop("t_coin"),notify.showAccept()}))}openBox(t){achives.refresh(t.udata.achives_level),this.open.win.coins_txt.text=helper.shortText(t.win.coins),this.open.win.gold_txt.text=helper.shortText(t.win.gold),this.open.win.semki_txt.text=helper.shortText(t.win.semki),t.win.ebonus?this.open.win.energy_mc.gotoAndStop(1):this.open.win.energy_mc.gotoAndStop(0),t.win.wear?this.open.win.wear_mc.gotoAndStop("w"+t.win.wear):this.open.win.wear_mc.gotoAndStop(0);for(let e=1;e<6;e++){for(;this.open.win["col"+e].children.length;)this.open.win["col"+e].removeChildAt(0);let s=helper.duplicate(collections.items);s.gotoAndStop(t.win["col"+e]),this.open.win["col"+e].addChild(s)}t.udata.emax=parseInt(t.udata.emax)+parseInt(t.win.ebonus),udata=t.udata,iface.updateUp(),this.updateBB(),root.layer1_mc.addChild(this.open),t.win.cftID&&(this.open.win.wear_mc.gotoAndStop("w"+t.win.cftID),modules.checkFlags(["menu","fights"],(()=>{fights_windows.showCraft(t.win.cftID)})))}hideBox(){root.layer1_mc.removeChild(this.open)}updateBB(){let t=udata.achives_exp-50*udata.bigboxes_achives;this.larek.bb_blow.progress_mc.line_mc.up_mc.x=t/50*129-139,this.larek.bb_blow.progress_mc.num_txt.text=t+"/50",this.larek.big_box.num_txt.text=udata.bigboxes,iface.updateUp()}mClick(t){-1!=t&&(6==t&&helper.fadeAnimation(this.larek.blow_mc,"fadeOut"),TS.php("larek.buy",{id:t},(t=>{udata.energy=t.energy,udata.semki=t.semki,udata.freetime=t.freetime,udata.achives_counter=t.achives_counter,udata.achives_exp=t.achives_exp,udata.bigboxes=t.bigboxes,udata.bigboxes_achives=t.bigboxes_achives,udata.t_coin=t.t_coin,achives.refresh(t.achives_level),iface.showChotko(),iface.updateUp(),this.updFree(TIMERS.dopingControl()),learn.check()}),rootClass.onError))}updFree(t){if("max"==t.status)641!==this.movsArr[6].x&&gsap.to(this.movsArr[6],{duration:.5,x:641,ease:"power1.out"}),helper.alphaAnimation(this.larek.wait_mc,0),TIMERS.timers.free.init=!1;else{820!==this.movsArr[6].x&&gsap.to(this.movsArr[6],{duration:.5,x:820,ease:"power1.out"}),helper.alphaAnimation(this.larek.wait_mc);let e=t.time,s=parseInt(e/60),i=parseInt(s/60);e%=60,s%=60,i%=24,TIMERS.timers.free.init||(TIMERS.timers.free={init:!0,tick:t=>this.updFree(t)}),this.larek.wait_mc.tf_txt.text="Подгон через\n"+i+":"+helper.getZeros(s)+":"+helper.getZeros(e)}}initButtons(){setButton(this.larek.big_box),setButton(this.open.win.close_mc),setButton(this.larek.bb_blow.buy_mc),setButton(this.larek.baul_mc),setButton(this.open.win.replay_open_0_mc),setButton(this.open.win.replay_open_1_mc),setButton(this.open.win.replay_open_2_mc)}}class b{constructor(t){this.shron=t,this.blows=[this.shron.blow1,this.shron.blow2,this.shron.blow3,this.shron.blow4],this.movs=[this.shron.bit_mc,this.shron.pis_mc,this.shron.but_mc,this.shron.noj_mc],this.buyA=[this.shron.buy1_mc,this.shron.buy2_mc,this.shron.buy3_mc,this.shron.buy4_mc],this.have=[this.shron.my1_mc,this.shron.my2_mc,this.shron.my3_mc,this.shron.my4_mc],this.price=[this.shron.prc1,this.shron.prc2,this.shron.prc3,this.shron.prc4],this.blows_butt=[this.shron.blow_butt1,this.shron.blow_butt2,this.shron.blow_butt3,this.shron.blow_butt4],this.xx=[1,1,1,1],this.xx_obmen=[1,1,1,1],this.cntrs=[1,10,100,1e3,1e4,1e5,5e5,1e6],this.anim=!1;for(let t=0;t<iface.xxx_obmen.length;t++)iface.xxx_obmen[t].on("pointerdown",(t=>this.clickXXX(t)));for(let t=0;t<this.movs.length;t++)setButton(this.movs[t]),setButton(this.buyA[t].buy_bt),this.movs[t].on("mouseover",(t=>helper.fadeAnimation(this.blows[this.movs.indexOf(t.currentTarget)],"fadeIn"))),this.movs[t].on("mouseout",(t=>helper.fadeAnimation(this.blows[this.movs.indexOf(t.currentTarget)],"fadeOut"))),this.buyA[t].buy_bt.on("mouseover",(t=>helper.fadeAnimation(this.blows_butt[this.buyA.indexOf(t.currentTarget.parent)],"fadeIn"))),this.buyA[t].buy_bt.on("mouseout",(t=>helper.fadeAnimation(this.blows_butt[this.buyA.indexOf(t.currentTarget.parent)],"fadeOut"))),helper.clickControl(this.buyA[t].buy_bt,null,(t=>this.buyWeapon(t)),(()=>{this.active_weap=t,iface.obmen_fun=()=>this.buyWeapon(this.active_weap,!0),iface.obmen_buy_all=()=>this.buyWeaponAll(this.active_weap),this.types_weapon=this.active_weap<3?"gold":"coins",iface.obmen.win.y=-413,this.updateBuyAll(),iface.obmen_vals=[this.types_weapon,"weapon"+t],iface.obmen_by_coef=[weapons[3+t]*this.xx_obmen[t]],iface.obmen_to_coef=1*this.xx_obmen[t],iface.startObmen();for(let e=0;e<iface.xxx_obmen.length;e++)iface.xxx_obmen[e].visible=Boolean((this.xx_obmen[t]==Math.pow(10,e)||this.xx_obmen[t]==Math.pow(10,e-1))&&this.cntrs[e]==this.xx_obmen[t]||this.xx_obmen[t]==Math.pow(10,e)/2)}))}init(){helper.goLocation(6),this.xx_obmen=[1,1,1,1],this.updateStatus(),root.layer0_mc.addChild(this.shron)}clickXXX(t){if(this.anim)return;this.anim=!0;let e=this.active_weap,s=iface.xxx_obmen.indexOf(t.currentTarget);iface.xxx_obmen[s].visible=!1,7==s?(iface.xxx_obmen[0].visible=!0,this.xx_obmen[e]=this.cntrs[0]):(iface.xxx_obmen[s+1].visible=!0,this.xx_obmen[e]=this.cntrs[s+1]),iface.obmen_by_coef=[weapons[3+e]*this.xx_obmen[e]],iface.obmen_to_coef=1*this.xx_obmen[e],iface.updObmen(),this.anim=!1}updateStatus(t){t||(this.xx=[1,1,1,1]);for(let t=0;t<this.blows.length;t++){let e=0,s=0;e=udata.wear_dmg_bonus[t]||0,s=udata.mandat_dmg_bonus[t+3]||0,this.blows[t].tf_txt.text="-"+Math.ceil((parseInt(damages[t+3])+parseInt(e)+parseInt(s))*udata.damage_coef[t+3])+" xп",this.price[t].tf_txt.text=helper.shortText(weapons[3+t]*this.xx[t]),helper.numberAnimation(this.have[t].tf_txt,udata.weapons[t],100,!1)}}updateBuyAll(){iface.obmen.win.box_obmen_all.visible=iface.obmen.win.obmen_all_mc.visible=!1,"coins"==this.types_weapon?(iface.obmen.win.blow_obmen_all.blow_obmen_all_val.gotoAndStop(0),iface.obmen.win.blow_obmen_all.blow_obmen_all_min_txt.text="-"+helper.shortText(Math.floor(udata.coins/weapons[3+this.active_weap])*weapons[3+this.active_weap]),iface.obmen.win.blow_obmen_all.blow_obmen_all_plus_txt.text="+"+helper.shortText(Math.floor(udata.coins/weapons[3+this.active_weap]))):(iface.obmen.win.blow_obmen_all.blow_obmen_all_val.gotoAndStop(1),iface.obmen.win.blow_obmen_all.blow_obmen_all_min_txt.text="-"+helper.shortText(Math.floor(udata.gold/weapons[3+this.active_weap])*weapons[3+this.active_weap]),iface.obmen.win.blow_obmen_all.blow_obmen_all_plus_txt.text="+"+helper.shortText(Math.floor(udata.gold/weapons[3+this.active_weap]))),iface.obmen.win.blow_obmen_all.blow_obmen_all_weap.gotoAndStop(this.active_weap),iface.obmen.win.obmen_all_mc.on("mouseover",(t=>helper.fadeAnimation(iface.obmen.win.blow_obmen_all,"fadeIn"))),iface.obmen.win.obmen_all_mc.on("mouseout",(t=>helper.fadeAnimation(iface.obmen.win.blow_obmen_all,"fadeOut")))}buyWeapon(t,e=!1){let s=3;s=e?t:this.buyA.indexOf(t.currentTarget.parent);let i=Math.abs(this.xx[s]);e&&(i=Math.abs(this.xx_obmen[t]*iface.obmen_realvalue)),TS.php("shron.buy",{id:s,num:i},(t=>{achives.refresh(t.achives_level);let e=helper.duplicate(this.have[s].anim_mc);e.x=this.have[s].anim_mc.x,e.y=this.have[s].anim_mc.y,this.have[s].addChild(e),e.tf_txt.text="+"+i,helper.fadeAnimation(e,"fadeIn",300),gsap.to(e,{y:-20,duration:.3,onComplete:()=>{this.updateStatus(this.xx),iface.updateUp(),helper.fadeAnimation(e,"fadeOut",500),gsap.to(e,{duration:.5,onComplete:()=>{e.y=-40,this.have[s].removeChild(e)}})}}),this.updateBuyAll()}),(t=>{this.anim=!1,rootClass.onError(t)}))}buyWeaponAll(t){if(this.anim)return;this.anim=!0;let e=udata.coins;t<3&&(e=udata.gold);let s=Math.floor(parseInt(e)/parseInt(weapons[3+t]));s>0&&TS.php("shron.buy",{id:t,num:s},(e=>{achives.refresh(e.achives_level),this.have[t].anim_mc.tf_txt.text="+"+helper.shortText(s),helper.fadeAnimation(this.have[t].anim_mc,"fadeIn",300),gsap.to(this.have[t].anim_mc,{y:-20,duration:.3,onComplete:()=>{this.updateStatus(this.xx),iface.updateUp(),helper.fadeAnimation(this.have[t].anim_mc,"fadeOut",500),gsap.to(this.have[t].anim_mc,{duration:.5,onComplete:()=>{this.have[t].anim_mc.y=-40,this.anim=!1}})}}),this.updateBuyAll()}),rootClass.onError),this.anim=!1}}class f{constructor(t,e){this.shop=t,this.slot=e,this.pers=helper.duplicate(padik.padik.pers_mc),this.initButtons(),this.category=0,this.page=0,this.page_sett=0,this._checks=[0,0,0,0,1,1,1,1,1,1,0],this.myArr=[],this.showW=[],this.wears=[this.pers.wear0,this.pers.wear1,this.pers.wear2,this.pers.wear3,this.pers.wear4],this.zamena_wears=!1,this.wa={},this.actionType="",this.actionID=0,this.cat_names={summer:"Лето",winter:"Зима",spring:"Весна",autumn:"Осень"},this.weap_names=["бите","травмату","розочке","ножу-кредитке"],this.boss_modes=[" (об)"," (пац)"," (авто)"," (соло)"],this.podborka=[],this.wears_info=null,this.ves_type="price",this.types_sett="full",this.types_category="",this.trans_games="";for(let t=0;t<5;t++)helper.blowController("shop_cat"+t,[this.pers["cat"+t+"_btn"]],this.pers["cat"+t+"_mc"]),this.pers["cat"+t+"_btn"].on("pointerdown",(()=>modules.checkFlags(["menu","shop"],(()=>{this.category=t,this.types_category="cat",this.page=0,this.checks[11]=0,this.initShop("cat",[],!0)}))));this.shop.box_mc.tooltip_mc.interactive=!0,this.shop.box_mc.next_mc.on("pointerdown",(()=>this.nextPage())),this.shop.box_mc.prev_mc.on("pointerdown",(()=>this.prevPage())),this.shop.box_mc.sorting_mc.on("pointerdown",(()=>this.showFilter())),this.shop.box_mc.tooltip_mc.butt_mc.on("pointerdown",(()=>{this.page=0,this.types_sett="full",this.initShop("full")})),this.shop.box_mc.tooltip_mc.bonus_txt.on("pointerdown",(()=>this.bonusSort())),this.shop.box_mc.tooltip_mc.price_txt.on("pointerdown",(()=>this.priceSort()))}updSort(){"price"==this.ves_type?(setTextStyle(this.shop.box_mc.tooltip_mc.price_txt,{fill:"#000000"}),setTextStyle(this.shop.box_mc.tooltip_mc.bonus_txt,{fill:"#b2b2b2"})):(setTextStyle(this.shop.box_mc.tooltip_mc.bonus_txt,{fill:"#000000"}),setTextStyle(this.shop.box_mc.tooltip_mc.price_txt,{fill:"#b2b2b2"})),this.shop.box_mc.tooltip_mc.butt_mc.visible=!0}bonusSort(){this.ves_type="bonus",this.updSort()}priceSort(){this.ves_type="price",this.updSort()}nextPage(){this.page!=Math.ceil(this.podborka.length/9)-1&&(this.page++,this.initShop("custom",this.podborka))}prevPage(){0!=this.page&&(this.page--,this.initShop("custom",this.podborka))}showFilter(){if(this.shop.box_mc.tooltip_mc.visible)return this.shop.box_mc.tooltip_mc.visible=!1;this.shop.box_mc.tooltip_mc.visible=!0,this.shop.box_mc.tooltip_mc.alpha=0,helper.alphaAnimation(this.shop.box_mc.tooltip_mc,1,100);for(let t=0;t<this.checks.length;t++)this.shop.box_mc.tooltip_mc.damage_mc["check"+(t+1)].visible=Boolean(this.checks[t])}checkFilter(t){this.shop.box_mc.tooltip_mc.butt_mc.visible=!0,1==this.checks[t-1]&&this.checks[t-1]<4?this.checks[t-1]=0:this.checks[t-1]=1;for(let e=0;e<this.checks.length;e++)e!=t-1&&e<4&&t-1<4&&(this.checks[e]=0),(t-1>3&&e>3&&e<11||t-1<4)&&(this.shop.box_mc.tooltip_mc.damage_mc["check"+(e+1)].visible=Boolean(this.checks[e]))}init(t=null,e=[]){this.wa=JSON.parse(JSON.stringify(udata.mywears)),t||"cat"===this.types_category?(this.types_category="other",this.types_sett="cat"):(this.types_category="",this.category=0,this.types_sett="full",this.ves_type="price",this.updSort()),""==this.trans_games?this.page=0:this.trans_games="",helper.goLocation(7),DATE.getHours()>=21||DATE.getHours()<6?(this.shop.night_mc.visible=!0,this.shop.day_bg.visible=!1):(this.shop.night_bg.visible=!1,this.shop.day_bg.visible=!0),root.layer0_mc.addChild(this.shop),t?this.initShop(t,e):this.initShop(this.types_sett,e),this.wears=[this.pers.wear0,this.pers.wear1,this.pers.wear2,this.pers.wear3,this.pers.wear4];for(let t=0;t<this.wa.length;t++)this.wa[t]>=0&&wears.w[this.wa[t]].layer_priority&&([this.wears[wears.w[this.wa[t]].layer_priority[0]],this.wears[wears.w[this.wa[t]].layer_priority[1]]]=[this.wears[wears.w[this.wa[t]].layer_priority[1]],this.wears[wears.w[this.wa[t]].layer_priority[0]]]);this.updPers(),this.pers.parent||this.shop.pers_mc.addChild(this.pers)}initShop(t=null,e=[],s=!1){for(this.shop.box_mc.tooltip_mc.visible=this.shop.box_mc.tooltip_mc.butt_mc.visible=!1,this.createPodborka(t,e),this.showW=[[],[]];this.shop.box_mc.cont.children.length;)this.shop.box_mc.cont.removeChildAt(0);this.shop.box_mc.page_txt.text=this.page+1+"/"+Math.ceil(this.podborka.length/9),helper.alphaAnimation(this.shop.info_mc,0);for(let t=0;t<this.podborka.length-9*this.page&&t<9;t++)this.showSlot(this.podborka[t+9*this.page]);udata.shop_cat=this.category,learn.check()}initSet(t){let e=this.showW[0].indexOf(t.currentTarget.parent);console.log(e);let s=[];"custom"==this.types_sett?("cat"==this.types_category?(this.types_sett="cat",s=[],this.types_category="other"):(this.types_sett="full",s=this.getSet(this.showW[1][e])[0]),this.page=this.page_sett):(this.types_sett="custom",this.page_sett=this.page,this.page=0,s=this.getSet(this.showW[1][e])[0]),this.initShop(this.types_sett,s,!1)}showSlot(t){if(-1!==wears.blocked.indexOf(t))return;let e=parseInt(this.showW[0].length/3);this.showW[0].push(helper.duplicate(this.slot)),this.showW[1].push(t);let s=this.showW[0][this.showW[0].length-1],i=[s.butt_mc.butt,s.mini_mc,s.season_mc,s.season_mc.winter_mc,s.season_mc.spring_mc,s.season_mc.summer_mc,s.season_mc.autumn_mc,s.sett_mc,s.sett_close_mc];for(let t=0;t<i.length;t++)setButton(i[t]);s.craft_mc.visible=s.sett_close_mc.visible=s.close_mc.visible=!1,s.x=114*(this.showW[0].length-1-3*e),s.y=147*e,s.valuta_mc.gotoAndStop(wears.w[t].price[1]),"null"!==wears.w[t].price[1]&&(s.price_txt.text=helper.shortText(wears.w[t].price[0])),s.mini_mc.addChild(helper.duplicate(icon_wears[t])),s.butt_mc.visible=!1,s.butt_mc.interactive=s.butt_mc.buttonMode=!0,s.mini_mc.on("mouseover",(t=>{this.wearOver(t)})),s.mini_mc.on("mouseout",(()=>{this.wearOut()})),helper.clickControl(s.sett_mc,null,(t=>this.initSet(t))),s.season_mc.winter_mc.visible=s.season_mc.spring_mc.visible=s.season_mc.summer_mc.visible=s.season_mc.autumn_mc.visible=!1,s.season_mc.winter_mc.on("pointerdown",(t=>{this.page=0,this.trans_games="trans",this.initShop("winter",[],!0)})),s.season_mc.spring_mc.on("pointerdown",(t=>{this.page=0,this.trans_games="trans",this.initShop("spring",[],!0)})),s.season_mc.summer_mc.on("pointerdown",(t=>{this.page=0,this.trans_games="trans",this.initShop("summer",[],!0)})),s.season_mc.autumn_mc.on("pointerdown",(t=>{this.page=0,this.trans_games="trans",this.initShop("autumn",[],!0)})),s.season_mc.on("mouseover",(t=>{this.season_bool=!0,helper.alphaAnimation(s.season_blow)})),s.season_mc.on("mouseout",(t=>{this.season_bool=!1,this.season_int=setInterval((t=>{this.season_bool||helper.alphaAnimation(s.season_blow,0),clearInterval(this.season_int)}),10)})),s.sett_mc.on("mouseover",(t=>{this.sett_bool=!0,helper.alphaAnimation(s.sett_blow)})),s.sett_mc.on("mouseout",(t=>{this.sett_bool=!1,this.sett_int=setInterval((t=>{this.sett_bool||helper.alphaAnimation(s.sett_blow,0),clearInterval(this.sett_int)}),10)})),this.statusButt(t),this.shop.box_mc.cont.addChild(this.showW[0][this.showW[0].length-1])}statusButt(t){let e=wears.w[t].wanted[0],s=helper.getLevel(udata.exp),i=wears.w[t].dmg[0].split("/"),o=this.showW[0][this.showW[0].length-1];"null"==i[0]&&(o.season_mc.visible=!1),"null"!==i[0]&&1==i.length&&(o.season_mc[i[0]+"_mc"].visible=!0,o.season_blow.tf_txt.text=this.cat_names[i[0]]);let a=this.getSet(t);if(o.sett_blow.sett_name_blow.text="Сет: "+a[1],o.sett_blow.sett_count_blow.text="Шмотки: "+a[2]+"/"+a[3],2==i.length){o.season_blow.tf_txt.text=this.cat_names[i[0]]+"/"+this.cat_names[i[1]];for(let t=0;t<i.length;t++)o.season_mc[i[t]+"_mc"].visible=!0,0==t&&(o.season_mc.masker=new PIXI.Graphics,o.season_mc.addChild(o.season_mc.masker),o.season_mc.masker.beginFill(0),o.season_mc.masker.drawRect(15,0,15,30),o.season_mc.masker.endFill(),o.season_mc[i[t]+"_mc"].mask=o.season_mc.masker)}if(4==i.length){o.season_blow.tf_txt.text="Демисезон",o.season_mc.masker=[];for(let t=0;t<i.length;t++)o.season_mc[i[t]+"_mc"].visible=!0,o.season_mc.masker[t]=new PIXI.Graphics,o.season_mc.addChild(o.season_mc.masker[t]),o.season_mc.masker[t].beginFill(0),o.season_mc.masker[t].drawRect(t%2*15,15*Math.floor(t/2),15,15),o.season_mc.masker[t].endFill(),o.season_mc[i[t]+"_mc"].mask=o.season_mc.masker[t]}if(-1!=udata.buying.indexOf(t)||-1!=udata.mywears.indexOf(t)||"null"!=wears.w[t].price[1]){if("level"==e&&s<wears.w[t].wanted[1])return this.closeSlot(t,e,s);o.butt_mc.gotoAndStop(0),o.butt_mc.visible=!0,-1==udata.buying.indexOf(t)&&-1==udata.mywears.indexOf(t)?(this.showW[0][this.showW[0].length-1].butt_mc.gotoAndStop(0),o.butt_mc.on("pointerdown",(t=>{let e=this.showW[0].indexOf(t.currentTarget.parent);this.actionType="buy",this.actionID=this.showW[1][e],TS.php("shop.buy",{id:this.actionID},(t=>{this.completeAction(t),modules.checkFlags(["notify"],(()=>notify.showBuy()))}),rootClass.onError)})),o.butt_mc.butt.on("mouseover",(t=>{let e=this.showW[0].indexOf(t.currentTarget.parent.parent);this.showW[0][e].butt_mc.gotoAndStop(1)})),o.butt_mc.butt.on("mouseout",(t=>{let e=this.showW[0].indexOf(t.currentTarget.parent.parent);-1!=e&&this.showW[0][e].butt_mc.gotoAndStop(0)}))):o.price_txt.visible=o.valuta_mc.visible=!1,-1!==udata.buying.indexOf(t)&&-1==udata.mywears.indexOf(t)&&(o.butt_mc.gotoAndStop(2),o.butt_mc.on("pointerdown",(t=>{let e=this.showW[0].indexOf(t.currentTarget.parent);this.actionType="odet",this.actionID=this.showW[1][e],TS.php("shop.putOn",{id:this.actionID},(t=>{this.completeAction(t)}),rootClass.onError)})),o.butt_mc.butt.on("mouseover",(t=>{this.showW[0][this.showW[0].indexOf(t.currentTarget.parent.parent)].butt_mc.gotoAndStop(3)})),o.butt_mc.butt.on("mouseout",(t=>{-1!==this.showW[0].indexOf(t.currentTarget.parent.parent)&&this.showW[0][this.showW[0].indexOf(t.currentTarget.parent.parent)].butt_mc.gotoAndStop(2)}))),-1!==udata.mywears.indexOf(t)&&(o.butt_mc.gotoAndStop(4),o.butt_mc.on("pointerdown",(t=>{let e=this.showW[0].indexOf(t.currentTarget.parent);this.actionType="snat",this.actionID=this.showW[1][e],TS.php("shop.putOff",{id:this.actionID},(t=>this.completeAction(t)),rootClass.onError)})),o.butt_mc.butt.on("mouseover",(t=>{this.showW[0][this.showW[0].indexOf(t.currentTarget.parent.parent)].butt_mc.gotoAndStop(5)})),o.butt_mc.butt.on("mouseout",(t=>{-1!==this.showW[0].indexOf(t.currentTarget.parent.parent)&&this.showW[0][this.showW[0].indexOf(t.currentTarget.parent.parent)].butt_mc.gotoAndStop(4)})))}else this.closeSlot(t,e)}closeSlot(t,e,s=null){let i=this.showW[0][this.showW[0].length-1];if(i.close_mc.visible=!0,i.sett_close_mc.visible=!0,i.sett_close_mc.on("mouseover",(t=>{this.sett_bool=!0,helper.alphaAnimation(i.sett_blow)})),i.sett_close_mc.on("mouseout",(t=>{this.sett_bool=!1,this.sett_int=setInterval((t=>{this.sett_bool||helper.alphaAnimation(i.sett_blow,0),clearInterval(this.sett_int)}),10)})),-1!=["boss","craft","box_don_craft","shmon","top_kalmar","baul","box_craft_kalmar","23february","naperstki_craft","knb_craft"].indexOf(e)&&(i.close_mc.text_txt.text="Падает с босса","shmon"==e&&(i.close_mc.text_txt.text="Может выпасть\n со шмона друзей"),"top_kalmar"==e&&(i.close_mc.text_txt.text="Может выпасть\n за топ Кальмара"),"box_craft_kalmar"==e&&(i.close_mc.text_txt.text="Может выпасть\n c сумки Кальмара\n"+this.boss_modes[wears.w[t].wanted[2]]),"23february"==e&&(i.close_mc.text_txt.text="Может выпасть на 23 февраля"),"boss"!=e)){let e=JSON.parse(JSON.stringify(udata.craft));e[t]=e[t]||0,i.craft_mc.visible=!0,i.season_mc.visible=!1,i.craft_mc.num_txt.text=e[t]+"/"+wears.w[t].wanted[1]}switch(e){case"boss":case"craft":case"box_don_craft":helper.clickControl(i.sett_close_mc,null,(t=>this.initSet(t))),helper.clickControl(i.mini_mc,null,(()=>main_menu.checkStatusBoss()));break;case"level":i.close_mc.text_txt.text="Доступно с "+wears.w[t].wanted[1]+" уровня",helper.clickControl(i.mini_mc,null,(()=>{main_menu.toCity(),this.page_sett=this.page,this.trans_games="trans"})),helper.clickControl(i.sett_close_mc,null,(t=>this.initSet(t)));break;case"sale":i.close_mc.text_txt.text="Акционный предмет",helper.clickControl(i.sett_close_mc,null,(t=>this.initSet(t)));break;case"work":i.close_mc.text_txt.text="Можно найти на работках",helper.clickControl(i.mini_mc,null,(()=>{modules.checkFlags(["city"],(()=>{city.toWorks(0)})),this.page_sett=this.page,this.trans_games="trans"})),helper.clickControl(i.sett_close_mc,null,(t=>this.initSet(t)));break;case"naperstki":i.close_mc.text_txt.text="Можно выиграть в наперстках",helper.clickControl(i.mini_mc,null,(()=>{main_menu.toNaperstki(),this.page_sett=this.page,this.trans_games="trans"})),helper.clickControl(i.sett_close_mc,null,(t=>this.initSet(t)));break;case"rayon":i.close_mc.text_txt.text="Можно найти на районе",helper.clickControl(i.mini_mc,null,(()=>{main_menu.toCity(),this.page_sett=this.page,this.trans_games="trans"})),helper.clickControl(i.sett_close_mc,null,(t=>this.initSet(t)));break;case"bigboxes":i.close_mc.text_txt.text="Может выпасть с коробки мечты",helper.clickControl(i.mini_mc,null,(()=>{main_menu.toDoping(),this.page_sett=this.page,this.trans_games="trans"})),helper.clickControl(i.sett_close_mc,null,(t=>this.initSet(t)));break;case"slots":i.close_mc.text_txt.text="Может выпасть\nсо слотов",helper.clickControl(i.mini_mc,null,(()=>{modules.checkFlags(["menu"],(()=>{main_menu.toSlots(),this.page_sett=this.page,this.trans_games="trans"}))})),helper.clickControl(i.sett_close_mc,null,(t=>this.initSet(t)));break;case"combo":i.close_mc.text_txt.text="Может выпасть\n с комбо",helper.clickControl(i.mini_mc,null,(()=>{main_menu.checkStatusBoss(),this.trans_games="trans"})),helper.clickControl(i.sett_close_mc,null,(t=>this.initSet(t)));break;case"halloween":i.close_mc.text_txt.text="Может выпасть\n с тыквы",helper.clickControl(i.mini_mc,null,(()=>{main_menu.toDoping(),this.page_sett=this.page,this.trans_games="trans"})),helper.clickControl(i.sett_close_mc,null,(t=>this.initSet(t)));break;case"newyear_snow_box":case"newyear_donat_box":i.close_mc.text_txt.text="Событие\n уже закончилось",helper.clickControl(i.sett_close_mc,null,(t=>this.initSet(t))),helper.clickControl(i.mini_mc,null,(()=>main_menu.showNewYearWindow()));break;case"box_kalmar":i.close_mc.text_txt.text="Может выпасть\n с сумки на Кальмаре \n"+this.boss_modes[wears.w[t].wanted[1]],helper.clickControl(i.sett_close_mc,null,(t=>this.initSet(t))),helper.clickControl(i.mini_mc,null,(()=>iface.initKalmar(kalmar)));break;case"baul":i.close_mc.text_txt.text="Может выпасть\n с накопительной сумки Баул",helper.clickControl(i.sett_close_mc,null,(t=>this.initSet(t))),helper.clickControl(i.mini_mc,null,(()=>main_menu.toDoping()));break;case"naperstki_craft":i.close_mc.text_txt.text="Может выпасть с наперстков",helper.clickControl(i.mini_mc,null,(()=>{main_menu.toNaperstki(),this.page_sett=this.page,this.trans_games="trans"})),helper.clickControl(i.sett_close_mc,null,(t=>this.initSet(t)));break;case"knb_craft":i.close_mc.text_txt.text="Может выпасть с КНБ",helper.clickControl(i.mini_mc,null,(()=>{main_menu.toKNB(),this.page_sett=this.page,this.trans_games="trans"})),helper.clickControl(i.sett_close_mc,null,(t=>this.initSet(t)));break;default:helper.clickControl(i.sett_close_mc,null,(t=>this.initSet(t)))}}completeAction(t){achives.refresh(),this.wa=JSON.parse(JSON.stringify(t.mywears)),iface.updateUp(),this.initShop("custom",this.podborka),this.wears=[this.pers.wear0,this.pers.wear1,this.pers.wear2,this.pers.wear3,this.pers.wear4];for(let t=0;t<this.wa.length;t++)this.wa[t]>=0&&wears.w[this.wa[t]].layer_priority&&([this.wears[wears.w[this.wa[t]].layer_priority[0]],this.wears[wears.w[this.wa[t]].layer_priority[1]]]=[this.wears[wears.w[this.wa[t]].layer_priority[1]],this.wears[wears.w[this.wa[t]].layer_priority[0]]]);this.updPers()}countVes(t){return t=this.filterIds(t),"price"==this.ves_type?this.countVesPrice(t):this.countVesBonus(t)}filterIds(t){let e=this.checkTypePodborka(),s=[],i=!1,o=!1,a=e[0]<5?e[0]:0,n=e.indexOf(11);0==e.length&&(e=[999]);for(let h=0;h<t.length;h++){let l=wears.w[t[h]].dmg;for(let r=0;r<e.length;r++){let m=e[r];if(i=m>0&&!i?"true":"false",o=!1,5==m?o=!0:6!=m||"boss"!=wears.w[t[h]].wanted[0]&&"craft"!=wears.w[t[h]].wanted[0]?(7==m&&"craft"==wears.w[t[h]].wanted[0]||8==m&&"combo"==wears.w[t[h]].wanted[0]||9==m&&"bigboxes"==wears.w[t[h]].wanted[0]||10==m&&"slots"==wears.w[t[h]].wanted[0])&&(o=!0):o=!0,-1!==n&&-1==udata.buying.indexOf(t[h])&&(o=!1),o&&(0==a||parseInt(l[a])>0)){(-1!==l[0].split("/").indexOf(SEASON)||m>4&&m<11)&&s.push(t[h]),i=!0;break}}}return i||(s=t),s}countVesPrice(t){this.wears_info=[];let e={coins:1,gold:12,null:1e6};for(let s=0;s<t.length;s++)this.wears_info.push(JSON.parse(JSON.stringify(wears.w[t[s]]))),this.wears_info[this.wears_info.length-1].ves=parseInt(this.wears_info[s].price[0])*e[this.wears_info[s].price[1]];this.wears_info=sortOn(this.wears_info,"ves",Array.NUMERIC),t=[];for(let e=0;e<this.wears_info.length;e++)t.push(this.wears_info[e].id);return t}countVesBonus(t){this.wears_info=[];for(let e=0;e<t.length;e++){this.wears_info.push(JSON.parse(JSON.stringify(wears.w[t[e]])));let s=this.wears_info[e].dmg,i=!1;-1!==s[0].split("/").indexOf(SEASON)&&(parseInt(s[1])>0&&(this.wears_info[this.wears_info.length-1].ves=s[1]),i=!0,parseInt(s[2])>0&&(this.wears_info[this.wears_info.length-1].ves=s[2]),i=!0,parseInt(s[3])>0&&(this.wears_info[this.wears_info.length-1].ves=s[3]),i=!0,parseInt(s[4])>0&&(this.wears_info[this.wears_info.length-1].ves=s[4]),i=!0),i||(this.wears_info[this.wears_info.length-1].ves=0)}this.wears_info=sortOn(this.wears_info,"ves",Array.NUMERIC),t=[];for(let e=0;e<this.wears_info.length;e++)t.push(this.wears_info[e].id);return t}checkType(){let t=0;for(let e=0;e<this.checks.length;e++)Boolean(this.checks[e])&&(t=e+1);return t}checkTypePodborka(){let t=[];for(let e=0;e<this.checks.length;e++)Boolean(this.checks[e])&&t.push(e+1);return t}createPodborka(t=null,e=[]){if(this.podborka=[],"cat"==t&&(this.podborka=JSON.parse(JSON.stringify(wears.categories[this.category]))),"winter"==t||"spring"==t||"summer"==t||"autumn"==t)for(let e=0;e<wears.w.length;e++)-1!==wears.w[e].dmg[0].split("/").indexOf(t)&&this.podborka.push(wears.w[e].id);if("custom"==t&&(this.podborka=e),"full"==t)for(let t=0;t<wears.w.length;t++)this.podborka.push(wears.w[t].id);this.podborka=this.countVes(this.podborka)}updPers(){for(let t=0;t<this.wa.length;t++){for(;this.wears[t].children.length;)this.wears[t].removeChildAt(0);-1==this.wa[t]?this.wears[t].addChild(helper.duplicate(stock_wears[t])):this.wears[t].addChild(helper.duplicate(shop_wears[this.wa[t]]))}}goToSet(t){let e=this.showW[0].indexOf(t.currentTarget.parent);this.page=0,this.initShop("custom",this.getSet(this.showW[1][e])[0],!0)}wearOver(t){this.my_slot=this.showW[0].indexOf(t.currentTarget.parent);let e=this.showW[1][this.my_slot],s=wears.w[e].wanted,i=wears.w[e].dmg[0].split("/"),o=t.data.global,a=this.getSet(e);if(this.wa[this.getCat(e)]=e,"staff"!=wears.w[e].brand?this.shop.info_mc.brand_mc.visible=!1:this.shop.info_mc.brand_mc.visible=!0,this.shop.info_mc.name_txt.text=helper.decode64(wears.w[e].name[0]),this.shop.info_mc.tf_txt.text=helper.decode64(wears.w[e].name[1]),wears.w[e].price[2]>0?this.shop.info_mc.exp_txt.text="+"+wears.w[e].price[2]+" авторитета":this.shop.info_mc.exp_txt.text="нет бонуса",this.shop.info_mc.tf_txt.text+="\nСет "+helper.decode64(a[1])+" ("+a[2]+"/"+a[0].length+")","null"!==i[0]&&-1!==i.indexOf(SEASON))for(let t=0;t<this.weap_names.length;t++)wears.w[e].dmg[t+1]>0&&(this.shop.info_mc.dmg_txt.text="+"+wears.w[e].dmg[t+1]+" к "+this.weap_names[t]);else this.shop.info_mc.dmg_txt.text="нет бонуса к урону";"boss"==s[0]&&(this.shop.info_mc.wanted_txt.text="Может выпасть с босса: "+helper.decode64(bosses[s[1]].name)+this.boss_modes[s[2]]),"craft"==s[0]&&(s[2]?this.shop.info_mc.wanted_txt.text="Падает в бою с боссом: "+helper.decode64(bosses[s[2]].name)+this.boss_modes[s[3]]:this.shop.info_mc.wanted_txt.text="Может выпасть с любого босса"),"level"==s[0]&&(this.shop.info_mc.wanted_txt.text="Необходим "+s[1]+" уровень"),"sale"==s[0]&&(this.shop.info_mc.wanted_txt.text="Можно выиграть в розыгрышах"),"naperstki"==s[0]&&(this.shop.info_mc.wanted_txt.text="Можно выиграть в наперстках"),"rayon"==s[0]&&(this.shop.info_mc.wanted_txt.text="Можно найти на районе: "+helper.decode64(locs.l[s[1]].name)),"bigboxes"==s[0]&&(this.shop.info_mc.wanted_txt.text="Может выпасть с коробки мечты"),"slots"==s[0]&&(this.shop.info_mc.wanted_txt.text="Может выпасть со слотмашины"),"combo"==s[0]&&(this.shop.info_mc.wanted_txt.text="Может выпасть с комбо"),"work"==s[0]&&(this.shop.info_mc.wanted_txt.text="Можно найти на работках"),"halloween"==s[0]&&(this.shop.info_mc.wanted_txt.text="Может выпасть с тыквы c cюрпризом"),"box_don_craft"==s[0]&&(this.shop.info_mc.wanted_txt.text="Может выпасть c сумки: "+helper.decode64(bosses[s[2]].name)+this.boss_modes[s[3]]),"newyear_snow_box"==s[0]&&(this.shop.info_mc.wanted_txt.text="Может выпасть c подарка за снег"),"newyear_donat_box"==s[0]&&(this.shop.info_mc.wanted_txt.text="Может выпасть c подарка за консервы"),"shmon"==s[0]&&(this.shop.info_mc.wanted_txt.text="Может выпасть со шмона друзей"),"top_kalmar"==s[0]&&(this.shop.info_mc.wanted_txt.text="Может выпасть за топ Кальмара"),"box_kalmar"==s[0]&&(this.shop.info_mc.wanted_txt.text="С сумки на Кальмаре"+this.boss_modes[wears.w[e].wanted[1]]),"baul"==s[0]&&(this.shop.info_mc.wanted_txt.text="Может выпасть c Баула"),"box_craft_kalmar"==s[0]&&(this.shop.info_mc.wanted_txt.text="С сумки на Кальмаре"+this.boss_modes[wears.w[e].wanted[2]]),"23february"==s[0]&&(this.shop.info_mc.wanted_txt.text="Может выпасть на 23 февраля"),"naperstki_craft"==s[0]&&(this.shop.info_mc.wanted_txt.text="Может выпасть c наперстков"),"knb_craft"==s[0]&&(this.shop.info_mc.wanted_txt.text="Может выпасть c КНБ"),this.slot_bool=!0,helper.alphaAnimation(this.shop.info_mc),this.shop.info_mc.x=o.x+10,this.shop.info_mc.y=Math.min(o.y,425),this.wears=[this.pers.wear0,this.pers.wear1,this.pers.wear2,this.pers.wear3,this.pers.wear4];for(let t=0;t<this.wa.length;t++)this.wa[t]>=0&&wears.w[this.wa[t]].layer_priority&&([this.wears[wears.w[this.wa[t]].layer_priority[0]],this.wears[wears.w[this.wa[t]].layer_priority[1]]]=[this.wears[wears.w[this.wa[t]].layer_priority[1]],this.wears[wears.w[this.wa[t]].layer_priority[0]]]);this.updPers()}wearOut(){this.wa=JSON.parse(JSON.stringify(udata.mywears)),this.wa[4]=this.wa[4]||-1,this.slot_bool=!1,this.slot_int=setInterval((t=>{this.slot_bool||helper.alphaAnimation(this.shop.info_mc,0),clearInterval(this.slot_int)}),10),this.wears=[this.pers.wear0,this.pers.wear1,this.pers.wear2,this.pers.wear3,this.pers.wear4];for(let t=0;t<this.wa.length;t++)this.wa[t]>=0&&wears.w[this.wa[t]].layer_priority&&([this.wears[wears.w[this.wa[t]].layer_priority[0]],this.wears[wears.w[this.wa[t]].layer_priority[1]]]=[this.wears[wears.w[this.wa[t]].layer_priority[1]],this.wears[wears.w[this.wa[t]].layer_priority[0]]]);this.updPers()}getCat(t){for(let e=0;e<wears.categories.length;e++)if(wears.categories[e].indexOf(t)>=0)return e}getSet(t){let e=0,s=JSON.parse(JSON.stringify(udata.buying));for(let i=0;i<wears.sets.ids.length;i++)if(wears.sets.ids[i].indexOf(t)>=0){let t=wears.sets.ids[i].length;for(let o=0;o<t;o++)s.indexOf(wears.sets.ids[i][o])>=0&&e++;return[wears.sets.ids[i],wears.sets.names[i],e,t]}}initButtons(){setButton(this.shop.box_mc.prev_mc),setButton(this.shop.box_mc.next_mc),setButton(this.shop.box_mc.sorting_mc),setButton(this.shop.box_mc.tooltip_mc.butt_mc),setButton(this.shop.box_mc.tooltip_mc.bonus_txt),setButton(this.shop.box_mc.tooltip_mc.price_txt),setButton(this.pers.cat0_btn),setButton(this.pers.cat1_btn),setButton(this.pers.cat2_btn),setButton(this.pers.cat3_btn),setButton(this.pers.cat4_btn);for(let t=1;t<12;t++)setButton(this.shop.box_mc.tooltip_mc.damage_mc["chb"+t]),this.shop.box_mc.tooltip_mc.damage_mc["chb"+t].on("pointerdown",(()=>this.checkFilter(t)))}}class g{constructor(t){this.flower=t,this.konopka_array=[this.flower.tree_mc.tree.kon1,this.flower.tree_mc.tree.kon2,this.flower.tree_mc.tree.kon3,this.flower.tree_mc.tree.kon4,this.flower.tree_mc.tree.kon5,this.flower.tree_mc.tree.kon6,this.flower.tree_mc.tree.kon7,this.flower.tree_mc.tree.kon8,this.flower.tree_mc.tree.kon9],this.poliv_anim=!1,this.top_page=0,this.initButtons(),this.flower.trash_btn.on("pointerdown",(()=>TS.php("flower.trash",{},(()=>this.trashFlower()),rootClass.onError))),helper.clickControl(this.flower.alive_btn,null,(()=>this.notifyAlive()),(()=>this.flowerAlive())),this.flower.posadka_btn.on("pointerdown",(()=>TS.php("flower.start",{},(t=>this.posadkaFlower(t)),rootClass.onError))),this.flower.leica_big.on("pointerdown",(()=>TS.php("flower.poliv",{},(t=>{helper.alphaAnimation(this.flower.action_blow,0,300),this.poliv_anim||this.polivFlower(t)}),rootClass.onError))),this.flower.leica_big.on("mouseover",(()=>{this.poliv_anim||helper.alphaAnimation(this.flower.action_blow,1,300)})),this.flower.leica_big.on("mouseout",(()=>helper.alphaAnimation(this.flower.action_blow,0,300))),this.flower.leica_icon.on("mouseover",(()=>helper.alphaAnimation(this.flower.buy_blow,1,300))),this.flower.leica_icon.on("mouseout",(()=>helper.alphaAnimation(this.flower.buy_blow,0,300))),helper.clickControl(this.flower.leica_icon,null,(()=>{TS.php("flower.buyChifir",{id:1},(t=>this.plusChifir(t)),(t=>rootClass.onError(t)))}),(()=>{iface.obmen_fun=()=>TS.php("flower.buyChifir",{id:Math.abs(iface.obmen_realvalue)},(t=>this.plusChifir(t)),(t=>rootClass.onError(t))),iface.obmen.win.box_obmen_all.visible=iface.obmen.win.obmen_all_mc.visible=!1,iface.obmen_vals=["gold","semki","chifir"],iface.obmen_by_coef=[100,12],iface.obmen_to_coef=1,iface.startObmen()})),this.flower.padick_mc.on("pointerdown",(()=>iface.goGuest(flower_top[this.top_page].id))),this.flower.prev_btn.on("pointerdown",(()=>this.prevTop())),this.flower.next_btn.on("pointerdown",(()=>this.nextTop())),helper.blowController("flower_alive",[this.flower.alive_btn],this.flower.alive_blow)}flowerAlive(){TS.php("flower.alive",{},(()=>this.trashFlower()),rootClass.onError)}notifyAlive(){modules.checkFlags(["notify"],(()=>{notify.accept_fun=()=>this.flowerAlive(),notify.accept.win.tf_txt.text=50,notify.accept.win.val_mc.gotoAndStop("t_coin"),notify.showAccept()}))}init(){helper.goLocation(13),this.top_page=0,this.flower.trash_txt.text="",this.updateFlower(),this.constructTop(),this.flower.buy_blow.tf_txt.text="-"+udata.flower_chifir_price,root.layer0_mc.addChild(this.flower)}prevTop(){0!=this.top_page&&(this.top_page--,this.constructTop())}nextTop(){this.top_page!=flower_top.length-1&&(this.top_page++,this.constructTop())}constructTop(){if(this.flower.padick_mc.visible=this.flower.prev_btn.visible=this.flower.next_btn.visible=!0,!window.flower_top||window.flower_top.error||window.flower_top.length<1)return this.flower.name_txt.text=helper.decode64(udata.name),this.flower.tf_txt.text="Рейтинг лучших садоводов ещё пуст. И именно ты можешь завоевать первое место тут! Поторопись и не забывай регулярно поливать своё растение! Удачи...",this.flower.topvalue_txt.text=this.flower.mysm_txt.text,this.flower.padick_mc.visible=this.flower.prev_btn.visible=this.flower.next_btn.visible=!1,void helper.loadPhoto200(vk_params.viewer_id,(t=>this.flower.photo_mc.addChild(t)));1==flower_top.length&&(this.flower.prev_btn.visible=this.flower.next_btn.visible=!1),this.top_page==window.flower_top.length-1&&(this.flower.next_btn.visible=!1),0==this.top_page&&(this.flower.prev_btn.visible=!1);let t=TIME-flower_top[this.top_page].flower_start,e=parseInt(t/60),s=parseInt(e/60),i=parseInt(s/24),o=flower_top[this.top_page].flower_win;this.flower.name_txt.text=helper.decode64(flower_top[this.top_page].name),this.flower.tf_txt.text="Занимает в топе "+(this.top_page+1)+" место. Начал заниматься бизнесом "+i+" "+helper.numberEndFlower(i,"days")+" назад. Не пропускал поливов и получил уже "+helper.shortText(o[0])+" "+helper.numberEndFlower(o[0],"bita")+", "+helper.shortText(o[1])+" "+helper.numberEndFlower(o[1],"travmat")+", "+helper.shortText(o[2])+" "+helper.numberEndFlower(o[2],"roza")+" и "+helper.shortText(o[3])+" "+helper.numberEndFlower(o[3],"gold")+"!",this.flower.topvalue_txt.text=flower_top[this.top_page].flower_size+" см",helper.loadPhoto200(flower_top[this.top_page].id,(t=>this.flower.photo_mc.addChild(t)),flower_top[this.top_page].photo)}tickFlower(t){if("max"==t.status)return this.flower.action_blow.tf_txt.text="Поливать",void(garage.garage.flowers_blow.tf_txt.text="Можно полить");this.flower.action_blow.tf_txt.text=garage.garage.flowers_blow.tf_txt.text=helper.timeString(t.time)}updTrash(t){"max"==t.status?(this.flower.trash_txt.text="",TIMERS.timers.free.init=!1):(TIMERS.timers.free.init||(TIMERS.timers["екфыр"]={init:!0,tick:t=>this.updTrash(t)}),this.flower.trash_txt.text="Высохнет через: "+helper.timeString(t.time))}updateFlower(){let t=Math.min(100,Math.floor(udata.flower_size/60*100));if(TIMERS.timers.trash.init||(TIMERS.timers.trash={init:!0,tick:t=>this.updTrash(t)}),udata.flower_size<60&&1==this.konopka_array[8].scale.x)for(let t=0;t<this.konopka_array.length;t++)this.konopka_array[t].scale.x=this.konopka_array[t].scale.y=0;if(udata.flower_size>=12){let t=Math.min(1,(udata.flower_size-12)/14);gsap.to(this.konopka_array[1].scale,{duration:.3,x:t,y:t})}if(udata.flower_size>=14){let t=Math.min(1,(udata.flower_size-14)/16);gsap.to(this.konopka_array[0].scale,{duration:.3,x:t,y:t})}if(udata.flower_size>=25){let t=Math.min(1,(udata.flower_size-25)/14);gsap.to(this.konopka_array[3].scale,{duration:.3,x:t,y:t})}if(udata.flower_size>=28){let t=Math.min(1,(udata.flower_size-28)/17);gsap.to(this.konopka_array[2].scale,{duration:.3,x:t,y:t})}if(udata.flower_size>=39){let t=Math.min(1,(udata.flower_size-39)/11);gsap.to(this.konopka_array[5].scale,{duration:.3,x:t,y:t})}if(udata.flower_size>=41){let t=Math.min(1,(udata.flower_size-41)/11);gsap.to(this.konopka_array[4].scale,{duration:.3,x:t,y:t})}if(udata.flower_size>=50){let t=Math.min(1,(udata.flower_size-50)/7);gsap.to(this.konopka_array[6].scale,{duration:.3,x:t,y:t}),gsap.to(this.konopka_array[7].scale,{duration:.3,x:t,y:t})}if(udata.flower_size>=54){let t=Math.min(1,(udata.flower_size-54)/6);gsap.to(this.konopka_array[8].scale,{duration:.3,x:t,y:t})}udata.flower_size<=60?gsap.to(this.flower.tree_mc.tree.stebel.scale,{duration:.3,x:t/100*1.8,y:t/100*1.8}):this.poliv_anim&&gsap.to(this.flower.tree_mc.tree.scale,{duration:.3,x:1.05,y:1.05,onComplete:()=>{gsap.to(this.flower.tree_mc.tree.scale,{duration:.3,x:1,y:1})}}),this.poliv_anim=!1,this.flower.mysm_txt.text=udata.flower_size+" см",this.flower.chifir_txt.text=udata.flower_chifir,this.statusFlower()}statusFlower(){0==udata.flower_start?(this.flower.leica_big.visible=this.flower.trash_btn.visible=this.flower.alive_btn.visible=!1,this.flower.posadka_btn.visible=!0,this.flower.tree_mc.alpha=1):udata.flower_start>0&&(TIME-udata.flower_time<udata.flower_lifetime||0==udata.flower_time)?(this.flower.posadka_btn.visible=this.flower.trash_btn.visible=this.flower.alive_btn.visible=!1,this.flower.leica_big.visible=!0,this.flower.tree_mc.alpha=1):(this.flower.posadka_btn.visible=this.flower.leica_big.visible=!1,this.flower.trash_btn.visible=this.flower.alive_btn.visible=!0,this.flower.tree_mc.alpha=.8)}trashFlower(){achives.refresh(),this.flower.tree_mc.alpha=1,this.flower.alive_blow.visible=!1,iface.updateUp(),this.updateFlower()}posadkaFlower(t){udata.flower_start=t.flower_start,udata.flower_size=t.flower_size,udata.flower_time=t.flower_time,this.flower.leica_big.alpha=0,helper.fadeAnimation(this.flower.leica_big,"fadeIn",600),this.flower.semka_mc.y=276,helper.fadeAnimation(this.flower.semka_mc,"fadeIn",200,(()=>{gsap.to(this.flower.semka_mc,{duration:.5,y:440,onComplete:()=>{helper.fadeAnimation(this.flower.semka_mc,"fadeOut",700),this.updateFlower()}})}))}polivFlower(t){achives.refresh(),this.poliv_anim=!0,gsap.to(this.flower.leica_big,{duration:.7,x:193,y:300,rotation:Math.PI/180*-45,ease:"back.out(1.1)",onComplete:()=>{helper.fadeAnimation(this.flower.drop1,"fadeIn",300),helper.fadeAnimation(this.flower.drop2,"fadeIn",300),helper.fadeAnimation(this.flower.drop3,"fadeIn",300),gsap.to(this.flower.drop3,{duration:.4,y:434,onComplete:()=>{helper.fadeAnimation(this.flower.drop3,"fadeOut",500)}}),gsap.to(this.flower.drop2,{duration:.5,y:434,onComplete:()=>{helper.fadeAnimation(this.flower.drop2,"fadeOut",500)}}),gsap.to(this.flower.drop1,{duration:.6,y:434,onComplete:()=>{helper.fadeAnimation(this.flower.drop1,"fadeOut",500),gsap.to(this.flower.leica_big,{duration:.3,y:290,rotation:Math.PI/180*-50,ease:"back.out(2)",onComplete:()=>{gsap.to(this.flower.leica_big,{duration:.3,y:300,rotation:Math.PI/180*-45,ease:"back.out(2)",onComplete:()=>{helper.fadeAnimation(this.flower.drop4,"fadeIn",300),helper.fadeAnimation(this.flower.drop5,"fadeIn",300),gsap.to(this.flower.drop5,{duration:.4,y:434,onComplete:()=>{helper.fadeAnimation(this.flower.drop5,"fadeOut",500)}}),gsap.to(this.flower.drop4,{duration:.5,y:434,onComplete:()=>{helper.fadeAnimation(this.flower.drop4,"fadeOut",500,(()=>{gsap.to(this.flower.leica_big,{duration:.7,x:236,y:467,rotation:0,onComplete:()=>{if(this.flower.drop1.y=288,this.flower.drop2.y=296,this.flower.drop3.y=297,this.flower.drop4.y=this.flower.drop5.y=307,this.animNumber("minus"),t.flower_size>60){let e=t.win;helper.animFlower(this.flower,e),this.showWin(e),iface.updateUp()}this.updateFlower()}})}))}})}})}})}})}})}showWin(t){this.flower.win_rub.tf_txt.text="+"+t[3],this.flower.win_bita.tf_txt.text="+"+t[0],this.flower.win_travmat.tf_txt.text="+"+t[1],this.flower.win_butilka.tf_txt.text="+"+t[2],helper.alphaAnimation(this.flower.win_rub,1,500,(()=>{helper.alphaAnimation(this.flower.win_bita,1,300,(()=>{helper.alphaAnimation(this.flower.win_travmat,1,300,(()=>{helper.alphaAnimation(this.flower.win_butilka,1,300,(()=>{helper.alphaAnimation(this.flower.win_rub,0,1500),helper.alphaAnimation(this.flower.win_bita,0,1500),helper.alphaAnimation(this.flower.win_travmat,0,1500),helper.alphaAnimation(this.flower.win_butilka,0,1500)}))}))}))}))}plusChifir(t){achives.refresh(),iface.stopObmen(),this.animNumber("plus",t.cnt),this.updateFlower(),iface.updateUp()}animNumber(t,e){"minus"==t?(this.flower.chif_anim.y=563,this.flower.chif_anim.tf_txt.text="-1",helper.alphaAnimation(this.flower.chif_anim,1,100,(()=>{gsap.to(this.flower.chif_anim,{duration:1,y:543}),helper.alphaAnimation(this.flower.chif_anim,0,1e3)}))):(this.flower.chif_anim.y=543,this.flower.chif_anim.tf_txt.text="+"+e,gsap.to(this.flower.chif_anim,{duration:.3,y:563}),helper.alphaAnimation(this.flower.chif_anim,1,300,(()=>{helper.alphaAnimation(this.flower.chif_anim,0,150)})))}initButtons(){setButton(this.flower.trash_btn),setButton(this.flower.alive_btn),setButton(this.flower.posadka_btn),setButton(this.flower.leica_big),setButton(this.flower.leica_icon),setButton(this.flower.padick_mc),setButton(this.flower.prev_btn),setButton(this.flower.next_btn)}}class x{constructor(t,e){this.garage=t,this.wears=e,this.garage.collections_mov.filters=null,this.machine_levels=["Мусор","Хлам","Рухлядь","Корыто","Тачанка","Ласточка","Копейка"],this.initUnics(),this.initButtons(),this.initTexts(),helper.blowController("garage_flower",[this.garage.flowers_mov],this.garage.flowers_blow),helper.blowController("garage_coll",[this.garage.collections_mov],this.garage.collections_blow),helper.blowController("garage_wears",[this.garage.wears_mov],this.garage.wear_blow),helper.blowController("garage_auto",[this.garage.auto_butt],this.garage.stock_blow),this.wears.interactive=!0,this.wears_page=0,helper.clickControl(this.garage.flowers_mov,null,(()=>this.toFlower())),helper.clickControl(this.garage.collections_mov,null,(()=>this.toCollections())),helper.clickControl(this.garage.works_mov,null,(()=>this.toWorks())),helper.clickControl(this.garage.wears_mov,null,(()=>this.showWears())),helper.clickControl(this.wears.win.close_mc,null,(()=>this.hideWears())),helper.clickControl(this.wears.win.next_mc,null,(()=>this.nextPageWears())),helper.clickControl(this.wears.win.prev_mc,null,(()=>this.prevPageWears())),helper.clickControl(this.wears.win.buy_mc,null,(()=>this.buyWear()))}init(){helper.goLocation(11),this.garage.flowers_blow.tf_txt.text="С 18 уровня",!TIMERS.timers.flower.init&&helper.getLevel(udata.exp)>=18&&(TIMERS.timers.flower={init:!0,tick:t=>{flower.tickFlower(t)}}),this.updateCar(),root.layer0_mc.addChild(this.garage)}toFlower(){helper.getLevel(udata.exp)<18||(13!=HYSTORY[HYSTORY.length-1]||TOBACK)&&(iface.removeStage(),iface.showIcons(),flower.init())}toCollections(){modules.checkFlags(["coll"],(()=>{collections.show()}))}toWorks(){modules.checkFlags(["city"],(()=>{city.toWorks(0)}))}showWears(){this.wears.shadow_mc.alpha=0,this.wears_page=0,helper.alphaAnimation(this.wears.shadow_mc,1,500),this.updWear(),this.wears.parent||root.layer1_mc.addChild(this.wears)}hideWears(){this.wears.parent&&root.layer1_mc.removeChild(this.wears)}updWear(){this.wid=wears.works[this.wears_page],udata.craft[this.wid]||(udata.craft[this.wid]=0),this.wears.win.caps_txt.text=helper.shortText(udata.caps);let t=this.wears.win.slot_mc,e=wears.w[this.wid];t.mini_mc.addChild(helper.duplicate(icon_wears[this.wid])),t.craft_mc.num_txt.text=udata.craft[this.wid]+"/"+e.wanted[1],t.price_txt.text=e.name[0],t.season_mc.visible=!1,this.wears.win.page_txt.text=this.wears_page+1+"/"+wears.works.length,this.wears.win.price_blow.visible=t.craft_mc.visible=parseInt(udata.craft[this.wid])<parseInt(e.wanted[1]),parseInt(udata.craft[this.wid])<parseInt(e.wanted[1])?(this.wears.win.buy_mc.alpha=1,this.wears.win.buy_mc.interactive=!0,this.wears.win.buy_mc.buttonMode=!0):(this.wears.win.buy_mc.alpha=.7,this.wears.win.buy_mc.interactive=!1,this.wears.win.buy_mc.buttonMode=!1),this.wears.win.desc_mc.damage_txt.text=e.description[0],this.wears.win.desc_mc.naming_txt.text=e.description[1],this.wears.win.desc_mc.season_txt.text=e.description[2]}buyWear(){this.wid_anim||TS.php("works.buyWear",{wear:this.wid},(()=>{this.wid_anim=!0,this.wears.win.slot_mc.anim_mc.tf_txt.text="+1",this.wears.win.slot_mc.anim_mc.y=-36,this.wears.win.slot_mc.anim_mc.alpha=0,iface.showChotko(),helper.alphaAnimation(this.wears.win.slot_mc.anim_mc,1,200),gsap.to(this.wears.win.slot_mc.anim_mc,{duration:.2,y:-26,onComplete:()=>{helper.alphaAnimation(this.wears.win.slot_mc.anim_mc,0,100,(()=>this.wid_anim=!1)),this.updWear()}})}),rootClass.onError)}nextPageWears(){this.wears_page+1>=wears.works.length||(this.wears_page++,this.updWear())}prevPageWears(){0!=this.wears_page&&(this.wears_page--,this.updWear())}updateCar(){let t=udata.coll_car.length;this.garage.level_mc.level_txt.text="Уровень "+t+": "+this.machine_levels[t],helper.scaleAnimation(this.garage.level_mc.line_mc,t/this.machine_levels.length,300),this.garage.stock_auto.gotoAndStop(t)}initButtons(){setButton(this.garage.flowers_mov),setButton(this.garage.collections_mov),setButton(this.garage.wears_mov),setButton(this.garage.works_mov),setButton(this.garage.auto_butt),setButton(this.wears.win.buy_mc),setButton(this.wears.win.close_mc),setButton(this.wears.win.next_mc),setButton(this.wears.win.prev_mc)}initUnics(){this.wears.win.close_mc.addChild(helper.duplicate(modules.unical.close))}initTexts(){setTextStyle(this.wears.win.desc_mc.damage_txt,{miterLimit:3,strokeThickness:6}),setTextStyle(this.wears.win.desc_mc.naming_txt,{miterLimit:3,strokeThickness:6}),setTextStyle(this.wears.win.desc_mc.season_txt,{miterLimit:3,strokeThickness:6})}}class v{constructor(t,e,s,i,o,a,n){this.full=t,this.end_slots=[e,s,i],this.slot=o,this.items=a,this.nahodka=n,this.page=0,this.slots=[],this.initButtons(),this.full.interactive=!0,this.full.win.close_mc.on("pointerdown",(()=>this.hide()));for(let t=1;t<=4;t++)this.full.win["closew"+t].on("pointerdown",(()=>TS.php("collections.delete",{id:t-1},(t=>this.onWanted(t)))));this.full.win.next_mc.on("pointerdown",(()=>this.nextPage())),this.full.win.prev_mc.on("pointerdown",(()=>this.prevPage()))}nextPage(){coll_info.collects.length/4<=this.page+1||(this.page++,this.constructPage())}prevPage(){0!=this.page&&(this.page--,this.constructPage())}show(){this.page=0,this.constructPage(),this.updateWant(),root.layer1_mc.addChild(this.full)}updateWant(){for(let t=1;t<=4;t++){let e=udata.coll_want[t-1];e||0===e||(e=-1),this.full.win["closew"+t].visible=this.full.win["want"+t].visible=!1,-1!==e&&(this.full.win["closew"+t].visible=this.full.win["want"+t].visible=!0,this.full.win["want"+t].gotoAndStop(e))}}wantedSearch(t){let e=!1;for(let s=0;s<4;s++)udata.coll_want[s]==t&&(e=!0);return e}onWanted(t){udata.coll_want=t.coll_want,this.updateWant()}constructPage(){for(;this.full.win.slots_mc.children.length;)this.full.win.slots_mc.removeChildAt(0);this.slots=[],this.full.win.page_txt.text=this.page+1+"/"+Math.ceil(coll_info.collects.length/4);for(let t=0;t<4&&coll_info.collects[4*this.page+t];t++){let e=4*this.page+t;for(let s=0;s<coll_info.collects[e].items.length;s++){let i=coll_info.collects[e].items[s],o=udata.coll_items[i]||0,a=helper.duplicate(this.slot),n=helper.duplicate(this.items);n.gotoAndStop(i),a.post_mc.alpha=0,a.counter_txt.text="x"+o,Boolean(o)||this.wantedSearch(i)||(setButton(a.bg_mc),a.bg_mc.on("mouseover",(()=>{this.wantedSearch(i)||(a.post_mc.alpha=1)})),a.bg_mc.on("mouseout",(()=>a.post_mc.alpha=0)),a.bg_mc.on("pointerdown",(()=>{TS.php("collections.want",{id:i},(t=>this.onWanted(t))),a.post_mc.visible=!1,a.bg_mc.buttonMode=!1}))),a.item_mc.addChild(n),a.x=67*s,a.y=76*t,this.slots.push(a),this.full.win.slots_mc.addChild(a)}let s=null;s=coll_info.collects[e].price.gold?-1==udata.coll_car.indexOf(e)?helper.duplicate(this.end_slots[2]):helper.duplicate(this.end_slots[1]):helper.duplicate(this.end_slots[0]),s.x=335,s.y=76*t,s.gold_txt&&(s.gold_txt.text=helper.shortText(coll_info.collects[e].price.gold)),s.exp_txt&&(s.exp_txt.text=helper.shortText(coll_info.collects[e].price.exp)),s.coins_txt&&(s.coins_txt.text=helper.shortText(coll_info.collects[e].price.coins)),s.butt_mc&&this.checkFull(4*this.page+t)&&(s.butt_mc.alpha=1,setButton(s.butt_mc),s.butt_mc.on("pointerdown",(()=>this.sell(4*this.page+t)))),s.butt_mc||(this.checkFull(4*this.page+t)?(s.alpha=1,setButton(s),s.on("pointerdown",(()=>this.sell(4*this.page+t)))):s.alpha=.5),this.full.win.slots_mc.addChild(s)}}hide(){root.layer1_mc.removeChild(this.full)}showNahodka(t){this.nahodka.item_mc.gotoAndStop(t),sounds.playNahodka(),this.nahodka.alpha=0,this.nahodka.y=600,this.nahodka.x=330,helper.fadeAnimation(this.nahodka,"fadeIn",700),gsap.to(this.nahodka,{y:550,duration:.7,onComplete:()=>{helper.fadeAnimation(this.nahodka,"fadeOut",1500)}}),this.nahodka.parent||root.layer2_mc.addChild(this.nahodka)}sell(t){TS.php("collections.sell",{id:t},(t=>{achives.refresh(t.achives_level),iface.updateUp(),iface.showChotko(),garage.updateCar(),this.constructPage()}),rootClass.onError)}initButtons(){setButton(this.full.win.close_mc),setButton(this.full.win.next_mc),setButton(this.full.win.prev_mc),setButton(this.full.win.closew1),setButton(this.full.win.closew2),setButton(this.full.win.closew3),setButton(this.full.win.closew4)}checkFull(t){for(let e=0;e<coll_info.collects[t].items.length;e++){let s=coll_info.collects[t].items[e];if(udata.coll_items[s]=udata.coll_items[s]||0,0==udata.coll_items[s])return!1}return!0}}class k{constructor(t,e,s,i){this.umen=t,this.popup=i,this.icon=e,this.cat_mov=s,this.icon_x=[[150],[100,200],[60,150,240],[0,100,200,300]],this.weapon_names=["кирпичу","ноге","руке","бите","травмату","розочке","ножу"],this.weapon_wanted_names=["кирпичом","ногой","рукой","битой","травматом","розочкой","ножом"],this.cur_line=0,this.anim_lines=!1,this.umen.interactive=this.popup.interactive=!0,this.initUnics(),this.initButtons(),this.umen.win.close_mc.on("pointerdown",(()=>{this.umen.parent&&root.layer1_mc.removeChild(this.umen)})),this.popup.win.close_mc.on("pointerdown",(()=>this.hidePopup())),this.popup.win.learn_mc.on("pointerdown",(()=>this.startLearn())),this.popup.win.turnon_mc.on("pointerdown",(()=>this.turnOn())),this.popup.win.vkbuy_mc.on("pointerdown",(()=>this.turnOn())),helper.clickControl(this.popup.win.off_btn,null,(()=>{modules.checkFlags(["notify"],(()=>{notify.accept_fun=()=>this.buyTurnOff(),notify.accept.win.tf_txt.text=50,notify.accept.win.val_mc.gotoAndStop("t_coin"),notify.showAccept()}))})),this.umen.win.next_bt.on("pointerdown",(()=>this.nextPage())),this.umen.win.prev_bt.on("pointerdown",(()=>this.prevPage()))}turnOff(){modules.checkFlags(["notify"],(()=>{notify.accept_fun=()=>this.buyTurnOff(),notify.accept.win.tf_txt.text=50,notify.accept.win.val_mc.gotoAndStop("t_coin"),notify.showAccept()}))}buyTurnOff(){TS.php("umens.turnOff",{id:this.popup.umen_id},(t=>{achives.refresh(),this.constructUmen(),this.hidePopup(),iface.showChotko(),iface.updateUp(),this.showPopup(this.popup.umen_id)}),rootClass.onError)}startLearn(){TS.php("umens.learn",{id:this.popup.umen_id},(t=>{achives.refresh(),this.constructUmen(),this.showPopup(this.popup.umen_id)}),rootClass.onError)}turnOn(){TS.php("umens.buy",{id:this.popup.umen_id},(t=>{achives.refresh(),this.constructUmen(),this.showPopup(this.popup.umen_id),iface.updateUp()}),rootClass.onError)}nextPage(){this.cur_line+4==this.all_lines||this.anim_lines||(this.cur_line++,this.anim_lines=!0,gsap.to(this.umen.win.icons_mc,{duration:.3,y:this.umen.win.icons_mc.y-95,onComplete:()=>{this.anim_lines=!1}}),this.cur_line+4==this.all_lines?(this.umen.win.next_bt.visible=this.umen.win.prev_def.visible=!1,this.umen.win.prev_bt.visible=this.umen.win.next_def.visible=!0):(this.umen.win.next_def.visible=this.umen.win.prev_def.visible=!1,this.umen.win.prev_bt.visible=this.umen.win.next_bt.visible=!0))}prevPage(){0==this.cur_line||this.anim_lines||(this.cur_line--,this.anim_lines=!0,gsap.to(this.umen.win.icons_mc,{duration:.3,y:this.umen.win.icons_mc.y+95,onComplete:()=>{this.anim_lines=!1}}),0==this.cur_line?(this.umen.win.next_bt.visible=this.umen.win.prev_def.visible=!0,this.umen.win.prev_bt.visible=this.umen.win.next_def.visible=!1):(this.umen.win.next_def.visible=this.umen.win.prev_def.visible=!1,this.umen.win.prev_bt.visible=this.umen.win.next_bt.visible=!0))}showUmen(){this.umen.shadow_mc.alpha=this.umen.shadow_box.alpha=0,this.umen.win.y=-600,this.umen.win.icons_mc.y=131,this.umen.bg_mc.visible=!1,this.cur_line=0,this.umen.win.next_bt.visible=this.umen.win.prev_def.visible=!0,this.umen.win.prev_bt.visible=this.umen.win.next_def.visible=!1,helper.fadeAnimation(this.umen.shadow_mc,"fadeIn",300,(()=>{helper.fadeAnimation(this.umen.bg_mc,"fadeIn",1e3),gsap.to(this.umen.win,{y:104,duration:1,ease:"back.out(1.3)",onComplete:()=>{helper.fadeAnimation(this.umen.shadow_box,"fadeIn",100)}})})),this.constructUmen(),this.umen.parent||root.layer1_mc.addChild(this.umen)}showPopup(t){this.popup.umen_id=t,this.popup.tick=-1,this.popup.win.off_btn.visible=!1;let e=this.searchUmen(t),s=this.searchCat(t);switch(this.popup.win.icon_mc.icon_mc.gotoAndStop(t),this.popup.win.icon_mc.cat_mc.gotoAndStop(umen_info.umens[t].type_icon),this.popup.win.icon_mc.name_txt.tf_txt.text=umen_info.umens[t].name,udata.umen_params.completed=udata.umen_params.completed||[],-1==udata.umen_params.completed.indexOf(t)?this.popup.win.bg_mc.gotoAndStop(0):this.popup.win.bg_mc.gotoAndStop(1),umen_info.umens[t].wanted.type){case"set":this.popup.win.wanted1_txt.text='Собрать сет "'+wears.sets.names[umen_info.umens[t].wanted.current]+'"';break;case"damage":this.popup.win.wanted1_txt.text="Пробить "+helper.getNumber(umen_info.umens[t].wanted.current)+" "+this.weapon_wanted_names[umen_info.umens[t].wanted.dop_type]}switch(udata.select_umen==t?this.popupProcess():-1==udata.umen_params.completed.indexOf(t)&&"sale"!==s.level?this.popupStart():e||"sale"===s.level?TIME-e.time<umen_info.umens[t].time?(this.popupInit(),this.all_timer=umen_info.umens[t].time,this.timer=e.time,TIMERS.timers.custom.init=!0,TIMERS.timers.custom.tick.push((()=>this.popupInit(e.time+umen_info.umens[t].time-TIME))),this.popup.tick=TIMERS.timers.custom.tick.length-1):TIME-e.time<umen_info.umens[t].time+umen_info.umens[t].reload?(this.popupReload(),this.all_timer=umen_info.umens[t].time+umen_info.umens[t].reload,this.timer=e.time,TIMERS.timers.custom.init=!0,TIMERS.timers.custom.tick.push((()=>this.popupReload(e.time+umen_info.umens[t].time+umen_info.umens[t].reload-TIME))),this.popup.tick=TIMERS.timers.custom.tick.length-1):"sale"==s.level&&this.popupSale():"t_coin"==umen_info.umens[t].valuta?this.popupSale():this.popupReady(),"sale"==s.level&&(this.popup.win.wanted1_txt.text="Нет требований"),umen_info.umens[t].bonus.type){case"emax_bonus":this.popup.win.bonus_txt.text="+"+this.ifCoef(t)+" к максимальной энергии";break;case"damage_coef":this.popup.win.bonus_txt.text="+"+this.ifCoef(t)+" к "+this.weapon_names[umen_info.umens[t].bonus.dop_type];break;case"umen_bonus boss_coins":this.popup.win.bonus_txt.text="x"+umen_info.umens[t].bonus.current+" монет за награду над боссом";break;case"umen_bonus boss_key":this.popup.win.bonus_txt.text="x"+umen_info.umens[t].bonus.current+" ключей за награду над подражателем";break;case"umen_bonus open_all_bosses":this.popup.win.bonus_txt.text="открытие всех залетных боссов"}umen_info.umens[t].wanted.umens?this.popup.win.wanted2_txt.text="Вкачать умений: "+umen_info.umens[t].wanted.umens:this.popup.win.wanted2_txt.text="";let i=Math.floor(umen_info.umens[t].time/3600),o=Math.floor(umen_info.umens[t].reload/3600);this.popup.win.timer_txt.text=i+" "+helper.numberEndFlower(i,"hours"),this.popup.win.reload_txt.text=o+" "+helper.numberEndFlower(o,"hours"),this.popup.parent||root.layer1_mc.addChild(this.popup)}ifCoef(t){let e="";return e="coef"==umen_info.umens[t].bonus.action?Math.ceil(100*(umen_info.umens[t].bonus.current-1))+"%":umen_info.umens[t].bonus.current,e}popupSale(){this.popup.win.learn_mc.visible=this.popup.win.turnon_mc.visible=this.popup.win.price_mc.visible=this.popup.win.info_txt.visible=!1,this.popup.win.vkprice_mc.visible=this.popup.win.vkbuy_mc.visible=!0,this.popup.win.vkprice_mc.tf_txt.text="-"+umen_info.umens[this.popup.umen_id].price}popupProcess(){this.popup.win.learn_mc.visible=this.popup.win.turnon_mc.visible=this.popup.win.price_mc.visible=this.popup.win.vkprice_mc.visible=this.popup.win.vkbuy_mc.visible=!1,this.popup.win.info_txt.visible=!0,this.popup.win.info_txt.text="Изучается..."}popupStart(){this.popup.win.info_txt.visible=this.popup.win.turnon_mc.visible=this.popup.win.vkprice_mc.visible=this.popup.win.vkbuy_mc.visible=this.popup.win.price_mc.visible=!1,this.popup.win.learn_mc.visible=!0}popupReady(){this.popup.win.info_txt.visible=this.popup.win.vkprice_mc.visible=this.popup.win.vkbuy_mc.visible=this.popup.win.learn_mc.visible=!1,this.popup.win.turnon_mc.visible=this.popup.win.price_mc.visible=!0,this.popup.win.price_mc.tf_txt.text="-"+umen_info.umens[this.popup.umen_id].price}popupInit(t=!1){if(this.popup.win.learn_mc.visible=this.popup.win.vkprice_mc.visible=this.popup.win.vkbuy_mc.visible=this.popup.win.turnon_mc.visible=this.popup.win.price_mc.visible=!1,this.popup.win.info_txt.visible=this.popup.win.off_btn.visible=!0,t){if(t<1)return TIMERS.timers.custom.tick.pop(),this.showPopup(this.popup.umen_id);this.popup.win.info_txt.text="Активно ещё "+helper.timeString(t)}else this.popup.win.info_txt.text="Умение активно...";this.popup.win.off_btn.off_price.tf_txt.text="за 50"}popupReload(t=!1){if(this.popup.win.learn_mc.visible=this.popup.win.vkprice_mc.visible=this.popup.win.vkbuy_mc.visible=this.popup.win.turnon_mc.visible=this.popup.win.price_mc.visible=!1,this.popup.win.info_txt.visible=this.popup.win.off_btn.visible=!0,t){if(t<1)return TIMERS.timers.custom.tick.pop(),this.showPopup(this.popup.umen_id);this.popup.win.info_txt.text="Доступно через "+helper.timeString(t)}else this.popup.win.info_txt.text="Перезарядка...";this.popup.win.off_btn.off_price.tf_txt.text="за 50"}hidePopup(){TIMERS.timers.umen={init:!1,tick:null},this.popup.tick>=0&&TIMERS.timers.custom.tick.splice(this.popup.tick,1),root.layer1_mc.removeChild(this.popup)}constructUmen(){-1==udata.select_umen?this.umen.win.name_txt.text="Умение не выбрано":this.umen.win.name_txt.text='Умение "'+umen_info.umens[udata.select_umen].name+'"',this.umen.win.progress_txt.text=udata.umen_perc+"%",this.umen.win.line_mc.full_mc.x=udata.umen_perc/100*111-111;let t=0;for(;this.umen.win.icons_mc.children.length;)this.umen.win.icons_mc.removeChildAt(0);for(let e=0;e<umen_info.cats.length;e++){let s=helper.duplicate(this.cat_mov),i=Math.ceil(umen_info.cats[e].umens.length/4);setTextStyle(s.level_txt,{dropShadow:!0,dropShadowAlpha:.92,dropShadowAngle:90,dropShadowBlur:2,dropShadowColor:"#1A140F",dropShadowDistance:1}),s.y=95*t,"sale"==umen_info.cats[e].level?s.level_txt.text="Акционные":s.level_txt.text="Доступно с "+umen_info.cats[e].level+" уровня";for(let t=0;t<umen_info.cats[e].umens.length;t++){let i=Math.floor(t/4),o=Math.min(umen_info.cats[e].umens.length-4*i,4),a=helper.duplicate(this.icon);parseInt(umen_info.cats[e].level)>udata.level||umen_info.cats[e].blocked?a.alpha=.7:(setButton(a),a.on("pointerdown",(t=>this.showPopup(t.currentTarget.umen_id)))),a.umen_id=umen_info.cats[e].umens[t],a.icon_mc.gotoAndStop(a.umen_id),a.cat_mc.gotoAndStop(umen_info.umens[a.umen_id].type_icon),a.name_txt.tf_txt.text=umen_info.umens[a.umen_id].name,a.x=this.icon_x[o-1][t-4*i],s.icons_mc.addChild(a)}t+=i,this.umen.win.icons_mc.addChild(s)}this.all_lines=t}searchUmen(t){for(let e=0;e<udata.umen_active.length;e++)if(udata.umen_active[e].id==t&&udata.umen_active[e].time+parseInt(umen_info.umens[t].time)+parseInt(umen_info.umens[t].reload)>TIME)return udata.umen_active[e];return!1}searchCat(t){for(let e=0;e<umen_info.cats.length;e++)if(-1!==umen_info.cats[e].umens.indexOf(t))return umen_info.cats[e]}countActives(){let t=0;for(let e=0;e<udata.umen_active.length;e++)1==udata.umen_active[e].active&&t++;return t}initButtons(){setButton(this.umen.win.close_mc),setButton(this.popup.win.close_mc),setButton(this.umen.win.next_bt),setButton(this.umen.win.prev_bt),setButton(this.popup.win.learn_mc),setButton(this.popup.win.turnon_mc),setButton(this.popup.win.vkbuy_mc),setButton(this.popup.win.off_btn)}initUnics(){this.umen.win.close_mc.addChild(helper.duplicate(modules.unical.close)),this.umen.shadow_box.addChild(helper.duplicate(modules.unical.wood_shadow))}}class y{constructor(t){this.calendar=t,this.calendar.interactive=!0,this.initUnics(),this.initButtons(),this.text={naperstki:["Играть ","\nв наперстки"],kanobu:["Играть ","\nв КНБ"],slots:["Крутить ","\nв слоты"],shmon:["Шманать ","\nдрузей"],boss0:["Гасить ","\nБарыгу"],boss2:["Гасить ","\nМажика"],boss3:["Гасить ","\nФому"],boss5:["Гасить ","\nОчкарика"],damage:["Нанести ","\nурона"],bigboxes:["Открыть ","\nкоробку мечты"],energy:["Потратить ","\nэнергии","IGNORE"],semki:["Заработать ","\nсемок","IGNORE"],combo1:["Выполнить ","\nкомбо 1 ур.","IGNORE"],combo2:["Выполнить ","\nкомбо 2 ур.","IGNORE"],combo3:["Выполнить ","\nкомбо 3 ур.","IGNORE"],locs0:["Захват ","\nВокзальный"],locs1:["Захват ","\nАвтобанский"]},this.pre_text="Доступно ещё:\n",this.calendar.win.close_mc.on("pointerdown",(()=>this.hideCalendar())),this.calendar.win.next_mc.on("pointerdown",(()=>{if(cal_info.works.length>this.days+1){this.days+=1;let t=this.prettyWork(cal_info.works[this.days]);this.calendar.win.date_mc.day_txt.text=this.days+1,this.calendar.win.date_mc.work_txt.text=t}this.calendar.win.next_mc.visible=!Boolean(cal_info.works.length==this.days+1),this.calendar.win.prev_mc.visible=Boolean(TIME<cal_info.days[this.days])})),this.calendar.win.prev_mc.on("pointerdown",(()=>{if(TIME<cal_info.days[this.days-1]||TIME<cal_info.days[this.days]){this.days-=1;let t=this.prettyWork(cal_info.works[this.days]);this.calendar.win.date_mc.day_txt.text=this.days+1,this.calendar.win.date_mc.work_txt.text=t}this.calendar.win.next_mc.visible=!Boolean(cal_info.works.length==this.days+1),this.calendar.win.prev_mc.visible=Boolean(TIME<cal_info.days[this.days])})),this.calendar.win.buy_mc.on("pointerdown",(()=>{modules.checkFlags(["notify"],(()=>{notify.accept_fun=()=>TS.php("users.buyLeafs",{},(()=>{this.shopCalendar(),this.calendar.win.leafs_txt.text=udata.calendar_shop.leafs,iface.updateUp()}),rootClass.onError),notify.accept.win.tf_txt.text=cal_info.shop.leafs[udata.calendar_shop.buy_leafs],notify.accept.win.val_mc.gotoAndStop("t_coin"),notify.showAccept()}))}))}showCalendar(){this.calendar.shadow_mc.alpha=0,this.calendar.win.prev_mc.visible=this.calendar.win.next_mc.visible=!1,helper.alphaAnimation(this.calendar.shadow_mc,1,300);let t=this.getDateInfo();this.timer=t.timer,this.calendar.win.date_mc.day_txt.text=t.day,this.calendar.win.date_mc.work_txt.text=t.work,this.calendar.win.date_mc.month_txt.text=t.month,this.shopCalendar(),this.calendar.win.leafs_txt.text=udata.calendar_shop.leafs,TIMERS.timers.custom.init=!0,TIMERS.timers.custom.tick.push((t=>this.updTimers(t))),root.layer1_mc.addChild(this.calendar)}updTimers(t){let e=new Date(1e3*(TIME+3600*TIMERS.utc_diff));0==e.getHours()&&e.getMinutes()<5?this.calendar.win.timer_txt.text="Обновление\nданных...":this.calendar.win.timer_txt.text=this.pre_text+helper.timeString(this.timer-TIME)}shopCalendar(){for(let t=0;t<cal_info.shop.prices.length;t++)this.calendar.win["slot"+(t+1)].icon_mc.gotoAndStop(cal_info.shop.keys[t]),this.calendar.win["slot"+(t+1)].count_txt.text="x"+cal_info.shop.values[t],this.calendar.win["slot"+(t+1)].leafs_txt.text="-"+cal_info.shop.prices[t]+" "+helper.numberEndFlower(cal_info.shop.prices[t],"leafs"),this.calendar.win["slot"+(t+1)].take_mc.interactive=!0,this.calendar.win["slot"+(t+1)].take_mc.alpha=1,udata.calendar_shop.check=udata.calendar_shop.check||[],(udata.calendar_shop.check[t]||udata.calendar_shop.leafs<cal_info.shop.prices[t])&&(this.calendar.win["slot"+(t+1)].take_mc.interactive=!1,this.calendar.win["slot"+(t+1)].take_mc.alpha=.5,udata.calendar_shop.check[t]&&(this.calendar.win["slot"+(t+1)].check_mc.alpha=1));udata.calendar_shop.buy_leafs||(udata.calendar_shop.buy_leafs=0),this.calendar.win.price_mc.tf_txt.text="-"+cal_info.shop.leafs[udata.calendar_shop.buy_leafs]}getDateInfo(){let t,e={day:0,timer:0,month:0,work:0};for(t=0;t<cal_info.days.length&&!(TIME<cal_info.days[t]);t++);t>0&&t--;let s=new Date(1e3*(cal_info.days[t]+3600*TIMERS.utc_diff));return e.day=helper.getZeros(s.getDate()),e.month=TIMERS.month_rus[s.getMonth()],e.timer=parseInt(cal_info.days[t])+86400,this.days=t,this.days>=0&&this.days<cal_info.days.length-1&&(this.calendar.win.next_mc.visible=!0),e.work=this.prettyWork(cal_info.works[t]),e}prettyWork(t){let e=Object.keys(this.text);for(let t=0;t<e.length;t++)udata.calendar_info[e[t]]=udata.calendar_info[e[t]]||0;udata.calendar_shop.leafs=udata.calendar_shop.leafs||0;let s=this.text[t.type],i=parseInt(t.value)-parseInt(udata.calendar_info[t.type]);this.calendar.win.taked_mc.alpha=0,this.calendar.win.date_mc.alpha=1,i<=0?(i=parseInt(t.value),TIME>cal_info.days[this.days]&&(this.calendar.win.taked_mc.alpha=1,this.calendar.win.date_mc.alpha=.5),this.pre_text="Ожидание...\n"):this.pre_text="Доступно ещё:\n";let o=s[0]+i+" "+helper.numberEnd(i)+s[1];return"IGNORE"==s[2]&&(o=s[0]+i+" "+s[1]),"damage"==t.type&&(o=s[0]+helper.shortText(i,!1)+s[1]),o}hideCalendar(){this.calendar.parent&&this.calendar.parent.removeChild(this.calendar)}initButtons(){setButton(this.calendar.win.close_mc);for(let t=1;t<=5;t++)setButton(this.calendar.win["slot"+t].take_mc),helper.clickControl(this.calendar.win["slot"+t].take_mc,null,(()=>{TS.php("users.buyCal",{id:t-1},(()=>{this.shopCalendar(),this.calendar.win.leafs_txt.text=udata.calendar_shop.leafs,iface.showChotko(),iface.updateUp(),achives.refresh()}),rootClass.onError)}));setButton(this.calendar.win.buy_mc),setButton(this.calendar.win.prev_mc),setButton(this.calendar.win.next_mc)}initUnics(){this.calendar.win.close_mc.addChild(helper.duplicate(modules.unical.close))}}class S{constructor(t,e){this.fights_pit=t,this.fights_pit.interactive=!0,this.boss_slot=e,this.bookmarks=[this.fights_pit.fight,this.fights_pit.bosses,this.fights_pit.skills],this.bookmarks_f=[this.fights_pit.skills,this.fights_pit.bosses,this.fights_pit.fight],this.bookmarks_b=[this.fights_pit.fight,this.fights_pit.skills,this.fights_pit.bosses],this.bookmarks_s=[this.fights_pit.fight,this.fights_pit.bosses,this.fights_pit.skills],this.select_class=[this.fights_pit.fight.select_class.butt_0,this.fights_pit.fight.select_class.butt_1,this.fights_pit.fight.select_class.butt_2],this.skills=[this.fights_pit.skills.skls_cl_0,this.fights_pit.skills.skls_cl_1,this.fights_pit.skills.skls_cl_2],this.class_text=["Лоб","Эскулап","Киллер"],this.rewards_fight_mode=["Открывает бои 1x1","Открывает бои 2x2","Открывает бои 3x3"],this.rewards_fight_mode_0=['Открывает один из навыков "Уникальных"','Открывает один из навыков "Исцеление"','Открывает один из навыков "Удар"'],this.class_id=-1,this.initButtons(),this.fights_pit.fight.butt.on("pointerdown",(()=>{this.updateBookmarks(this.bookmarks,this.bookmarks_f);for(let t=0;t<this.skills.length;t++)this.skills[t].visible=!1;-1==this.class_id?this.fights_pit.fight.select_class.visible=!0:this.fights_pit.fight.type_fight.visible=!0})),this.fights_pit.fight.type_fight.butt_ch.on("pointerdown",(()=>{modules.checkFlags(["notify"],(()=>{notify.accept_fun=()=>TS.php("pit.cancelClass",{},(t=>this.onOk(t)),rootClass.onError),notify.accept.win.tf_txt.text=250,notify.accept.win.val_mc.gotoAndStop("t_coin"),notify.showAccept()}))})),this.fights_pit.fight.type_fight.blow_mc.visible=!1,this.fights_pit.fight.type_fight.blow_mc.alpha=0,this.fights_pit.fight.type_fight.butt_ch.on("mouseover",(()=>helper.fadeAnimation(this.fights_pit.fight.type_fight.blow_mc,"fadeIn"))),this.fights_pit.fight.type_fight.butt_ch.on("mouseout",(()=>helper.fadeAnimation(this.fights_pit.fight.type_fight.blow_mc,"fadeOut")));for(let t=0;t<this.select_class.length;t++)this.select_class[t].on("pointerdown",(()=>TS.php("pit.selectClass",{class:t},(t=>this.onOk(t)),rootClass.onError)))}init(){this.fights_pit.fight.type_fight.visible=!1,this.fights_pit.fight.select_class.visible=!1,helper.animateEl("start",this.fights_pit.fight.select_class.vibor_class_txt),TS.php("pit.check",{},(t=>this.onOk(t)),rootClass.onError);for(let t=0;t<this.skills.length;t++)this.skills[t].visible=!1;for(let t=0;t<this.bookmarks_f.length;t++)root.layer1_mc.addChild(this.bookmarks_f[t]);this.constructsbosses(),this.fights_pit.bosses.slot_bosses.visible=!1}constructsbosses(){for(;this.fights_pit.bosses.slots_mc.children.length;)this.fights_pit.bosses.slots_mc.removeChildAt(0);this.selector_slots=[];for(let t=0;t<3;t++){let e=helper.duplicate(this.boss_slot);setButton(e.butt),e.name_txt.text="Шнырь",e.rewards_0.text=this.rewards_fight_mode[t],e.rewards_1.text=this.rewards_fight_mode_0[t],e.bosses_not_dostup_mc.visible=!1,e.bosses_win_mc.visible=!1,t>0&&(e.bosses_not_dostup_mc.visible=!0),e.bosses_not_dostup_mc.interactive=!0,e.lifes_mc.tf_txt.text=helper.getNumberRazdel(1e7),e.blow_mc.visible=!1,e.blow_mc.alpha=0,e.butt.on("mouseover",(()=>helper.fadeAnimation(e.blow_mc,"fadeIn"))),e.butt.on("mouseout",(()=>helper.fadeAnimation(e.blow_mc,"fadeOut"))),this.selector_slots.push(e),e.y=130*t}for(let t=this.selector_slots.length-1;t>=0;t--)this.fights_pit.bosses.slots_mc.addChild(this.selector_slots[t])}onOk(t){if(-1==t.pit.class)this.fights_pit.fight.type_fight.visible=!1,this.fights_pit.fight.select_class.visible=!0,this.fights_pit.bosses.butt.buttonMode=!1,this.fights_pit.skills.butt.buttonMode=!1,this.fights_pit.bosses.butt._events={},this.fights_pit.skills.butt._events={},this.class_id=-1;else{this.fights_pit.fight.type_fight.visible=!0,this.fights_pit.fight.select_class.visible=!1;let e=t.pit.class;this.fights_pit.bosses.butt.buttonMode||setButton(this.fights_pit.bosses.butt),this.fights_pit.skills.butt.buttonMode||setButton(this.fights_pit.skills.butt),this.fights_pit.bosses.butt.on("pointerdown",(()=>{this.updateBookmarks(this.bookmarks,this.bookmarks_b);for(let t=0;t<this.skills.length;t++)this.skills[t].visible=!1;this.fights_pit.fight.type_fight.visible=this.fights_pit.fight.select_class.visible=!1})),this.fights_pit.skills.butt.on("pointerdown",(()=>{if(this.updateBookmarks(this.bookmarks,this.bookmarks_s),this.fights_pit.fight.type_fight.visible=this.fights_pit.fight.select_class.visible=!1,-1==this.class_id)for(let t=0;t<this.skills.length;t++)this.skills[t].visible=!1;else{this.skills[this.class_id].visible=!0;let t=[this.skills[this.class_id].skls_0,this.skills[this.class_id].skls_3,this.skills[this.class_id].skls_5];for(let e=0;e<t.length;e++)setButton(t[e])}})),this.class_id=e;for(let t=0;t<this.skills.length;t++)this.skills[t].visible=!1;this.skills[e].visible=!0,this.skills[e].skls_1.alpha=this.skills[e].skls_2.alpha=this.skills[e].skls_4.alpha=this.skills[e].skls_6.alpha=.5,this.skills[e].x=3,this.fights_pit.fight.type_fight.class_txt.text="Класс: "+this.class_text[e],this.skills[e].count_skls_txt.text="Доступно: 0"}iface.updateUp(),achives.refresh(udata.achives_level)}selectClass(t){this.fights_pit.fight.select_class.visible=!1,this.fights_pit.fight.type_fight.visible=!0;let e=this.select_class.indexOf(t.currentTarget);this.class_id=e;for(let t=0;t<this.skills.length;t++)this.skills[t].visible=!1;this.skills[e].visible=!0,this.skills[e].skls_1.alpha=this.skills[e].skls_2.alpha=this.skills[e].skls_4.alpha=this.skills[e].skls_6.alpha=.5,this.skills[e].x=3,this.fights_pit.fight.type_fight.class_txt.text="Класс: "+this.class_text[e],this.skills[e].count_skls_txt.text="Доступно: 0"}hidePit(){this.fights_pit.parent&&root.layer1_mc.removeChild(this.fights_pit),this.fights_pit.fight.parent&&root.layer1_mc.removeChild(this.fights_pit.fight),this.fights_pit.bosses.parent&&root.layer1_mc.removeChild(this.fights_pit.bosses),this.fights_pit.skills.parent&&root.layer1_mc.removeChild(this.fights_pit.skills),this.class_id=-1}updateBookmarks(t,e){for(let e=0;e<t.length;e++)root.layer1_mc.removeChild(t[e]);for(let t=0;t<e.length;t++)root.layer1_mc.addChild(e[t])}initButtons(){setButton(this.fights_pit.fight.butt),setButton(this.fights_pit.bosses.butt),setButton(this.fights_pit.skills.butt),setButton(this.fights_pit.fight.type_fight.butt_ch),this.fights_pit.fight.type_fight.butt_fight_0.gotoAndStop(0),this.fights_pit.fight.type_fight.butt_fight_1.gotoAndStop(0),this.fights_pit.fight.type_fight.butt_fight_2.gotoAndStop(0);for(let t=0;t<this.select_class.length;t++)setButton(this.select_class[t])}}class I{constructor(t){this.preloader=t.preloader_mc,this.names={media:["Щимим дизайнеров","Загрузка графона","Обсыкаем падик","Рисуем фингалы Фоме",'Кричим "эээ"'],token:["Выполняем рейдерский захват серверов","Крышуем хакеров","Шифруемся"],notoken:["Ожидаем запуска VK API"],json:["Ищем сладких лохов","Получаем наводку на Барыгу","Считаем мандаты","Валяем в грязи шмотки с толчка"],cache:["Узнаем о самых чотких пацанах","Собираем совет авторитетов"],udata:["Поясняем по понятиям конторе Tolmasoft Games","Раскрываем консервы","Захватываем серваки игры","Требуем обновления"],error:["Ошибка обработки данных с сервера. Обратитесь к разработчикам игры"],friends:["Наводим справки о твоих корешах","Захватываем базу промиков в пятерочке","Общаемся с местными органами","Пишем заяву на корешей, которые еще не играют"]},this.name_ind=0,this.name_type="notoken",this.startAnim=[36,44,58],this.timeAnim=[1100,834,367],this.endAnim=[69,99,129],this.moveAnim=[[1,2],[0,2],[1,2]],this.ballX=[274,374,474],this.anim_interval=this.stars_interval=null,this.completeLoad=!1,this.all=0,this.my=0,this.stakan=0,this.win_stakan=0,window.playLogo=()=>{this.constructLogo()}}constructLogo(){let t=new PIXI.Graphics;t.beginFill(0),t.drawRect(-232,40,222,60),t.endFill(),this.preloader.logos.logo_game.addChild(t),this.preloader.logos.logo_game.xuli_logo.mask=t,this.preloader.logos.logo_game.xuli_logo.alpha=1,this.preloader.logos.logo_game.val_mc.stop(),gsap.to(this.preloader.info_mc.stars_mc,{duration:1,y:-50}),helper.alphaAnimation(this.preloader.info_mc.info_txt,1,1e3),helper.alphaAnimation(this.preloader.logos.logo_game.val_mc,1,100,(()=>{this.preloader.logos.logo_game.val_mc.play(),gsap.to(t,{duration:1,x:222}),gsap.to(this.preloader.logos.logo_game.val_mc,{duration:1,x:200,onComplete:()=>{helper.alphaAnimation(this.preloader.logos.logo_game.val_mc,0),show_logo=!0,!0===media_loaded&&endLoadGame()}}),this.stars_interval=setInterval((()=>this.animStars()),5e3)}))}animStars(){if(this.completeLoad)return clearInterval(this.stars_interval);0==this.preloader.info_mc.stars_mc.y?(gsap.to(this.preloader.info_mc.stars_mc,{duration:1,y:-50}),helper.alphaAnimation(this.preloader.info_mc.info_txt,1,1e3)):(gsap.to(this.preloader.info_mc.stars_mc,{duration:1,ease:"bounce.out",y:0}),helper.alphaAnimation(this.preloader.info_mc.info_txt,0,300))}loadInfo(t,e=null){t!==this.name_type&&(this.name_ind=Math.floor(Math.random()*this.names[t].length)),this.preloader.info_mc.info_txt.text=this.names[t][this.name_ind],this.name_type=t,e&&(this.preloader.info_mc.info_txt.text+="\nЗАГРУЗКА "+Math.floor(e)+"/100")}initTimer(){bridge.sendPromise("VKWebAppCallAPIMethod",{method:"utils.getServerTime",params:{access_token:VK_token,v:VK_version}}).then((t=>{window.TIMERS=new Timers(t.response),this.initGame()})).catch((t=>{bridge.send("VKWebAppGetAuthToken",{app_id:parseInt(vk_params.api_id),scope:"friends,wall,photos,groups"}).then((t=>{VK_token=t.access_token,console.log(t),window.debug_mode?this.initGame():this.initTimer()}))}))}initGame(){TS.php("security.getToken",{access_token:vk_params.access_token},(t=>this.onGetToken(t)),(t=>this.onError(t))),this.loadInfo("token")}onGetToken(t){t.token&&(TS.token=t.token),helper.getJSON(my_server+"/json/_bigger.json",(t=>{this.initJSON(t)}),(t=>{this.onError(t)})),this.loadInfo("json")}initJSON(t){window.levels=t.levels,window.weapons=t.weapons,window.locs=t.quests,window.mlevels=t.minigame,window.bosses=t.bosses.bosses,window.boss_modes=t.bosses.modes,window.donat=t.donuts,window.bonuses=t.bonus,window.mandats_info=t.mandats,window.achives_info=t.achives,window.works_info=t.work,window.wears=t.wears,window.bgs_info=t.bgs,window.ny_info=t.newyear,window.coll_info=t.collections,window.learn_cfg=t.learn,window.umen_info=t.umen,window.baul=t.baul,window.febr23=t["23feb"],helper.getJSON(my_server+"/json/calendar.json",(t=>{this.initCal(t)}),(t=>{this.onError(t)})),helper.getJSON(my_server+"/json/squid.json",(t=>{this.initKalmarTop(t)}),(t=>{this.onError(t)})),helper.getJSON(my_server+"/json/cache/calmar_ivent.json",(t=>{this.initKalmar(t)}),(t=>{this.onError(t)})),this.loadInfo("cache")}initCal(t){window.cal_info=t,helper.getJSON(my_server+"/json/cache/_bigcache.json",(t=>{this.initCacheJSON(t)}),(t=>{this.onError(t)}))}initKalmar(t){window.kalmar=t}initKalmarTop(t){window.top_kalmar=t}initCacheJSON(t){window.rating={top:t.top},window.loctop=t.toploc,window.flower_top=t.flower_top;let e="";bridge.sendPromise("VKWebAppCallAPIMethod",{method:"friends.get",params:{fields:"photo_50",access_token:VK_token,v:VK_version}}).then((t=>{let s=t.response.items;bridge.sendPromise("VKWebAppCallAPIMethod",{method:"friends.getAppUsers",params:{access_token:VK_token,v:VK_version}}).then((i=>{for(let e=0;e<t.response.count;e++)-1==i.response.indexOf(s[e].id)&&non_app_friends.push(s[e]);vk_params.api_result=i.response,e=vk_params.api_result.length>0?vk_params.viewer_id+","+vk_params.api_result.join(","):vk_params.viewer_id.toString(),window.my_friends=e,TS.php("users.get",{uid:vk_params.user_id,users:e,hash:vk_params.hash,ads:vk_params.referrer.split("ad_")[1]},(t=>this.onGetUserInfo(t)),(t=>this.onError(t))),this.loadInfo("friends")})).catch((t=>{TS.php("users.get",{uid:vk_params.user_id,users:"skip",hash:vk_params.hash,ads:vk_params.referrer.split("ad_")[1]},(t=>this.onGetUserInfo(t)),(t=>this.onError(t)))}))})).catch((t=>{TS.php("users.get",{uid:vk_params.user_id,users:"skip",hash:vk_params.hash,ads:vk_params.referrer.split("ad_")[1]},(t=>this.onGetUserInfo(t)),(t=>this.onError(t)))})),this.loadInfo("udata")}onGetUserInfo(t){window.udata=t.udata,this.onGetFriendsTop(t.friends_top)}onGetFriendsTop(t){window.rating.friends=t,rating.friends.id&&(rating.friends[0]=t),rating.friends=rating.friends.slice(0,1e3);let e=[];for(let s=0;s<rating.friends.length;s++)e.push(t[s].id);bridge.sendPromise("VKWebAppCallAPIMethod",{method:"users.get",params:{fields:"photo_50",user_ids:String(e.join(",")),access_token:VK_token,v:VK_version}}).then((t=>{for(let e=0;e<t.response.length;e++)rating.friends[e].photo=t.response[e].photo_50,t.response[e].id==vk_params.viewer_id&&(my_photo50=t.response[e].photo_50);helper.getJSON(my_server+"/json/bronik.json",(t=>{this.initBronikJSON(t)}),(t=>{this.onError(t)}))}))}initBronikJSON(t){window.bronik_out=t,loadGame()}onError(t){this.preloader.info_mc.info_txt.text=t.text}startMiniGame(){this.nullData(),this.anim_interval=setInterval((()=>{clearInterval(this.anim_interval),this.preloader.ball.visible=!1,this.anim_interval=setInterval((()=>{clearInterval(this.anim_interval),this.randomAnim()}),1334)}),900),this.preloader.anim_mc.gotoAndPlay(0)}randomAnim(){if(0==this.all&&(this.all=parseInt(6*Math.random())+1),this.my==this.all)return void this.showBlow();let t=parseInt(Math.random()*this.startAnim.length),e=this.moveAnim[t],s=e.indexOf(this.win_stakan);-1!==s&&(this.win_stakan=e[e.length-1-s]),this.anim_interval=setInterval((()=>{clearInterval(this.anim_interval),this.randomAnim()}),this.timeAnim[t]),this.preloader.anim_mc.gotoAndPlay(this.startAnim[t]),this.my++}showBlow(){if(!(this.preloader.blows_mc.alpha>0)){this.preloader.blows_mc.alpha<1&&helper.alphaAnimation(this.preloader.blows_mc,1,300),this.preloader.blows_mc.gotoAndStop(1);for(let t=0;t<this.stakanArr.length;t++)this.stakanArr[t].visible=!0}}setStakan(t){let e=this.stakan=this.stakanArr.indexOf(t.currentTarget);if(!(e<0)){for(let t=0;t<this.stakanArr.length;t++)this.stakanArr[t].visible=!1;e==this.win_stakan?this.preloader.blows_mc.gotoAndStop(2):this.playDef(),this.preloader.anim_mc.gotoAndPlay(this.endAnim[e]+1),this.preloader.ball.x=this.ballX[this.win_stakan],this.preloader.ball.visible=!0,this.anim_interval=setInterval((()=>{clearInterval(this.anim_interval),this.nullData(),this.preloader.blows_mc.gotoAndStop(0),helper.alphaAnimation(this.preloader.blows_mc,1,300)}),3e3)}}nullData(){this.my=this.all=this.win_stakan=0,clearInterval(this.anim_interval),this.preloader.blows_mc.alpha>0&&(this.preloader.blows_mc.alpha=0,this.preloader.blows_mc.gotoAndStop(1)),this.preloader.anim_mc.gotoAndStop(0);for(let t=0;t<this.stakanArr.length;t++)this.stakanArr[t].visible=!1;this.preloader.ball.visible=!0,this.preloader.ball.x=this.ballX[0]}playDef(){helper.alphaAnimation(this.preloader.blows_mc,0,300);let t=setInterval((()=>{this.randomDefeat(),clearInterval(t)}),1e3);this.randomDefeat()}randomDefeat(){let t=this.win_stakan;this.preloader.ball.x=this.ballX[t],this.preloader.ball.visible=!0,this.preloader.anim_mc.gotoAndStop(this.endAnim[t]),this.preloader.anim_mc.play()}}window.bridge=vkBridge,window.debug_mode=!1,window.session_hash=md5(Math.random().toString()),window.media_loaded=window.show_logo=!1;let C,T=document.location.search.substr(1).split("&"),A={};for(let t=0;t<T.length;t++)C=T[t].split("="),A[C[0]]=C[1];function B(){let t=null;window.VKinit?pre_control.initTimer():(pre_control.loadInfo("notoken"),t=setInterval((()=>{clearInterval(t),B()}),1e3))}bridge.send("VKWebAppInit").then((t=>window.VKinit=!0)),window.load_info=window.prog=window.root=window.udata=window.pre_control=null,window.vk_params=A,window.VK_token=vk_params.access_token,window.VK_version="5.132",window.group_id=133196577,window.my_server="https://tolmasoft.com/xuligame/server",window.debug_mode&&(window.my_server="https://tolmasoft.com/_xuligame/server"),window.testers=["112354918","541806736","657771445","560779835","184138040","78167493","478818039","136774394","698742002","18470844","677277080","160189961","86187604"],window.bridge=bridge,window.Timers=class{constructor(t){window.TIME=parseInt(t),window.DATE=new Date(1e3*TIME),window.SEASON=["winter","spring","summer","autumn"][parseInt((DATE.getMonth()+1)/3)%4],window.days=["sunday","monday","tuesday","wednesday","thursday","friday","saturday"],this.month_rus=["Январь","Февраль","Март","Апрель","Май","Июнь","Июль","Август","Сентябрь","Октябрь","Ноябрь","Декабрь"],this.start_t=(new Date).getTime(),this.current_energy=0,this.timers={energy:{init:!1,tick:null},hobo:{init:!1,tick:null},free:{init:!1,tick:null},boss_limit:{init:!1,tick:null},boss_timer:{init:!1,tick:null},boss_ftime:{init:!1,tick:null},flower:{init:!1,tick:null},top20:{init:!1,tick:null},work_refresh:{init:!1,tick:null},work_wait:{init:!1,tick:null},work_work:{init:!1,tick:null},sale:{init:!1,tick:null},doping:{init:!1,tick:null},ny:{init:!1,tick:null},trash:{init:!1,tick:null},lut:{init:!1,tick:null},city:{init:!1,tick:null},custom:{init:!1,tick:[]}},this.interval=setInterval((()=>{this.tick()}),100)}tick(){let t=(new Date).getTime(),e=Math.floor((t-this.start_t)/1e3);if(TIME+=e,!e)return;this.start_t=t;let s=new Date;if(this.utc_diff=Math.floor(s.getTimezoneOffset()/60)+3,DATE=new Date(1e3*(TIME+3600*this.utc_diff)),SEASON=["winter","spring","summer","autumn"][parseInt((DATE.getMonth()+1)/3)%4],this.timers.energy.init&&this.timers.energy.tick(this.energyControl()),this.timers.hobo.init&&this.timers.hobo.tick(this.hoboControl()),this.timers.boss_limit.init&&this.timers.boss_limit.tick(this.bossLimitControl()),this.timers.boss_timer.init&&this.timers.boss_timer.tick(this.bossTimerControl()),this.timers.boss_ftime.init&&this.timers.boss_ftime.tick(this.bossControl()),this.timers.flower.init&&this.timers.flower.tick(this.flowerControl()),this.timers.top20.init&&this.timers.top20.tick(this.top20Control()),this.timers.work_refresh.init&&this.timers.work_refresh.tick(this.workRefreshControl()),this.timers.work_wait.init&&this.timers.work_wait.tick(this.workWaitControl()),this.timers.work_work.init&&this.timers.work_work.tick(this.workWorkControl()),this.timers.free.init&&this.timers.free.tick(this.dopingControl()),this.timers.sale.init&&this.timers.sale.tick(this.saleControl()),this.timers.ny.init&&this.timers.ny.tick(this.nyControl()),this.timers.trash.init&&this.timers.trash.tick(this.trashControl()),this.timers.lut.init&&this.timers.lut.tick(this.lutControl()),this.timers.city.init&&this.timers.city.tick(this.cityControl()),this.timers.custom.init)for(let t=0;t<this.timers.custom.tick.length;t++)this.timers.custom.tick[t](this.customControl())}energyControl(){if(parseInt(udata.energy)>=parseInt(udata.emax))return{status:"max"};let t=Math.floor((TIME-parseInt(udata.etime))/udata.energytimer),e=0;return t<0?void 0:(t>parseInt(udata.emax)-parseInt(udata.energy)&&(t=parseInt(udata.emax)-parseInt(udata.energy)),udata.energy=parseInt(udata.energy)+t,parseInt(udata.energy)>=parseInt(udata.emax+udata.emax_bonus)?(udata.energy=udata.emax+udata.emax_bonus,udata.etime=TIME,{status:"plus",time:0}):(e=(t+1)*udata.energytimer-(TIME-parseInt(udata.etime)),t>0?(udata.etime=TIME-(udata.energytimer-e),{status:"plus",time:e}):{status:"tick",time:e}))}hoboControl(){if(parseInt(udata.hobo)>=5)return{status:"max"};let t=Math.floor((TIME-parseInt(udata.hobotime))/parseInt(udata.hobotimer)),e=0;return t>5-parseInt(udata.hobo)&&(t=5-parseInt(udata.hobo)),udata.hobo=parseInt(udata.hobo)+t,parseInt(udata.hobo)>=5?(udata.hobo=5,udata.hobotime=TIME,{status:"plus",time:0}):(e=(t+1)*parseInt(udata.hobotimer)-(TIME-parseInt(udata.hobotime)),t>0?(udata.hobotime=TIME-(parseInt(udata.hobotimer)-e),{status:"plus",time:e}):{status:"tick",time:e})}bossLimitControl(){let t=TIME-udata.ftimer;return t>=udata.bosslimittimer?{status:"max"}:{status:"tick",time:udata.bosslimittimer-t}}bossControl(){let t=fights.data.all_time-(TIME-fights.data.time);return t<=0?{status:"max"}:{status:"tick",time:t}}bossTimerControl(){if(9==fights.data.timer)return{status:"max"};let t=weapons[fights.data.timer]-(TIME-fights.data.ttime);return t<=0?{status:"max"}:{status:"tick",time:t}}flowerControl(){let t=TIME-udata.flower_time;return t>=udata.flowertimer?{status:"max"}:{status:"tick",time:udata.flowertimer-t}}top20Control(){let t=TIME-padik.top20_data.time;return t>=604800?{status:"max"}:{status:"tick",time:604800-t}}workRefreshControl(){if(!works.work_info.ids)return{status:"max"};let t=TIME-works.work_info.ids[works.work_info.ids.length-1];return t>=900?{status:"max"}:{status:"tick",time:900-t}}workWaitControl(){if(!works.work_info.info)return{status:"max"};let t=TIME-works.work_info.info.time;return t>=180?{status:"max"}:{status:"tick",time:180-t}}workWorkControl(){if(!works.work_info.info)return{status:"max"};let t=TIME-works.work_info.info.time;return t>=1380?{status:"max"}:{status:"tick",time:1380-t}}saleControl(){let t=1610226e3-TIME;return t<=0?{status:"max"}:{status:"tick",time:t}}nyControl(){let t=1641762e3-TIME;return t<=0?{status:"max"}:{status:"tick",time:t}}dopingControl(){let t=86400-(TIME-udata.freetime);return t<=0?{status:"max"}:{status:"tick",time:t}}trashControl(){let t=udata.flower_lifetime-(TIME-udata.flower_time);return t<=0?{status:"max"}:{status:"tick",time:t}}customControl(){return{status:"tick",time:TIME,date:DATE}}cityControl(){return{status:"tick",time:TIME,date:DATE}}umenControl(){let t=umen.all_timer-(TIME-umen.timer);return t<=0?{status:"max"}:{status:"tick",time:t}}},window.HYSTORY=[],window.TOBACK=!1,window.helper=new class{constructor(){this.all_points=[],this.d=30,this.draw_coef=15,this.diag_coef=this.d-this.d/Math.PI,this.links=[],this.blows=[],this.ivls=[],this.c_movs=[],this.setup_element=[]}checkLastDate(t,e,s=!1){return[this.getUnixDay(t,s),this.getUnixDay(this.nextDay(e),s)]}copyJSON(t){return JSON.parse(JSON.stringify(t))}getUnixDay(t,e=!1){let s=days.indexOf(t),i=new Date(1e3*(TIME+3600*TIMERS.utc_diff)),o=s-DATE.getDay();return o+=o>=0?0:7,i.setDate(DATE.getDate()+o),i.setHours(12,0,0,0),TIME>Math.floor(i.getTime()/1e3-3600*TIMERS.utc_diff)&&i.setDate(DATE.getDate()+7),e&&console.log(i),Math.floor(i.getTime()/1e3-3600*TIMERS.utc_diff)}nextDay(t){let e=days.indexOf(t)+1;return e==days.length&&(e=0),days[e]}getUnlim(t){let e=bosses[t],s=udata.boss_unlim[t],i=e.unlim[0];if(-1!=e.unlim[2]){let t=parseInt(e.unlim[2])-1,o=e.unlim[1];for(let e=0;e<t&&!(s>=10*e&&s<10*(e+1));e++)i+=Math.floor(i*(o/1e3))}return i}clickControl(t,e,s,i){t.on("pointerdown",(s=>{e&&e(s),t.dn_trig=!0,i&&this.ivls.push(setInterval((()=>{for(let t=0;t<this.ivls.length;t++)clearInterval(this.ivls[t]);t.dn_trig=!1,i(s)}),200))})),t.on("pointerup",(e=>{s&&t.dn_trig&&s(e)}))}bgConstructor(t,e){let s=e.bgs_info[e.bg]||0;if(!s)return;let i=Object.keys(s),o=t["bg"+(parseInt(e.bg)+1)];for(let t=0;t<i.length;t++)if(s[i[t]].f&&o[i[t]].gotoAndStop(s[i[t]].f),s[i[t]].v&&(o[i[t]].visible=Boolean(s[i[t]].v)),s[i[t]].shop_id){let e=s[i[t]].shop_id,a=s[i[t]].timer,n=bgs_info.shop[e].bonus;TIME-parseInt(a)<parseInt(n.timing)-parseInt(udata.mandat_bonuses_custom)&&(o[i[t]].visible=!1)}}timeString(t,e=!1,s=!0){let i=t,o=parseInt(i/60),a=parseInt(o/60),n=parseInt(a/24);return i%=60,o%=60,e?(i%=60,o%=60,a%=24,n+"д "+a+"ч "+o+"мин "+i+"сек"):s?this.getZeros(a)+":"+this.getZeros(o)+":"+this.getZeros(i):this.getZeros(o)+":"+this.getZeros(i)}shortText(t,e=!0){let s=["","K","M","B","T","q"],i=[1,1e3,1e6,1e9,1e12,1e15],o=i.length-1;for(;t/i[o]<1&&o>0;)o--;let a=t/i[o];return e?Math.round(100*a)/100+s[o]:Math.round(a)+s[o]}animateEl(t,e){if((-1===this.setup_element.indexOf(e)||"start"!=t)&&("stop"==t&&this.setup_element.splice(0,this.setup_element.indexOf(e)+1),"start"==t)){let t=()=>{-1!=this.setup_element.indexOf(e)&&this.alphaAnimation(e,.3,300,s)},s=()=>{this.alphaAnimation(e,1,300,t)};this.alphaAnimation(e,.3,300,s),this.setup_element.push(e)}}clearButton(t){t.buttonMode=!1,t._events={}}alphaAnimation(t,e=1,s=100,i=null){let o=Math.floor(performance.now()),a=s,n=t.alpha;if(n==e)return void(i&&i());let h=setInterval((()=>{let s=(Math.floor(performance.now())-o)/a;t.alpha=n<e?n+(e-n)*s:n-(n-e)*s,s>=1&&(t.alpha=e,t.alpha>1&&(t.alpha=1),t.alpha<0&&(t.alpha=0),clearInterval(h),i&&i())}),1)}loadNames(t,e=null){let s=[],i=[];"object"!=typeof t&&(t=[t]);for(let e=0;e<t.length;e++){let o=VK_names.id.indexOf(t[e]);-1!==o?s.push({id:VK_names.id[o],first_name:VK_names.first_name[o],last_name:VK_names.last_name[o],photo_50:VK_names.photo_50[o]}):i.push(t[e])}i.length?bridge.sendPromise("VKWebAppCallAPIMethod",{method:"users.get",params:{fields:"photo_50",user_ids:i.join(),access_token:VK_token,v:VK_version}}).then((t=>{for(let e=0;e<t.response.length;e++)VK_names.id.push(t.response[e].id),VK_names.first_name.push(t.response[e].first_name),VK_names.last_name.push(t.response[e].last_name),VK_names.photo_50.push(t.response[e].photo_50),s.push({id:t.response[e].id,first_name:t.response[e].first_name,last_name:t.response[e].last_name,photo_50:t.response[e].photo_50});e&&e(s)})):e&&e(s)}loadPhoto50(t,e=null,s=null){let i=bitmaps50.id.indexOf(t);return-1!==i&&(s=bitmaps50.bm[i]),s?s!==null_photo50&&s.split("userapi.com").length<2?(bitmaps50.id.push(t),bitmaps50.bm.push(null_photo50),this.loadPhoto50(t,e,null_photo50)):void(e&&e(new PIXI.Sprite.from(s))):bridge.sendPromise("VKWebAppCallAPIMethod",{method:"users.get",params:{fields:"photo_50",user_ids:t,access_token:VK_token,v:VK_version}}).then((s=>{this.loadPhoto50(t,e,s.response[0].photo_50),bitmaps50.id.push(t),bitmaps50.bm.push(s.response[0].photo_50)}))}loadPhoto100(t,e=null,s=null){return s?s!==null_photo100&&s.split("userapi.com").length<2?this.loadPhoto100(t,e,null_photo100):void(e&&e(new PIXI.Sprite.from(s))):bridge.sendPromise("VKWebAppCallAPIMethod",{method:"users.get",params:{fields:"photo_100",user_ids:t,access_token:VK_token,v:VK_version}}).then((s=>{this.loadPhoto100(t,e,s.response[0].photo_100)}))}loadPhoto200(t,e=null,s=null){return s?s!==null_photo200&&s.split("userapi.com").length<2?this.loadPhoto200(t,e,null_photo200):void(e&&e(new PIXI.Sprite.from(s))):bridge.sendPromise("VKWebAppCallAPIMethod",{method:"users.get",params:{fields:"photo_200",user_ids:t,access_token:VK_token,v:VK_version}}).then((s=>{this.loadPhoto200(t,e,s.response[0].photo_200)}))}linkControl(t){if(this.links[t])return this.links[t];let e="https://vk.com/app"+vk_params.api_id+"#"+t;bridge.sendPromise("VKWebAppCallAPIMethod",{method:"utils.getShortLink",params:{url:e,access_token:VK_token,v:VK_version}}).then((e=>{this.links[t]=e.response.short_url}))}goLocation(t){4==t?iface.showDop():iface.hideDop(),window.TOBACK||HYSTORY[HYSTORY.length-1]==t?window.TOBACK=!1:(HYSTORY[HYSTORY.length-2]==t&&HYSTORY.splice(-2),HYSTORY.push(t),HYSTORY.length>1?window.iface.showBack():window.iface.hideBack())}backLocation(){if(window.TOBACK=!0,HYSTORY.splice(-1),1==HYSTORY.length)return-1}getJSON(t,e,s){let i=new XMLHttpRequest;i.open("GET",t+"?h="+session_hash),i.responseType="json",i.send(),i.addEventListener("loadend",(()=>{4===i.readyState&&200===i.status?e(i.response):s(errors[1])}))}numberAnimation(t,e,s,i=!0,o="",a=null,n=","){if(t.text==this.shortText(e)+o)return void(a&&a());let h=Math.floor(performance.now()),l=0;l=""==o?parseInt(this.getValue(t.text,n)):parseInt(this.getValue(t.text.split(o)[0],n));let r=parseInt(e),m=s,_=setInterval((()=>{let e=(Math.floor(performance.now())-h)/m;t.text=r<l?i?this.shortText(parseInt(l-(l-r)*e),n)+o:this.shortText(parseInt(l-(l-r)*e))+o:i?this.shortText(parseInt(l+(r-l)*e),n)+o:this.shortText(parseInt(l+(r-l)*e))+o,e>=1&&(t.text=i?this.shortText(r,n)+o:this.shortText(r)+o,clearInterval(_),a&&a())}),1)}scaleAnimation(t,e,s,i="x"){let o=Math.floor(performance.now()),a=t.scale[i],n=e,h=s,l=setInterval((()=>{let e=(Math.floor(performance.now())-o)/h;t.scale[i]=n<a?a-(a-n)*e:a+(n-a)*e,e>=1&&(t.scale[i]=n,clearInterval(l))}),1)}fadeAnimation(t,e="none",s=100,i=null){let o=Math.floor(performance.now()),a=s,n=setInterval((()=>{let s=(Math.floor(performance.now())-o)/a;switch(e){case"fadeIn":t.alpha=s,t.visible=!0;break;case"fadeOut":t.alpha=1-s}(s>=1||"none"==e)&&("fadeOut"==e&&(t.visible=!1),t.alpha>1&&(t.alpha=1),t.alpha<0&&(t.alpha=0),clearInterval(n),i&&i())}),1)}getNumberRazdel(t,e=","){let s=[],i="";s=t.toString().split("");for(let t=1;3*t<s.length;t++)s[s.length-3*t]=e+s[s.length-3*t];return i=s.join(""),i}getNumber(t,e=","){return this.shortText(t)}getValue(t,e=","){return parseInt(t.split(e).join(""))}getLevel(t){let e=0;for(let s=0;s<levels.length;s++)parseInt(t)>=parseInt(levels[s])&&e++;return e}getExp(t){return 10*(Math.pow(2,t)-1)}getMinigamesLevel(t){let e=0;for(let s=0;s<mlevels.length;s++)parseInt(t)>=parseInt(mlevels[s])&&e++;return e}getZeros(t){let e="";return e=t<10?"0"+t:+t,e}randomChotko(){let t={};switch(Math.floor(4*Math.random())){case 0:t.rotation=90,t.x=0,t.newX=90,t.y=t.newY=63+Math.floor(604*Math.random());break;case 1:t.rotation=0,t.x=t.newX=63+Math.floor(664*Math.random()),t.y=760,t.newY=670;break;case 2:t.rotation=-90,t.x=760,t.newX=670,t.y=t.newY=63+Math.floor(604*Math.random());break;case 3:t.rotation=180,t.x=t.newX=63+Math.floor(664*Math.random()),t.y=0,t.newY=90}return t}numberEnd(t){let e=[],s="";return e=t.toString().split(""),s=2!=e[e.length-1]&&3!=e[e.length-1]&&4!=e[e.length-1]||0===t||12===t||13===t||14===t?"раз":"раза",s}numberEndFlower(t,e){let s={bita:["биту","биты","бит"],days:["день","дня","дней"],hours:["час","часа","часов"],minutes:["минута","минуты","минут"],seconds:["секунда","секунды","секунд"],gold:["рубль","рубля","рублей"],roza:["розочку","розочки","розочек"],travmat:["травмат","травмата","травматов"],votes:["голос","голоса","голосов"],leafs:["лист","листа","листов"]},i=[],o="";return i=t.toString().split(""),o=2!=i[i.length-1]&&3!=i[i.length-1]&&4!=i[i.length-1]||0===t||12===t||13===t||14===t?1==i[i.length-1]&&11!==t?s[e][0]:s[e][2]:s[e][1],o}animatePrice(t,e,s,i,o,a,n=570,h=0,l=220){let r=Math.ceil(e/5),m=[],_=[-1,1],c=null,d=setInterval((()=>{clearInterval(d);for(let e=0;e<m.length;e++)this.fadeAnimation(m[e],"fadeOut",1e3),m[e].constructor==t.constructor?gsap.to(m[e],{duration:1,x:n,y:h,ease:"power1.out"}):gsap.to(m[e],{duration:1,x:l,y:h,ease:"power1.out"});d=setInterval((()=>{for(let t=0;t<m.length;t++){let t=m.pop();t.stage&&a.removeChild(t)}clearInterval(d)}),1e3)}),700);for(let e=0;e<r;e++)c=this.duplicate(t),c.x=i,c.y=o,a.addChild(c),m.push(c),gsap.to(c,{duration:.5,x:i+40*Math.random()*_[Math.floor(2*Math.random())],y:o+30*Math.random()+20,ease:"bounce.out"})}animFlower(t,e){let s=[],i=[-1,1],o=[modules.names.garage.flower_bit.constructor,modules.names.garage.flower_travm.constructor,modules.names.garage.flower_but.constructor,modules.names.garage.flower_rub.constructor],a=171,n=361,h=null,l=setInterval((()=>{clearInterval(l);for(let t=0;t<s.length;t++)this.fadeAnimation(s[t],"fadeOut",1e3),s[t].constructor==o[3]?gsap.to(s[t],{duration:1,x:570,y:0,ease:"power1.out"}):gsap.to(s[t],{duration:1,x:380,y:760,ease:"power1.out"});l=setInterval((()=>{for(let e=0;e<s.length;e++){let e=s.pop();e.stage&&t.removeChild(e)}clearInterval(l)}),1e3)}),700);for(let l=0;l<e.length;l++)if(e[l]>=15)for(let e=0;e<5;e++)h=new o[l],h.x=a,h.y=n,t.addChild(h),s.push(h),gsap.to(h,{duration:.5,x:a+40*Math.random()*i[Math.floor(2*Math.random())],y:n+30*Math.random()+20,ease:"bounce.out"});else for(let r=0;r<Math.floor(e[l]/3);r++)h=new o[l],h.x=a,h.y=n,t.addChild(h),s.push(h),gsap.to(h,{duration:.5,x:a+40*Math.random()*i[Math.floor(2*Math.random())],y:n+30*Math.random()+20,ease:"bounce.out"})}blowController(t,e,s){this.blows[t]=[e,s,[]];for(let e=0;e<this.blows[t][0].length;e++)this.blows[t][0][e].on("mouseover",(e=>{this.blows[t][1].alpha<1&&this.alphaAnimation(this.blows[t][1])})),this.blows[t][0][e].on("mouseout",(e=>{let s=this.blows[t][0].indexOf(e.currentTarget);1==this.blows[t][1].alpha&&this.alphaAnimation(this.blows[t][1],0),void 0===this.blows[t][2][s]&&this.blows[t][2].push(setInterval((()=>{let e;for(e=0;e<this.blows[t][0].length&&!this.mouseTest(this.blows[t][0][e]);e++);e==this.blows[t][0].length&&(clearInterval(this.blows[t][2][s]),this.blows[t][2].splice(s,1),this.alphaAnimation(this.blows[t][1],0))}),500))}))}tooltipControl(t,e,s,i,o){if(this.tooltip_bool=!0,clearInterval(this.tooltip_timer),this.tooltip_timer=setInterval((()=>{clearInterval(this.tooltip_timer),this.tooltip_timer=null,this.tooltip_bool=!1}),2*i),o)for(let t=0;t<o.length;t++)o[t].alpha>.5&&this.fadeAnimation(o[t],"fadeOut",150);this.tooltipTimeout(t,e,s,i,o,e),this.tooltipTimeout(e,t,s,i,o,e)}tooltipTimeout(t,e,s,i,o,a){t._events.mouseover||t.on("mouseover",(()=>{clearInterval(e.int),e.int=null})),t._events.mouseout||t.on("mouseout",(()=>{t.int||(t.int=setInterval((()=>{this.tooltip_bool||(clearInterval(t.int),t.int=null,this.mouseTest(t)||this.mouseTest(e)||gsap.to(a,{duration:.3,y:s,onComplete:()=>{if(o)for(let t=0;t<o.length;t++)o[t].alpha<.5&&this.fadeAnimation(o[t],"fadeIn",150)}}))}),i))}))}duplicate(t){return new t.constructor}encode64(t){return btoa(unescape(encodeURIComponent(t)))}decode64(t){try{return decodeURIComponent(escape(window.atob(t)))}catch(e){return t}}parse(t){let e=[];try{e=JSON.parse(t)}catch(t){}return e}hitTest(t,e){let s,i=!1;return t.x+t.width>=e.x&&t.x<=e.x+e.width&&(s=!0),t.y+t.height>=e.y&&t.y<=e.y+e.height&&(i=!0),!!(s&i)}mouseTest(t){let e,s=!1;return mouseXY.x>=t.worldTransform.tx&&mouseXY.x<=t.worldTransform.tx+t.width&&(e=!0),mouseXY.y>=t.worldTransform.ty&&mouseXY.y<=t.worldTransform.ty+t.height&&(s=!0),!!(e&s)}isComplete(t,e){return(e&t)===t}objects(t,e){let s;for(s in e)t[s]=e[s];for(s in t)t[s]=e[s];return t}},window.modules=new class{constructor(){this.flags={},this.names={},this.unical={}}load(t,e){window[content_links[t]].setup(PIXI.animate),scene.load(window[content_links[t]],(s=>{this.flags[t]=!0,this.names[t]=s,this.nulledXY(s),e&&e()}))}loadInterface(t){this.load("interface",t)}loadHome(t){this.load("home",t)}loadMenu(t){this.load("menu",t)}loadFights(t){this.load("fights",t)}loadNotify(t){this.load("notify",t)}loadBank(t){this.load("bank",t)}loadCity(t){this.load("city",t)}loadMini(t){this.load("mini",t)}loadAchives(t){this.load("achives",t)}loadDoping(t){this.load("doping",t)}loadArmor(t){this.load("armor",t)}loadShop(t){this.load("shop",t)}loadGarage(t){this.load("garage",t)}loadNy(t){this.load("ny",t)}loadColl(t){this.load("coll",t)}loadPit(t){this.load("pit",t)}loadWears(t){window[content_links.wears].setup(PIXI.animate),scene.load(window[content_links.wears],(e=>{this.flags.wears=!0,this.names.wears=e,window.stock_wears=[new PIXI.Container,e.stok1_mc,e.stok2_mc,e.stok3_mc,new PIXI.Container],window.shop_wears=[],window.icon_wears=[],this.nulledXY(e.wears_mc),this.nulledXY(e.wear_icons);for(let t=0;t<wears.w.length;t++)shop_wears[t]=e.wears_mc["w"+t],icon_wears[t]=e.wear_icons["w"+t];t&&t()}))}loadService(t){window[content_links.service].setup(PIXI.animate),scene.load(window[content_links.service],(e=>{this.flags.service=!0,this.names.service=e,this.nulledXY(e),TS.mc=this.names.service.semka_mc,TS.mc.interactive=!0,TS.mc.visible=!1,t&&t()}))}loadSound(t){window[content_links.sound].setup(PIXI.animate),window.sound_loader=scene.load(window[content_links.sound],(e=>{this.flags.sound=!0,this.names.sound=e,t&&t()}))}constructInterface(){window.iface=new t(this.names.interface.iface_up,this.names.interface.iface_down,this.names.interface.iface_islot,this.names.interface.iface_fslot,this.names.interface.iface_nn,this.names.interface.iface_regmusic,this.names.interface.iface_screen,this.names.interface.iface_obmen,this.names.interface.iface_chotko,this.names.interface.iface_kalmar,this.names.interface.iface_23feb),this.unical.close=modules.names.interface.iface_obmen.win.close_mc,this.unical.light=modules.names.interface.light_anim,this.unical.mnd_ico=modules.names.interface.iface_up.dop_info.stats_mc.mnd_ico,this.unical.exp=modules.names.interface.iface_up.dop_info.stats_mc.exp_mc}constructHome(){window.padik=new e(this.names.home.padik_full,this.names.home.padik_bgs,this.names.home.padik_top20,this.names.home.padik_top20_slot,this.names.home.padik_customize,this.names.home.padik_customize_slot),window.guest=new s(this.names.home.padik_full,this.names.home.padik_bgs),window.calendar=new y(this.names.home.padik_bonus),this.unical.check=modules.names.home.padik_full.blow_mc.buttons_mc.ok_mc,this.unical.arrows=modules.names.home.padik_top20.win.arrows_mc,this.unical.wood_shadow=modules.names.home.padik_top20.shadow_box}constructService(){window.learn=new i.Z(this.names.service.learn_full)}constructSound(){}constructWears(){}constructMenu(){window.main_menu=new o(this.names.menu.menu_full,this.names.menu.menu_mg)}constructFights(){window.mandats=new a(this.names.fights.mandats_full),window.fights=new n(this.names.fights.fight_full,[this.names.fights.fight_bg1,this.names.fights.fight_bg2,this.names.fights.fight_bg3,this.names.fights.fight_bg1,this.names.fights.fight_bg3,this.names.fights.fight_bg1,this.names.fights.fight_bg4,this.names.fights.fight_bg5,this.names.fights.fight_bg6,this.names.fights.fight_bg1,this.names.fights.fight_bg1,this.names.fights.fight_bg1,this.names.fights.fight_bg7,this.names.fights.fight_bg8,this.names.fights.fight_bg9,this.names.fights.fight_bg10,this.names.fights.fight_bg1,this.names.fights.fight_bg1,this.names.fights.fight_bg1,this.names.fights.fight_bg1],[this.names.fights.fight_boss1,this.names.fights.fight_boss2,this.names.fights.fight_boss3,this.names.fights.fight_boss4,this.names.fights.fight_boss5,this.names.fights.fight_boss6,this.names.fights.fight_boss7,this.names.fights.fight_boss8,this.names.fights.fight_boss9,this.names.fights.fight_boss10,this.names.fights.fight_boss11,this.names.fights.fight_boss12,this.names.fights.fight_boss13,this.names.fights.fight_boss14,this.names.fights.fight_boss15,this.names.fights.fight_boss16,this.names.fights.fight_boss17,this.names.fights.fight_boss18,this.names.fights.fight_boss19,this.names.fights.fight_boss20],this.names.fights.fight_exit,this.names.fights.combo_full,this.names.fights.combo_gift,this.names.interface.iface_obmen_fight,this.names.fights.combo_true_an,this.names.fights.box_donat_mc,this.names.fights.box_donat_mc.panel_mc.slot_mc,this.names.fights.kalmar_top50,this.names.fights.kalmar_top50_slot),window.fights_windows=new h(this.names.menu.menu_selector,this.names.menu.menu_selector_slot,this.names.menu.menu_windef,this.names.menu.menu_windef_slot,this.names.menu.menu_craft,this.names.fights.fight_exit,this.names.fights.fight_donat),window.umen=new k(this.names.fights.umen_full,this.names.fights.umen_icon,this.names.fights.umen_cat,this.names.fights.umen_popup)}constructNotify(){window.notify=new l(this.names.notify.notify_noenergy,this.names.notify.notify_result,this.names.notify.notify_completeloc,this.names.notify.notify_noweapon,this.names.notify.notify_reload,this.names.notify.notify_nomoney,this.names.notify.notify_buywear,this.names.notify.notify_newlevel,this.names.notify.notify_accept)}constructBank(){window.bank=new r(this.names.bank.atm_full,this.names.interface.iface_obmen,this.names.bank.atm_semki,this.names.bank.atm_semki_slot)}constructCity(){window.map=new _(this.names.city.map_full,[this.names.city.map_loc1,this.names.city.map_loc2,this.names.city.map_loc3,this.names.city.map_loc4,this.names.city.map_loc5]),window.works=new c(this.names.city.work_full,this.names.city.work_neutral,this.names.city.work_def,this.names.city.work_win,this.names.city.work_level,this.names.city.work_slot),window.city=new m(this.names.city.city_full,[this.names.city.city_bg1,this.names.city.city_bg2,this.names.city.city_bg3,this.names.city.city_bg4,this.names.city.city_bg5],this.names.city.city_pmp)}constructMini(){window.kanobu=new d(this.names.mini.knb_full),window.naperstki=new p(this.names.mini.naperstki_full)}constructAchives(){window.achives=new u(this.names.achives.achives_movie,this.names.achives.achives_slot,this.names.achives.achives_down_slot,this.names.achives.achives_new)}constructDoping(){window.doping=new w(this.names.doping.doping_full,this.names.doping.doping_open)}constructArmor(){window.armor=new b(this.names.armor.armor_full)}constructShop(){window.shop=new f(this.names.shop.shop_full,this.names.shop.shop_slot,this.names.shop.shop_pers)}constructGarage(){window.garage=new x(this.names.garage.garage_full,this.names.garage.garage_wears),window.flower=new g(this.names.garage.flower_full)}constructNy(){window.ny=new NewYear(this.names.ny.newyear_full,[this.names.ny.newyear_star1,this.names.ny.newyear_star2],[this.names.ny.newyear_toy1,this.names.ny.newyear_toy2,this.names.ny.newyear_toy3,this.names.ny.newyear_toy4,this.names.ny.newyear_toy5,this.names.ny.newyear_toy6,this.names.ny.newyear_toy7,this.names.ny.newyear_toy8,this.names.ny.newyear_toy9],[this.names.ny.newyear_toy10,this.names.ny.newyear_toy11,this.names.ny.newyear_toy12,this.names.ny.newyear_toy13],this.names.ny.newyear_slot,this.names.ny.newyear_buysnow,this.names.ny.box)}constructColl(){window.collections=new v(this.names.coll.coll_full,this.names.coll.coll_win1,this.names.coll.coll_win2,this.names.coll.coll_win3,this.names.coll.coll_slot,this.names.coll.coll_items,this.names.coll.coll_search),padik.gifts_log=this.names.coll.coll_glog,padik.gifts_log_slot=this.names.coll.coll_glog_slot,padik.gifts_log_def_photo=this.names.coll.coll_glog_def_photo,padik.gifts_log.interactive=!0,setButton(padik.gifts_log.win.close_mc),setButton(padik.gifts_log.win.prev_mc),setButton(padik.gifts_log.win.next_mc)}constructPit(){window.pit=new S(this.names.pit.fights_pit,this.names.pit.fights_pit.bosses.slot_bosses)}nulledXY(t){let e=Object.keys(t);for(let s=0;s<e.length;s++)null!==t[e[s]]&&"object"==typeof t[e[s]]&&(t[e[s]].x=t[e[s]].y=0);for(;t.children.length;)t.removeChildAt(0)}checkFlags(t,e){for(let s=0;s<t.length;s++)if(!this.flags[t[s]])return TS.mc&&(TS.mc.visible=!0),void this["load"+this.ucFirst(t[s])]((()=>{this["construct"+this.ucFirst(t[s])]&&this["construct"+this.ucFirst(t[s])](),TS.mc&&(TS.mc.visible=!1),this.checkFlags(t,e)}));e&&e()}ucFirst(t){return t?t[0].toUpperCase()+t.slice(1):t}},window.sounds=new class{constructor(){this.names={back:["zkd105"],chotko:["chotko_1"],krasava:["krasava","bombanul","goodjob","tatisho"],nahodka:["nahodka","nishtyak"],pomp:["pmpm"],learn:{zdarova:"zdar",fantasy:"fnts",avtoritet:"pmni",hary:"har",shop:"gtshp",shtany:"stnrs",terpila:"trp",baba:"babafght"},larek:["opacha"],hobo:["hobo1_S","hobo2_S","hobo3_S","hobo4_S","hobo5_S","hobo6_S","hobo7_S"],errors:["ne_tak","stoped","opanki","ne_torop"],shop:["fasion","fine_fine","nofasion"],weapons:["kirpich","noga","ruka","bitas","vistrel","butil","butil"],loshara:["pozor","loshara"],naperstki:["kruchu"],kanobu:["onetwo"],screen:["screen"],donat:["bank_take"],buba:["pomp"]},this.layer=new PIXI.animate.MovieClip}playBackMusic(){window.bg_music=PIXI.sound.Sound.from({url:"./sounds/"+this.names.back+".mp3",volume:localStore.music/100,loop:!0,autoPlay:!0})}playCustom(t){PIXI.sound&&-1!=t&&(window.custom_sound=PIXI.sound.Sound.from({url:"./sounds/"+t+".mp3",volume:1,autoPlay:!0,loop:!1}))}playKNB(){PIXI.sound&&this.layer.playSound(this.names.kanobu)}playLarek(){PIXI.sound&&this.layer.playSound(this.names.larek)}playBuba(){PIXI.sound&&this.layer.playSound(this.names.buba)}playNap(){PIXI.sound&&this.layer.playSound(this.names.naperstki)}playHobo(){PIXI.sound&&this.layer.playSound(this.names.hobo[Math.floor(Math.random()*this.names.hobo.length)])}playShop(){PIXI.sound&&this.layer.playSound(this.names.shop[Math.floor(Math.random()*this.names.shop.length)])}playError(t){PIXI.sound&&this.layer.playSound(this.names.errors[t])}playKrasava(){PIXI.sound&&this.layer.playSound(this.names.krasava[Math.floor(Math.random()*this.names.krasava.length)])}playWeapon(t){PIXI.sound&&this.layer.playSound(this.names.weapons[t])}playNahodka(){PIXI.sound&&this.layer.playSound(this.names.nahodka[Math.floor(Math.random()*this.names.nahodka.length)])}playLoshara(){PIXI.sound&&this.layer.playSound(this.names.loshara[Math.floor(Math.random()*this.names.loshara.length)])}playChotko(){PIXI.sound&&this.layer.playSound(this.names.chotko)}playScreen(){PIXI.sound&&this.layer.playSound(this.names.screen)}playDonat(){PIXI.sound&&this.layer.playSound(this.names.donat)}},window.TS=new class{constructor(t,e){this.arr=t,this.mc=e,this.scriptURL=this.arr[3]+"/universal.php",this.reqs=[],this.wait=!1,this.reqsJSON=[],this.req_key="srUjnhko",this.mc&&(this.mc.visible=!1,this.mc.interactive=!0,root.layer2_mc.addChild(this.mc))}php(t,e,s,i){this.reqs.push({m:t,p:e,c:s,e:i}),this.nextReq(),window.debug_mode&&(console.log(t),console.log(e))}nextReq(){this.wait||this.reqs.length<=0||(this.thisReq=this.reqs.shift(),this.loadReq(this.thisReq.m,this.thisReq.p),this.mc&&(this.mc.visible=!0,this.mc.semka_mc.gotoAndPlay(0)))}loadReq(t,e){this.MSS=new XMLHttpRequest,this.parameters=JSON.stringify(e),this.MSSURL=this.scriptURL+"?h="+md5(Math.floor(1e6*Math.random()).toString()),this.MSSparams="method="+t+"&api_id="+this.arr[0]+"&params="+btoa(btoa(this.parameters))+"&token="+this.token+"&uid="+this.arr[1]+"&user_id="+this.arr[4],this.MSSparams+="&auth="+this.arr[2],this.MSSparams+="&req_key="+this.req_key,this.MSS.open("POST",this.MSSURL,!0),this.MSS.setRequestHeader("Content-type","application/x-www-form-urlencoded"),this.MSS.send(this.MSSparams),this.MSS.addEventListener("loadend",(()=>this.completeRequest(this.MSS)))}completeRequest(t){if(4===this.MSS.readyState&&200===this.MSS.status)try{this.json=JSON.parse(this.MSS.response.toString().trim())}catch(t){this.json=errors[2],this.json.status="error"}else this.json=errors[1],this.json.status="error";window.debug_mode&&console.log(t),this.json.current_time&&(TIME=parseInt(this.json.current_time)),this.parseUD(),this.req_key=this.json.req_key,"error"==this.json.status?this.onError():this.onComplete(),this.mc&&(this.mc.visible=!1),this.nextReq()}onError(){Boolean(this.thisReq.e)&&this.thisReq.e(this.json)}onComplete(){Boolean(this.thisReq.c)&&this.thisReq.c(this.json)}parseUD(){this.json.udata&&(udata=this.json.udata),this.json.achives_counter&&(udata=this.json)}}([vk_params.api_id,vk_params.viewer_id,vk_params.auth_key,my_server,vk_params.user_id]),window.non_app_friends=[],window.damages=[7,13,20,30,50,300,20],window.bitmaps50={id:[],bm:[]},window.bitmaps100={id:[],bm:[]},window.bitmaps200={id:[],bm:[]},window.VK_names={id:[],first_name:[],last_name:[],photo_50:[]},window.my_photo50="",window.null_photo50=my_server+"/images/noicon.png",window.null_photo100=my_server+"/images/noicon100.png",window.null_photo200=my_server+"/images/noicon200.png",window.crossAdress="https://tolmasoft.com/crossdomain.xml?2",window.errors=[{text:"Undefined function",code:34},{text:"Invalid request",code:35},{text:"Output have invalid format",code:36}],window.endLoadGame=()=>{for(;root.children.length;)root.removeChildAt(0);for(let t=0;t<3;t++)root["layer"+t+"_mc"]=new PIXI.Container,root.addChild(root["layer"+t+"_mc"]);root.layer2_mc.addChild(TS.mc),root.on("pointerup",(()=>{for(let t=0;t<helper.ivls.length;t++)clearInterval(helper.ivls[t]);for(let t=0;t<helper.c_movs.length;t++)helper.c_movs[t].dn_trig=!1;helper.c_movs=[]})),iface.init(),padik.init()},window.loadGame=()=>{if(include("libs/pixi-textinput.js"),-1==window.testers.indexOf(vk_params.viewer_id)&&window.debug_mode)return void(pre_control.preloader.info_mc.info_txt.text="403 Forbidden!");let t=Boolean(window.localStore.preload)?["interface","home","wears","service","sound","menu","fights","notify","bank","city","mini","achives","doping","armor","shop","garage","coll","pit"]:["interface","home","wears","service","sound"];modules.checkFlags(t,(()=>{media_loaded=!0,!0===show_logo&&endLoadGame()}))},window.canv=document.createElement("canvas"),canv.setAttribute("width",760),canv.setAttribute("height",760),canv.setAttribute("id","stage"),canv.setAttribute("style","position: absolute;overflow: inherit;display: inline-block;"),document.body.appendChild(canv),((t=!1)=>{window.localStore=[];let e={music:15,sound:60,weapons:[0,0,0,0],semki:0,canvas:!1};var s;s=s=>{let i=(()=>{try{let t;return localStorage.setItem("test","test"),localStorage.removeItem("test"),t=!!localStorage.getItem("xuligame"),[!0,t]}catch(t){return window.incognito=!0,console.warn("Братишка, ты не разрешил мне хранить данные у тебя на компе. Уровень музыки и множители оружия сбросятся при перезагрузке игры"),[!1,!1]}})();s||i[0]||(window.localStore=e),s?window.localStore=helper.parse(s):i[1]&&(window.localStore=helper.parse(localStorage.getItem("xuligame"))),localStore.weapons&&null!=!localStore.semki||(localStore=e),saveLocalStorage(),t&&t()},bridge.sendPromise("VKWebAppCallAPIMethod",{method:"storage.get",params:{key:"xuligame",access_token:VK_token,v:VK_version}}).then((t=>{""==t.response[0].value?s(!1):s(helper.decode64(t.response[0].value)),console.log(helper.decode64(t.response[0].value))})).catch((t=>{s(!1)}))})((()=>{console.log(window.localStore.canvas),window.scene=new PIXI.animate.Scene({width:760,height:760,view:canv,antialias:!0,transparent:!0,autoDensity:!0,autoResize:!0,forceCanvas:Boolean(window.localStore.canvas)}),window.mouseXY=scene.renderer.plugins.interaction.mouse.global,window.preloader.setup(PIXI.animate),scene.load(window.preloader,(t=>{scene.stage.interactive=!0,window.root=scene.stage,pre_control=new I(t),helper.getJSON(my_server+"/json/links.json",(t=>M(t)),(t=>pre_control.onError(t))),pre_control.loadInfo("media")}))}));let M=t=>{window.content_links=t;let e=Object.keys(content_links);for(let t=0;t<e.length;t++)include("libs/"+content_links[e[t]]+".min.js?"+session_hash);B()};window.setButton=t=>{t.interactive=!0,t.buttonMode=!0,t._totalFrames=t._totalFrames||1,t._totalFrames<2||(t.gotoAndStop(0),t.on("mouseover",(()=>t.gotoAndStop(1))),t.on("mouseout",(()=>t.gotoAndStop(0))))},window.getLib=t=>new root[t].constructor,window.include=t=>{let e=document.createElement("script");e.src=t,e.type="text/javascript",document.getElementsByTagName("head")[0].appendChild(e)},window.include_preload=(t,e="font/ttf")=>{let s=document.createElement("link");s.rel="preload",s.href=t,s.as="font",s.type=e,s.crossorigin=!0,document.getElementsByTagName("head")[0].appendChild(s)},window.setTextStyle=(t,e={})=>{let s=Object.keys(e);for(let i=0;i<s.length;i++)t.style[s[i]]=e[s[i]]},window.saveLocalStorage=()=>{window.incognito||localStorage.setItem("xuligame",JSON.stringify(localStore)),bridge.sendPromise("VKWebAppCallAPIMethod",{method:"storage.set",params:{key:"xuligame",value:helper.encode64(JSON.stringify(localStore)),access_token:VK_token,v:VK_version}}).then((t=>{console.log("Success save local data")})).catch((t=>console.log(t)))},PIXI.settings.ROUND_PIXELS=!0,PIXI.animate.sound.on("play",(function(t,e){let s=PIXI.sound.Sound.from(sound_loader.resources[t]);s.loop=e,s.volume=localStore.sound/100,s.play()}))})()})();
//# sourceMappingURL=index.js.map