/*! For license information please see index.js.LICENSE.txt */
(()=>{"use strict";var __webpack_modules__={412:(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{Z:()=>Learn});class Learn{constructor(e){this.hand=e,this.initStyles()}init(){this.learn=new PIXI.Container,this.learn.down_mc=new PIXI.Container,this.hand.scale.x=this.hand.scale.y=window.devicePixelRatio,this.learn.addChild(this.learn.down_mc),this.learn.addChild(this.hand),root.layer2_mc.addChild(this.learn),this.learn.visible=!1,this.learn.down_mc.alpha=debug_mode?.4:.01,this.learn.down_mc.interactive=!0}check(){for(;this.learn.down_mc.children.length;)this.learn.down_mc.removeChildAt(0);for(let e=0;e<learn_cfg.triggers.length;e++)if(this.checkVars(learn_cfg.triggers[e].udata)&&this.checkLocals(learn_cfg.triggers[e].client_vars))return debug_mode&&console.log("trigger "+e+" activated"),this.constructStep(e);this.tikTak()}tikTak(){clearInterval(this.trim_ivl),gsap.killTweensOf(this.hand),this.nullPointer()}constructStep(e){gsap.killTweensOf(this.hand),this.constructDown(),this.hand.tf_txt.text=learn_cfg.triggers[e].text,this.showPointer(e),this.learn.parent||root.layer2_mc.addChild(this.learn),this.learn.visible=!0}showPointer(e){this.trimStart(e),this.constructHole(e)}trimStart(e){let t=this.countXY(e);debug_mode&&console.log(t),this.hand.anim.gotoAndPlay(0),this.num=e,gsap.to(this.hand,{duration:.7,x:t.x,y:t.y,ease:"expo.out",onComplete:()=>{this.hand.anim.gotoAndPlay(learn_cfg.triggers[e].pointer.type),learn_cfg.triggers[e].trim&&(this.trim_ivl=setInterval((()=>{clearInterval(this.trim_ivl),learn_cfg.triggers[this.num].trim&&this.trimMove(e)}),1e3))}})}trimMove(e){if(e!=this.num)return;let t=this.countXY(e,!0);gsap.to(this.hand,{duration:2,x:t.x,y:t.y,ease:"none",onComplete:()=>{this.hand.anim.gotoAndPlay(0),this.trim_ivl=setInterval((()=>{clearInterval(this.trim_ivl),e==this.num&&learn_cfg.triggers[this.num].trim&&this.trimStart(e)}),1e3)}})}constructDown(){let e=new PIXI.Graphics;e.beginFill(),e.drawRect(0,0,my_width,my_height),e.endFill(),this.learn.down_mc.addChild(e)}constructHole(e){let t=this.countXY(e);if(this.drawHole(t,e),!learn_cfg.triggers[e].trim)return;let s=learn_cfg.triggers[e].radius,i=this.countXY(e,!0),o=Math.abs(t.x-i.x),a=Math.abs(t.y-i.y);debug_mode&&console.log("x_dist = "+o),debug_mode&&console.log("y_dist = "+a);let r=t.x>=i.x?-1:1,l=t.y>=i.y?-1:1,n=Math.ceil(Math.max(o/s,a/s));debug_mode&&console.log("counter = "+n),o/=n*r,a/=n*l,debug_mode&&console.log("x_diff = "+o),debug_mode&&console.log("y_diff = "+a);for(let s=1;s<n;s++)this.drawHole({x:t.x+o*s,y:t.y+a*s},e)}drawHole(e,t){let s=this.learn.down_mc.children[0];debug_mode&&console.log(e),s.beginHole(),s.drawCircle(e.x,e.y,learn_cfg.triggers[t].radius*scale_coef),s.endHole()}checkVars(e){e=helper.toKeyVals(e);for(let t=0;t<e.keys.length;t++){let s=e.keys[t].split(" "),i=udata[s[0]];for(let e=1;e<s.length;e++)i=i[s[e]],i=i||0;if(i!=e.values[t])return!1}return!0}checkLocals(locals){locals=helper.toKeyVals(locals);for(let i=0;i<locals.keys.length;i++){let cls=locals.keys[i].split(".");if(!eval("window."+cls[0])&&!locals.values[i])continue;if(!eval("window."+cls[0])&&locals.values[i])return!1;let mov=eval(locals.keys[i]);if(Boolean(mov.parent)&&mov.visible&&!locals.values[i])return!1;if((!Boolean(mov.parent)||!mov.visible)&&locals.values[i])return!1}return!0}nullPointer(){for(clearInterval(this.trim_ivl),this.hand.anim.gotoAndPlay(0),gsap.to(this.hand,{duration:.7,x:my_width/2/scale_coef,y:-300*window.devicePixelRatio,ease:"expo.out",onComplete:()=>{this.learn.visible=!1}});this.learn.down_mc.children.length;)this.learn.down_mc.removeChildAt(0)}countXY(e,t=!1){let s=t?learn_cfg.triggers[e].trim:learn_cfg.triggers[e],i={x:0,y:0};switch(s.pointer.dx){case"center":i.x=my_width/2+s.pointer.x*scale_coef;break;case"left":i.x+=s.pointer.x*scale_coef;break;case"right":i.x=(my_width/scale_coef-s.pointer.x)*scale_coef}switch(s.pointer.dy){case"center":i.y=my_height/2+s.pointer.y*scale_coef;break;case"up":i.y+=s.pointer.y*scale_coef;break;case"down":i.y=(my_height/scale_coef-s.pointer.y)*scale_coef}return i}initStyles(){setTextStyle(this.hand.tf_txt,{miterLimit:2,stroke:"#333534",strokeThickness:5})}}}},__webpack_module_cache__={};function __webpack_require__(e){var t=__webpack_module_cache__[e];if(void 0!==t)return t.exports;var s=__webpack_module_cache__[e]={exports:{}};return __webpack_modules__[e](s,s.exports,__webpack_require__),s.exports}__webpack_require__.d=(e,t)=>{for(var s in t)__webpack_require__.o(t,s)&&!__webpack_require__.o(e,s)&&Object.defineProperty(e,s,{enumerable:!0,get:t[s]})},__webpack_require__.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t);var __webpack_exports__={};(()=>{class e{constructor(e){this.preloader=e,this.error_win=this.preloader.error_full,this.tree_params={Wm:556,Hm:460},this.ground_params={Wm:407,Hm:130},this.boby_params={Wm:0,Hm:74},this.korni_params={Wm:0,Hm:50},this.gmask_params={Wm:0,Hm:139},this.error_win.interactive=!0,window.my_width=window.innerWidth*window.devicePixelRatio,window.my_height=window.innerHeight*window.devicePixelRatio,this.cuts_loza=[],this.stebel1_params={magic:this.preloader.magic1_mc,Wm:0,Hm:34,w1:594,w2:648,w3:122,Wh:150,points:[[-17,-18,-18,-18,-19,-19,-19,-20,-20,-20,-21,-21,-22,-22,-22,-23,-23,-23,-24,-24,-24,-24,-25,-25,-26,-26,-26,-26,-26,-26,-26,-26,-26,-26,-26,-26,-26,-26,-26,-26,-26,-27,-27,-27,-27,-27,-27,-27,-27,-27,-27,-27,-27,-27,-27,-27,-27,-27,-27,-27,-26,-26,-25,-25,-25,-25,-24,-24,-24,-24,-23,-23,-23,-22,-21,-21,-21,-20,-20,-20,-19,-19,-19,-19,-18,-18,-18,-17,-17,-17,-17,-17,-17,-16,-16,-16,-16,-16,-15,-15,-15,-14,-14,-13,-13,-12,-12,-11,-11,-10,-9,-9,-8,-7,-7,-7,-6,-5,-5,-5,-4,-4,-4,-3,-3,-2,-1,-1,-1,-1,0,0,0,1,2,2,3,3,4,4,5,6,6,7,8,9,10,10,12,12,13,13,14,15,16,17,17,17,18,19,19,20,20,21,21,21,21,22,22,22,22,23,23,23,24,24,24,24,24,25,25,25,25,25,25,25,26,26,26,26,27,28,28,28,29,29,30,30,30,30,31,32,32,32,33,33,33,33,34,34,35,36,36,37,37,38,39,39,40,41,41,42,42,43,43,44,44,45,45,45,45,45,46,46,46,46,46,46,46,47,47,47,47,47,47,47,47,48,48,49,49,49,49,50,50,50,50,50,50,50,51,51,51,51,51,51,51,51,51,51,51,51,51,51,51,51,51,51,51,51,51,51,51,51,51,51,51,51,51,51,50,50,50,49,49,48,48,48,47,47,47,46,46,46,45,44,44,44,44,43,43,43,43,42,42,42,41,41,40,40,40,39,39,38,38,38,37,37,36,35,35,34,33,33,31,31,30,30,28,27,25,24,23,22,21,20,19,18,17,16,16,15,14,13,13,11,10,9,9,7,6,5,5,3,2,1,0,-1,-2,-3,-4,-5,-6,-7,-8,-8,-9,-10,-10,-10,-11,-11,-12,-12,-13,-14,-14,-15,-15,-16,-17,-17,-18,-19,-19,-20,-21,-22,-22,-23,-23,-24,-25,-26,-26,-27,-27,-28,-28,-29,-30,-31,-31,-32,-32,-32,-32,-33,-33,-33,-33,-33,-33,-34,-34,-34,-34,-35,-35,-35,-36,-36,-36,-36,-37,-37,-37,-38,-38,-38,-39,-39,-39,-39,-39,-39,-39,-39,-39,-39,-39,-39,-39,-39,-39,-39,-39,-38,-38,-38,-37,-37,-37,-36,-36,-35,-35,-34,-34,-33,-32,-32,-31,-30,-30,-29,-28,-28,-27,-27,-26,-25,-25,-24,-23,-23,-23,-22,-21,-21,-20,-20,-20,-19,-19,-18,-17,-17,-16,-16,-16,-15,-15,-15,-14,-14,-13,-13,-13,-13,-12,-12,-12,-11,-11,-11,-10,-10,-9,-8,-8,-8,-7,-7,-7,-6,-5,-5,-4,-4,-4,-3,-3,-3,2,-1,-1,0,0,0,1,1,1,3,3,3,4,4,5,5,5,6,6,6,7,7,8,8,8,8,8,8,9,9,9,9,10,10,10,11,12,12,12,12,13,13,13,13,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14],[11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,10,10,10,10,10,10,8,8,8,7,7,7,5,5,5,4,4,4,2,2,2,2,1,1,1,1,1,1,1,1,1,-2,-2,-2,-3,-3,-3,-5,-5,-5,-6,-6,-6,-8,-9,-9,-9,-11,-11,-12,-12,-12,-12,-14,-15,-15,-15,-17,-17,-17,-17,-17,-18,-18,-18,-20,-21,-21,-21,-21,-21,-23,-23,-23,-23,-24,-24,-24,-24,-25,-25,-25,-25,-25,-27,-27,-27,-27,-27,-27,-28,-28,-28,-28,-30,-30,-30,-30,-30,-31,-33,-33,-33,-33,-34,-34,-34,-34,-34,-34,-36,-36,-36,-36,-36,-36,-37,-37,-37,-37,-37,-39,-39,-39,-39,-39,-39,-39,-39,-40,-40,-40,-40,-40,-40,-40,-40,-40,-40,-40,-40,-40,-40,-40,-40,-40,-40,-40,-40,-40,-40,-40,-40,-40,-40,-40,-40,-40,-40,-39,-39,-39,-37,-37,-37,-37,-36,-36,-36,-36,-36,-34,-34,-34,-33,-31,-31,-30,-30,-28,-28,-27,-25,-25,-25,-24,-24,-23,-21,-21,-20,-18,-18,-17,-17,-17,-15,-14,-14,-12,-9,-9,-8,-6,-5,-5,-2,-2,-2,1,2,2,5,5,5,8,10,10,11,13,13,14,17,17,19,20,20,20,23,25,25,26,27,27,29,30,30,32,33,33,35,36,36,38,38,38,39,41,41,41,42,42,42,44,44,44,45,47,47,47,48,48,48,48,48,50,50,50,50,50,50,51,51,51,51,51,51,51,51,51,51,51,52,52,52,52,52,52,52,52,52,54,54,54,54,54,54,54,54,54,54,54,54,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,54,54,54,52,52,52,51,51,51,51,51,50,50,50,50,48,48,48,47,47,47,45,45,45,44,44,44,44,42,42,42,42,42,41,39,39,39,38,38,36,36,36,33,33,33,32,30,29,29,27,26,26,25,23,23,22,20,20,20,19,19,16,16,16,14,13,13,10,8,8,8,5,4,4,1,1,1,-2,-3,-3,-5,-6,-6,-8,-9,-9,-11,-12,-12,-12,-14,-14,-15,-15,-15,-17,-17,-18,-18,-21,-21,-21,-23,-23,-23,-24,-24,-24,-27,-28,-28,-28,-30,-30,-30,-31,-31,-33,-33,-33,-33,-34,-34,-34,-36,-36,-36,-36,-37,-37,-37,-39,-39,-39,-39,-39,-40,-40,-40,-40,-42,-42,-42,-42,-42,-42,-42,-42,-42,-42,-43,-43,-43,-45,-45,-45,-45,-45,-45,-45,-45,-45,-45,-45,-45,-45,-45,-45,-45,-45,-45,-45,-43,-43,-43,-42,-42,-40,-39,-39,-37,-37,-37,-36,-36,-36,-34,-34,-34,-34,-33,-33,-31,-31,-31,-31,-30,-30,-30,-28,-28,-28,-27,-27,-27,-25,-25,-25,-25,-24,-24,-24,-23,-23,-23,-23,-23,-21,-20,-20,-20,-18,-18,-18,-18,-18,-18,-17,-17,-17,-17,-15,-15,-14,-14,-14,-14,-12,-12,-12,-12,-12,-11,-11,-11,-9,-9,-8,-8,-8,-6,-6,-6,-5,-5,-3,-2,-2,-2,-2,-2,-2,1,1,1,1,1,2,2,2,4,5,5,5,5,7,7,7,7,7,7,8,8,8,8,8,8,8,8,10,10,10,11,11,11,11,11,11,11,11,11],[]]},this.stebel2_params={magic:this.preloader.magic2_mc,Wm:0,Hm:49,w1:512,w2:326,w3:198,Wh:150,points:[[-25,-25,-25,-25,-24,-23,-22,-22,-21,-21,-20,-20,-19,-18,-18,-18,-17,-17,-17,-17,-16,-16,-16,-16,-16,-15,-15,-14,-14,-14,-14,-14,-14,-14,-13,-13,-13,-13,-13,-13,-13,-13,-13,-13,-13,-13,-13,-13,-13,-13,-13,-13,-13,-13,-13,-13,-13,-13,-13,-12,-12,-12,-12,-12,-12,-12,-12,-12,-12,-12,-12,-12,-12,-13,-13,-13,-13,-13,-14,-14,-14,-14,-15,-15,-15,-15,-15,-16,-16,-16,-16,-16,-17,-17,-17,-17,-18,-18,-18,-18,-19,-19,-20,-20,-20,-21,-21,-21,-21,-22,-22,-22,-23,-23,-24,-24,-24,-24,-25,-25,-25,-25,-26,-26,-26,-27,-27,-27,-28,-28,-28,-28,-28,-29,-29,-29,-29,-29,-29,-29,-30,-30,-30,-30,-30,-30,-30,-30,-30,-30,-30,-30,-30,-30,-30,-30,-30,-31,-31,-31,-31,-31,-31,-31,-31,-31,-31,-31,-31,-32,-32,-32,-32,-32,-32,-32,-32,-32,-32,-32,-32,-32,-33,-33,-33,-33,-33,-33,-33,-33,-33,-33,-33,-33,-33,-33,-33,-33,-33,-33,-33,-33,-33,-33,-33,-33,-33,-33,-33,-33,-33,-33,-33,-32,-32,-32,-31,-31,-31,-31,-30,-30,-30,-29,-29,-29,-28,-28,-27,-26,-26,-25,-25,-24,-23,-23,-22,-22,-21,-21,-20,-19,-19,-18,-18,-18,-17,-17,-16,-16,-15,-14,-14,-14,-13,-12,-12,-12,-10,-10,-9,-9,-8,-7,-7,-6,-5,-5,-4,-4,-3,-2,-2,-2,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,1,1,1,1,1,2,2,2,2,2,2,3,3,3,3,3,3,3,3,3,4,4,4,4,4,4,4,4,5,5,5,6,6,6,6,6,6,6,6,7,7,7,7,7,7,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,7,7,7,7,7,7,6,5,5,5,5,4,4,4,4,3,3,2,1,1,1,1,1,1,-1,-1,-1,-2,-3,-3,-3,-4,-5,-5,-5,-6,-7,-7,-7,-8,-8,-9,-9,-10,-11,-11,-12,-12,-13,-14,-15,-15,-16,-17,-17,-18,-19,-20,-20,-21,-22,-22,-22,-24,-24,-24,-24,-25,-25,-26,-26,-26,-27,-28,-28,-28,-29,-29,-29,-30,-30,-30,-31,-31,-31,-32,-32,-32,-33,-33,-33,-33,-34,-34,-34,-34,-34,-35,-36,-36,-36,-36,-37,-37,-37,-37,-38,-38,-38,-38,-39,-40,-40,-40,-40,-40,-41,-41,-41,-41,-42,-42,-42,-42,-42,-43,-43,-44,-44,-44,-44,-44,-44,-44,-44,-44,-44,-44,-44,-44,-44,-44,-43,-43,-42,-42,-42,-42,-42],[-45,-45,-44,-44,-44,-43,-43,-43,-43,-42,-41,-41,-41,-40,-39,-39,-39,-37,-37,-36,-36,-35,-35,-34,-34,-33,-32,-32,-31,-31,-30,-30,-29,-28,-27,-27,-27,-26,-26,-25,-24,-24,-23,-23,-23,-22,-22,-21,-20,-20,-19,-18,-18,-17,-16,-16,-16,-15,-14,-14,-14,-14,-14,-13,-12,-12,-12,-12,-11,-11,-11,-11,-10,-10,-10,-9,-9,-9,-8,-8,-8,-8,-7,-7,-7,-7,-6,-6,-5,-5,-4,-4,-3,-3,-2,-2,-2,-1,-1,-1,-1,1,1,1,1,2,2,2,3,3,3,3,3,3,3,4,4,4,4,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,6,6,6,6,6,6,6,6,6,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,6,6,6,6,6,5,5,4,4,4,4,3,3,3,3,2,2,2,1,1,1,1,-1,-1,-2,-2,-3,-3,-3,-5,-5,-6,-6,-7,-8,-9,-10,-10,-11,-11,-13,-13,-14,-14,-15,-15,-17,-17,-18,-18,-19,-20,-21,-21,-22,-22,-23,-23,-24,-25,-25,-25,-26,-26,-26,-27,-27,-27,-28,-29,-29,-29,-30,-30,-30,-30,-31,-31,-31,-32,-33,-33,-33,-34,-34,-35,-35,-36,-36,-36,-37,-38,-38,-38,-39,-39,-39,-40,-40,-40,-41,-42,-42,-42,-43,-43,-43,-43,-44,-44,-44,-44,-45,-45,-46,-46,-46,-46,-46,-46,-46,-46,-46,-46,-46,-46,-46,-46,-46,-46,-46,-46,-46,-46,-46,-46,-46,-46,-46,-45,-45],[-46,-46,-46,-46,-46,-46,-46,-46,-46,-46,-46,-46,-46,-46,-45,-45,-44,-44,-43,-43,-43,-42,-42,-42,-41,-40,-40,-40,-39,-39,-38,-38,-38,-37,-36,-36,-36,-36,-35,-35,-35,-34,-34,-33,-33,-32,-32,-31,-31,-31,-30,-30,-30,-29,-28,-28,-28,-27,-27,-26,-26,-26,-24,-24,-24,-23,-23,-22,-22,-22,-21,-20,-20,-19,-19,-18,-17,-17,-16,-15,-14,-13,-12,-10,-9,-9,-7,-6,-4,-3,-2,-1,1,1,3,4,5,6,7,8,9,10,11,12,14,15,15,16,18,19,19,21,22,23,24,24,26,27,27,28,29,30,30,31,31,32,33,34,34,35,35,36,36,37,38,38,38,39,39,40,40,41,42,42,43,43,44,44,44,45,46,46,46,47,47,48,48,49,49,49,49,50,51,51,51,52,52,52,52,53,53,53,54,54,55,55,55,56,56,56,57,57,58,58,58,59,59,59,60,60,60,60,60,60,60,61,61]]},this.stebel3_params={magic:this.preloader.magic3_mc,Wm:0,Hm:52,w1:636,w2:857,w3:64,Wh:150,points:[[3,3,4,4,4,4,4,4,5,5,5,5,5,5,6,6,6,6,6,7,7,7,7,7,7,7,7,7,8,8,8,8,8,8,8,8,8,8,8,8,8,9,9,9,9,9,9,9,9,9,9,9,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,9,9,9,9,8,8,8,8,7,7,7,7,7,6,6,5,5,5,5,5,5,4,4,4,4,4,4,4,3,3,3,3,3,3,3,2,2,2,1,1,1,1,1,1,1,-1,-1,-1,-2,-2,-2,-3,-3,-4,-4,-4,-4,-4,-5,-5,-5,-5,-5,-6,-6,-6,-6,-6,-6,-6,-7,-7,-7,-7,-7,-7,-7,-8,-8,-8,-8,-8,-8,-8,-8,-8,-8,-8,-8,-8,-8,-8,-8,-8,-8,-8,-7,-7,-7,-7,-7,-7,-6,-6,-6,-6,-6,-6,-6,-6,-6,-5,-5,-5,-5,-4,-3,-3,-2,-2,-1,-1,-1,-1,1,2,2,3,3,4,4,5,6,6,6,7,7,8,8,9,10,10,11,11,12,12,13,14,14,15,15,16,16,17,18,18,19,19,19,20,20,20,21,21,22,23,23,23,24,24,25,25,26,26,27,28,28,29,30,31,31,31,32,32,33,33,34,35,35,36,36,36,37,37,38,39,39,39,40,40,40,40,41,41,41,41,42,43,43,43,44,44,45,45,45,45,46,46,47,47,47,47,48,48,48,48,49,49,49,49,50,50,50,51,51,51,51,51,52,52,52,52,52,52,52,52,52,52,53,53,53,53,53,53,53,53,53,53,53,53,53,53,53,53,53,53,53,53,53,53,53,53,53,53,54,54,54,54,55,55,55,55,55,55,55,56,56,56,56,56,56,56,56,57,57,57,57,57,57,57,57,57,57,57,57,57,57,57,57,57,57,57,57,56,56,56,56,55,54,54,54,54,54,54,54,54,53,53,53,53,53,53,53,53,53,53,53,53,53,53,53,53,53,52,52,52,52,52,52,52,52,52,52,51,51,51,51,51,51,50,50,50,50,50,50,50,50,50,50,50,49,49,49,49,49,49,49,49,49,49,48,48,48,48,48,46,46,45,45,44,43,42,42,41,41,40,39,38,37,37,36,36,35,34,34,33,32,32,32,31,30,30,29,29,28,28,27,27,25,25,25,24,23,23,22,21,20,20,19,19,18,17,17,16,15,15,14,13,13,12,12,11,10,9,9,8,8,7,7,6,5,5,4,4,3,2,1,1,-1,-2,-4,-5,-6,-8,-9,-10,-10,-12,-13,-13,-14,-15,-16,-16,-17,-17,-18,-18,-19,-20,-21,-21,-21,-22,-23,-23,-24,-25,-25,-25,-26,-26,-27,-28,-28,-28,-28,-29,-29,-29,-29,-29,-29,-29,-29,-29,-29,-29,-29,-29,-29,-29,-29,-29,-30,-30,-30,-30],[-30,-30,-30,-30,-30,-30,-30,-30,-30,-30,-30,-30,-30,-30,-30,-30,-30,-30,-30,-30,-30,-30,-30,-30,-29,-29,-29,-29,-28,-28,-28,-27,-26,-25,-25,-24,-24,-23,-23,-22,-21,-20,-20,-19,-19,-18,-18,-17,-16,-15,-15,-14,-14,-12,-12,-11,-10,-8,-8,-7,-7,-6,-5,-5,-4,-3,-2,-2,-2,1,1,2,3,4,5,5,6,6,7,8,8,9,10,10,11,12,13,13,14,15,15,17,17,17,18,19,19,21,21,22,22,23,24,25,26,26,27,27,28,29,29,30,30,30,31,32,33,33,34,34,35,35,37,37,38,38,38,39,40,40,41,41,42,42,42,42,43,43,43,43,44,44,45,45,45,45,45,46,46,46,46,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,48,48,48,48,48,48,49,49,50,50,50,50,51,51,51,52,52,53,53,54,54,54,54,54,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,54,54,54,54,53,53,53,53,53,53,52,52,52,52,51,51,51,51,51,51,50,50,49,49,49,49,49,49,48,48,48,48,48,48,48,47,47,47,47,47,46,46,46,46,46,45,44,44,44,44,43,43,43,43,42,42,42,42,42,41,41,40,40,40,39,39,39,38,38,38,38,38,37,37,36,36,36,36,36,35,35,35,35,35,34,34,34,34,34,33,33,33,32,32,32,32,31,31,31,31,30,30,30,30,29,28,28,28,28,27,27,26,26,26,25,24,24,24,23,23,22,22,20,20,20,19,19,18,18,17,16,16,15,15,14,14,13,13,13,12,11,11,10,10,10,9,9,9,7,7,7,6,6,5,5,4,4,3,3,2,2,1,1,-1,-1,-2,-2,-3,-3,-5,-6,-7,-7,-8,-9,-10,-10,-10,-11,-11,-11,-11,-12,-13,-13,-13,-13,-13,-14,-14,-14,-14,-14,-14,-15,-15,-15,-15,-15,-15,-16,-16,-16,-16,-16,-16,-16,-17,-17,-17,-17,-17,-17,-17,-17,-17,-16,-16,-16,-15,-15,-15,-14,-14,-13,-12,-12,-11,-10,-9,-9,-8,-8,-7,-6,-6,-6,-5,-4,-4,-3,-3,-3,-2,-2,-2,-1,-1,-1,-1,1,1,1,2,2,3,4,4,5,5,6,6,8,8,8,9,9,10,10,11,12,12,13,13,14,14,14,15,15,16,16,17,17,18,18,18,19,20,21,21,22,22,23,23,24,25,25,26,26,27,27,28,29,29,29,30,30,31,31,31,32,33,33,33,34,34,35,35,35,36,37,37,37,37,38,38,38,38,39,39,39,39,39,40,40,41,41,41,41,41,42,42,42,43,43,43,43,43,43,44,44,45,45,45,45,45,45,46,46,46,46,46,46,46,47,47,47,47,47,47,47,47,47,48,48,48,48,48,48,48,48,49,49,49,50,50,50,50,50,50,51,51,51,51,51,51,52,52,52,52,52,52,52,52,52,53,53,53,53,53,53,53,53,54,54,54,54,54,54,54,54,54,54,54,54,54,54,54,54,54,54,54,54,54,54,54,54,54,53,53,53,53,53,53,53,53,53,53,53,53,53,53,53,52,52,52,52,52,52,51,51,51,51,50,49,49,49,49,48,48,48,47,47,46,46,46,45,45,45,44,44,44,44,43,43,43,43,42,42,42,42,41,41,41,40,40,40,40,40,40,39,39,39,39,39,38,38,38,38,38,37,37,36,36,36,36,35,35,35,34,34,33,33,32,32,31,31,30,30,29,28,28,27,27,26,26,25,24,24,23,23,22,22,21,20,20,19,18,18,18,16,16,15,15,14,13,12,11,10,9,7,6,6,4,4,3,2,1,1,-1,-2,-3,-5,-5,-6,-7,-9,-10,-11,-13,-14,-14,-15,-17,-17,-18,-18,-19,-20,-20,-22,-22,-23,-23,-24,-24,-25,-26,-26,-26,-27,-27,-27,-28,-28,-28,-29,-30,-30,-30,-31,-31,-31,-31,-31,-32,-32,-32,-32,-32,-32,-32,-32,-32,-32,-32,-32,-32,-31,-31,-30,-30],[]]},this.stebel4_params={magic:this.preloader.magic4_mc,Wm:0,Hm:43,w1:442,w2:553,w3:244,Wh:150,points:[[35,33,32,32,31,30,29,28,28,27,26,25,25,24,23,22,22,21,20,20,19,19,18,18,18,18,17,17,17,17,16,16,16,16,16,16,15,15,15,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,15,15,15,15,15,15,15,15,15,16,16,16,16,17,17,17,17,17,18,19,19,19,19,20,20,20,21,21,21,22,23,24,24,25,25,26,27,27,28,28,29,29,30,30,31,31,31,32,32,32,32,33,33,33,33,34,34,34,35,35,36,36,36,37,37,37,37,38,38,38,39,39,40,40,40,41,41,41,41,41,42,42,42,42,43,43,43,44,44,44,44,44,44,44,45,45,45,45,45,45,45,45,45,45,45,45,45,45,45,45,45,45,45,45,45,45,44,44,44,43,43,43,43,43,43,43,43,43,43,42,42,42,42,42,41,41,41,40,39,39,38,38,37,37,36,35,35,35,34,34,33,32,32,32,30,29,29,28,27,26,25,24,24,22,21,21,19,18,17,17,16,15,14,14,13,13,12,12,11,10,9,8,8,7,6,6,5,4,3,2,1,1,-1,-2,-2,-3,-4,-5,-6,-7,-8,-9,-9,-10,-11,-12,-12,-13,-15,-15,-16,-16,-17,-18,-18,-19,-20,-20,-21,-21,-23,-23,-24,-24,-25,-25,-26,-27,-27,-27,-27,-28,-28,-28,-28,-28,-28,-28,-28,-28,-29,-29,-29,-29,-29,-29,-29,-29,-29,-29,-29,-29,-29,-29,-29,-29,-29,-29,-29,-29,-29,-29,-29,-28,-28,-28,-28,-27,-27,-26,-26,-25,-25,-24,-24,-22,-22,-22,-22,-21,-21,-21,-20,-20,-19,-19,-18,-18,-17,-17,-17,-16,-16,-16,-15,-15,-14,-14,-13,-13,-12,-12,-11,-10,-10,-10,-9,-9,-8,-8,-7,-6,-6,-6,-5,-5,-4,-4,-4,-2,-2,-1,-1,-1,-1,-1,-1,1,1,2,3,4,4,5,5,7,7,8,9,9,11,11,12,12,13,13,14,14,15,15,15,15,16,16,16,17,17,17,17,17,17,17,17,17,17,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18],[18,18,18,18,17,16,16,16,15,15,15,15,15,14,14,14,14,14,14,14,13,13,13,13,13,13,12,12,12,12,11,11,11,11,10,10,10,10,9,9,9,9,8,7,7,7,6,6,6,5,5,5,4,4,3,3,3,2,2,1,1,1,-1,-1,-2,-2,-3,-4,-4,-5,-6,-7,-7,-8,-8,-9,-10,-10,-11,-12,-12,-13,-14,-14,-15,-15,-16,-17,-17,-18,-18,-19,-20,-20,-21,-22,-22,-22,-23,-23,-23,-24,-24,-24,-24,-25,-25,-25,-26,-26,-26,-26,-26,-27,-27,-27,-27,-28,-28,-28,-28,-28,-28,-28,-28,-28,-28,-28,-28,-28,-28,-28,-28,-28,-28,-28,-28,-28,-28,-28,-28,-28,-28,-28,-27,-27,-27,-27,-26,-26,-25,-25,-25,-25,-25,-24,-24,-24,-23,-23,-23,-23,-22,-21,-21,-21,-20,-20,-19,-19,-19,-18,-17,-16,-15,-13,-13,-11,-10,-9,-8,-7,-6,-5,-5,-4,-3,-3,-2,-1,-1,1,1,2,3,4,4,5,6,7,7,8,9,9,10,11,12,13,13,14,15,16,17,18,18,20,21,21,22,24,25,26,27,28,29,30,31,32,33,33,34,35,37,37,38,39,39,40,41,41,41,41,41,41,41,41,41,42,42,42,42,42,42,43,43,43,43,43,43,43,43,44,44,45,45,45,46,46,46,47,47,47,47,47,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,47,47,47,47,46,46,46,45,44,44,44,43,43,42,42,42,41,40,40,40,39,38,38,37,36,36,35,34,34,33,33,32,31,31,31,30,30,29,29,28,27,26,26,25,25,24,23,22,22,21,20,19,19,18,17,17,15,15,14,14,13,11,10,10,9,7,6,6,5,3,2,1,1,-1,-2,-3,-3,-4,-6,-7,-7,-8,-9,-10,-10,-11,-12,-12,-13,-14,-14,-15,-16,-16,-17,-18,-19,-19,-20,-20,-21,-22,-22,-23,-23,-24,-24,-25,-26,-26,-27,-27,-27,-28,-28,-28,-28,-28,-28,-29,-29,-30,-30,-30,-30,-30,-30,-30,-30,-30,-30,-29,-29,-29,-28,-28,-28,-27,-27,-27,-26,-25,-25,-25,-24,-24,-24,-24,-24,-23,-23,-23,-23,-23,-23,-23,-22,-22,-21,-21,-21,-21,-21,-20,-20,-19,-19,-19,-17,-17,-16,-15,-15,-13,-12,-11,-11,-9,-9,-8,-8,-8,-7,-7,-7,-6,-6,-5,-4,-4,-3,-3,-2,-1,-1,-1,1,1,1,2,2,3,3,4,4,4,4,5,5,5,5,6,6,6,7,7,8,9,9,10,10,12,12,13,13,14,14,16,16,16,17,17,18,18,18,18,18,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,18,18,18,18],[18,17,17,17,17,17,17,17,17,17,17,17,17,17,17,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,19,19,19,20,20,20,20,21,21,21,21,22,23,24,24,25,25,25,26,27,27,27,28,29,29,30,31,31,32,32,33,34,35,35,36,36,37,38,38,39,40,40,40,41,41,42,43,43,44,44,44,45,45,45,46,46,47,47,47,47,47,48,48,48,48,48,48,49,49,49,49,49,49,49,49,49,49,49,49,49,49,49,49,49,49,49,49,49,49,49,49,49,49,49,49,49,49,49,49,49,49,49,49,49,49,49,49,49,49,49,49,49,49,49,49,49,49,49,49,49,49,49,50,50,50,50,50,51,51,51,51,51,51,51,52,52,52,52,52,52,52,52,52,52,52,52,52,52,52,52,52,52,52,52,52,51,51,50,50,50,49,48,48,48,48,47,47,46,46,45,45,45,45,44,44,44,44,44,44,44,44,43,42,42,42,42,42,42,41,41,41,41,40,40,39,39,38,38,37,37,36,36,35,34,34,33,32,32,32,31,30,30,30,30]]},this.anim_logo_params=[{sX:-239,sY:105,eX:-244,eY:95,obj:this.preloader.logo_game.logo_gw.i_ch},{sX:-119,sY:18,eX:-122,eY:10,obj:this.preloader.logo_game.logo_gw.g_ch},{sX:17,sY:-8,eX:20,eY:-15,obj:this.preloader.logo_game.logo_gw.r_ch},{sX:157,sY:26,eX:162,eY:16,obj:this.preloader.logo_game.logo_gw.a_ch}],this.anim_logo_slov=[this.preloader.logo_game.logo_ww.s_ch,this.preloader.logo_game.logo_ww.l_ch,this.preloader.logo_game.logo_ww.o_ch,this.preloader.logo_game.logo_ww.v_ch],this.base_d=3.5,window.scale_coef=this.scaller(),window.scale_speed=[287*scale_coef],this.blows={big:[],small:[]},this.blow_width_coef=350*scale_coef,this.preloader.logo_game.alpha=0,this.preloader.logo_game.scale.x=this.preloader.logo_game.scale.y=scale_coef,this.preloader.logo_game.x=my_width/2,this.preloader.logo_game.y=my_height/2,this.error_win.win.close_mc.on("pointertap",(()=>{sounds.playClick(),this.closeError()})),setButton(this.error_win.win.close_mc),setButton(this.error_win.win.butt_mc),this.constructBG(this.preloader.trees_mc,this.preloader.tree,this.tree_params),this.constructBG(this.preloader.grounds_mc,this.preloader.ground,this.ground_params),this.constructBoby(),this.constructBlows(),this.preloader.back_mc.addChild(helper.gradient("#def7fa","#d1f0f2")),this.error_win.win.butt_mc.on("pointertap",(()=>{sounds.playClick(),window.error_f(),this.closeError()})),setTextStyle(this.error_win.win.butt_mc.tf_txt,{dropShadow:!0,dropShadowAlpha:.12,dropShadowAngle:90,dropShadowDistance:3,miterLimit:3,stroke:"#843606",strokeThickness:5})}constructBlows(){let e=-34*scale_coef,t=my_height/2-125*scale_coef,s=Math.ceil((Math.abs(e)+Math.abs(t))/(110*scale_coef)),i=Math.ceil(my_width/this.blow_width_coef)+1;for(let t=0;t<s;t++){let o=new PIXI.Container,a=new PIXI.Container,r=Math.random()*(-1*this.blow_width_coef),l=Math.random()*(-1*this.blow_width_coef),n=13+12*Math.random();for(let n=0;n<i;n++){let h=scale_coef*(.15*Math.random()+.85),c=helper.duplicate(this.preloader.blow_mc),d=helper.duplicate(this.preloader.blow_mc);if(d.scale.x=d.scale.y=h,c.scale.x=c.scale.y=0,this.blows.big.push(c),c.end_scale=h,c.y=d.y=e+20*Math.random()+t*(110*scale_coef),c.x=r+n*this.blow_width_coef,d.x=r+n*this.blow_width_coef-i*this.blow_width_coef,o.addChild(c),o.addChild(d),t<s-1){let s=scale_coef*(.1*Math.random()+.6),o=helper.duplicate(this.preloader.blow_mc),r=helper.duplicate(this.preloader.blow_mc);r.scale.x=r.scale.y=s,this.blows.small.push(o),o.end_scale=s,o.scale.x=o.scale.y=0,o.y=r.y=e+55+20*Math.random()+t*(110*scale_coef),o.x=l+n*this.blow_width_coef,r.x=l+n*this.blow_width_coef-i*this.blow_width_coef,a.addChild(o),a.addChild(r)}}let h=()=>gsap.to(o,{ease:"none",x:i*this.blow_width_coef,duration:i*this.blow_width_coef/n,onComplete:d}),c=()=>gsap.to(a,{ease:"none",x:i*this.blow_width_coef,duration:i*this.blow_width_coef/(n/2),onComplete:_}),d=()=>{o.parent&&(o.x=0,h())},_=()=>{a.parent&&(a.x=0,c())};h(),c(),this.preloader.up_blows.addChild(o),t<s-1&&this.preloader.down_blows.addChild(a)}this.showBlows()}showBlows(){let e=1,t=0,s=(e="big")=>{let t=Math.floor(this.blows[e].length*Math.random());for(;this.blows[e][t].chk;)t=Math.floor(this.blows[e].length*Math.random());this.blows[e][t].chk=1,gsap.to(this.blows[e][t].scale,{duration:.15,ease:"back.out(1.7)",x:this.blows[e][t].end_scale,y:this.blows[e][t].end_scale,onComplete:i})},i=()=>{let i=0,o=0;for(let e=0;e<this.blows.big.length;e++)this.blows.big[e].chk&&i++;for(let e=0;e<this.blows.small.length;e++)this.blows.small[e].chk&&o++;o>=this.blows.small.length&&(t=1),1==e&&o<this.blows.small.length?(e=0,s("small")):(0==e||t)&&i<this.blows.big.length&&(e=1,s("big"))};s()}progressEvent(e){}constructBG(e,t,s){let i=my_width/(t.width*scale_coef),o=1;for(;o<i;)i>o&&(o+=2);for(let i=0;i<o;i++){let a=helper.duplicate(t),r=-1*Math.floor(o/2)+i;a.scale.x=a.scale.y=scale_coef,a.width=Math.ceil(a.width),a.height=Math.ceil(a.height),a.y=Math.ceil(my_height-s.Hm*scale_coef),a.x=Math.floor(Math.floor(Math.floor(my_width/2)-s.Wm*scale_coef)+(a.width-2)*r),e.addChild(a)}}constructBoby(){this.preloader.grounds_masker.alpha=0,this.preloader.boby_mc.scale.x=this.preloader.boby_mc.scale.y=scale_coef,this.preloader.korni_mc.scale.x=this.preloader.korni_mc.scale.y=scale_coef,this.preloader.grounds_masker.scale.x=this.preloader.grounds_masker.scale.y=scale_coef,this.preloader.grounds_masker.y=Math.ceil(my_height-this.gmask_params.Hm*scale_coef),this.preloader.grounds_masker.x=Math.ceil(Math.floor(my_width/2)-this.gmask_params.Wm*scale_coef),this.preloader.boby_mc.y=Math.ceil(my_height-this.boby_params.Hm*scale_coef),this.preloader.boby_mc.x=Math.ceil(Math.floor(my_width/2)-this.boby_params.Wm*scale_coef),this.preloader.korni_mc.y=Math.ceil(my_height-this.korni_params.Hm*scale_coef),this.preloader.korni_mc.x=Math.ceil(Math.floor(my_width/2)-this.korni_params.Wm*scale_coef),this.preloader.boby_mc.b1.scale.x=this.preloader.boby_mc.b1.scale.y=this.preloader.boby_mc.b2.scale.x=this.preloader.boby_mc.b2.scale.y=this.preloader.boby_mc.b3.scale.x=this.preloader.boby_mc.b3.scale.y=0,this.preloader.korni_mc.visible=!1,gsap.to(this.preloader.boby_mc.b1.scale,{duration:.5,x:1,y:1,ease:"back.out(2)",onComplete:()=>{gsap.to(this.preloader.boby_mc.b3.scale,{duration:.3,x:1,y:1,ease:"back.out(2)",onComplete:()=>{gsap.to(this.preloader.boby_mc.b2.scale,{duration:.3,x:1,y:1,ease:"back.out(2)",onComplete:()=>{this.preloader.korni_mc.visible=!0,helper.alphaAnimation(this.preloader.grounds_masker,1,500);for(let e=1;e<=4;e++)this.preloader.korni_mc["k"+e].play(),this.constructLoza(this.preloader["stebel"+e+"_mc"],[this.preloader["st"+e+"_0"],this.preloader["st"+e+"_1"],this.preloader["st"+e+"_2"]],this["stebel"+e+"_params"],e-1)}})}})}}),debug_mode&&(this.text=new PIXI.Text,this.preloader.addChild(this.text),this.text.y=100,this.text.text="DPR: "+window.devicePixelRatio)}constructLoza(e,t,s,i,o=!0,a=!0,r=1){let l=[0,0,0],n=0,h=0,c=my_height*r,d=[];for(this.cuts_loza[i]=[],o&&(l[0]=1,n+=s.w1*scale_coef);n+s.w2*scale_coef<c||n<c&&n+s.w3*scale_coef<c;)n+=s.w2*scale_coef,l[1]++;for(n-c<0&&(l[2]=1);e.children.length;)e.removeChildAt(0);e.x=Math.ceil(Math.floor(my_width/2)-s.Wm*scale_coef),e.y=Math.ceil(c/r-s.Hm*scale_coef);for(let o=0;o<l.length;o++)for(let a=0;a<l[o];a++){let a=helper.duplicate(t[o]);d=d.concat(s.points[o]),a.scale.x=a.scale.y=scale_coef,a.y=h,a.width=Math.ceil(a.width),a.height=Math.ceil(a.height),1!==scale_coef?h-=Math.floor(a.height-2):h-=Math.floor(a.height),e.addChild(a),this.cuts_loza[i]||(this.cuts_loza[i]=[]),this.cuts_loza[i].push(a)}if(0==i&&(window.loza_points=JSON.parse(JSON.stringify(d))),n=-1*h,!a)return this.showLozaDecor(i);let _=helper.duplicate(this.preloader.blicks_mc);_.scale.x=_.scale.y=scale_coef,_.x=e.x-20*scale_coef,_.y=e.y,_.alpha=0,s.magic.addChild(_);let m=new PIXI.Graphics;m.beginFill(0),m.drawRect(Math.floor(my_width/2)-s.Wh*scale_coef/2,_.y,2*s.Wh,-1*h),m.endFill(),e.mask=m,this.preloader.addChild(m),gsap.to(m,{ease:"none",duration:-1*h/scale_speed[0],y:h}),gsap.to(_,{ease:"none",duration:-1*h/scale_speed[0],y:_.y+h,onComplete:()=>{helper.alphaAnimation(_,0,100,(()=>s.magic.removeChild(_))),this.showLozaDecor(i),e.mask=null,this.preloader.removeChild(m),this.lgb||this.constructLogo()}}),helper.alphaAnimation(_,1,500);let p=setInterval((()=>{m.y==h&&clearInterval(p);let t=Math.max(0,Math.floor(-1*m.y/scale_coef));t>=d.length&&(t=d.length-1),_.x=e.x+Math.floor(d[t]*scale_coef)}),1)}showLozaDecor(e,t=!1){for(let t=0;t<this.cuts_loza[e].length;t++)for(let s=1;s<=4;s++)this.cuts_loza[e][t]["anim"+s]&&this.cuts_loza[e][t]["anim"+s].mc.gotoAndPlay(1)}constructLogo(){this.lgb=!0;for(let e=0;e<this.anim_logo_params.length;e++){this.anim_logo_params[e].obj.y=-300,this.anim_logo_params[e].obj.x=my_width/4*e-my_width/2;let t=()=>{gsap.to(this.anim_logo_params[e].obj,{x:this.anim_logo_params[e].sX,y:this.anim_logo_params[e].sY,duration:this.base_d+3*Math.random(),onComplete:()=>s()})},s=()=>{gsap.to(this.anim_logo_params[e].obj,{x:this.anim_logo_params[e].eX,y:this.anim_logo_params[e].eY,duration:this.base_d+3*Math.random(),onComplete:()=>t()})};gsap.to(this.anim_logo_params[e].obj,{duration:1+Math.random(),x:this.anim_logo_params[e].sX,y:this.anim_logo_params[e].sY,ease:"back.out(2)",onComplete:()=>{s(),this.lgw||this.constructWordLogo()}})}helper.alphaAnimation(this.preloader.logo_game,1,500)}constructWordLogo(){this.lgw=!0,helper.alphaAnimation(this.preloader.logo_game.logo_ww,1,100,(()=>{for(let e=0;e<this.anim_logo_slov.length;e++)gsap.to(this.anim_logo_slov[e],{duration:.5,x:72*e,onComplete:()=>{window.show_logo=!0,window.end_load&&window.data_load&&endLoadGame()}})}))}getToken(){TS.php("security.getToken",{access_token:vk_params.access_token},(e=>this.onGetToken(e)),this.onError)}onGetToken(e){e.token&&(TS.token=e.token),TS.php("users.get",{uid:vk_params.user_id,hash:vk_params.hash,ads:vk_params.referrer.split("ad_")[1]},(e=>this.onGetUserInfo(e)),this.onError)}onGetUserInfo(e){helper.getJSON(my_server+"/json/config_list.json",(e=>this.initJSONList(e)),this.onError)}initJSONList(e){let t=Object.keys(e),s=0,i=e=>{window[t[s]]=e,s++,s<t.length?o():this.initJSON()},o=()=>{helper.getJSON(my_server+"/json/"+e[t[s]]+".json?"+md5(Math.random().toString()),(e=>i(e)),this.onError)};o()}initJSON(){main_const._brush=helper.copyJSON(main_const.brush),window.data_load=!0,loadGame(),window.show_logo&&window.data_load&&endLoadGame()}scaller(){let e=1,t=Math.min(my_height/700,1),s=Math.min(my_width/1e3,1);return e=Math.min(s,t),"web"==window.VKPlatform&&(window.devicePixelRatio>=2?e*=1.6:e*=1),e}onError(e){switch(pre_control.error_win.x=0,pre_control.error_win.y=0,pre_control.error_win.shadow_mc.alpha=0,pre_control.error_win.scale.x=pre_control.error_win.scale.y=scale_coef,pre_control.error_win.win.x=my_width/scale_coef/2,pre_control.error_win.win.y=my_height/2*-1,pre_control.error_win.win.tf_txt.text=e.text,helper.drawShadow(pre_control.error_win.shadow_mc,(()=>gsap.to(pre_control.error_win.win,{duration:.5,y:my_height/scale_coef/2,ease:"back.out(1.7)"}))),e.code){case 4:pre_control.initErrorF(0);break;case 5:pre_control.initErrorF(2);break;case 11:pre_control.initErrorF(3);break;case 18:pre_control.initErrorF(4);break;default:pre_control.error_win.win.butt_mc.visible=!1}root.layer2_mc?root.layer2_mc.addChild(pre_control.error_win):pre_control.preloader.addChild(pre_control.error_win)}initErrorF(e=0){pre_control.error_win.win.butt_mc.visible=!0,window.error_f=()=>{modules.checkFlags(["game","shop"],(()=>shop.init(e)))}}closeError(){gsap.to(pre_control.error_win.win,{duration:.2,y:2*my_height,ease:"back.in(1.7)",onComplete:()=>{helper.alphaAnimation(pre_control.error_win.shadow_mc,0,100,(()=>this.error_win.parent.removeChild(this.error_win)))}})}}class t{constructor(e,t,s,i,o,a,r,l,n){this.lvl_ico=e,this.exp=t,this.medals=s,this.sett_btn=n,this.shop_ico=i,this.friends_panel=o,this.friends_ico=a,this.root_scene=pre_control.preloader,this.settings=helper.duplicate(l),this.bg_movs=r,this.blur_tree=game.game.btree1_mc,this.big_tree=game.game.tree1_mc,this.lvls=new PIXI.Container,this.blur_trees_array=[helper.duplicate(this.blur_tree),helper.duplicate(this.blur_tree)],this.big_trees_array=[],this.trees_anim=new PIXI.Container,this.trees_anim.interactive=this.settings.interactive=!0,this.level_points={first:[],default:[]},this.grad_info=[{from:"#def7fa",to:"#def7fa",del:"#abe3e1"},{from:"#def7fa",to:"#def7fa",del:"#abe3e1"},{from:"#92cfcd",to:"#def7fa",del:"#abe3e1"},{from:"#5f8786",to:"#92cfcd",del:"#759f9d"}],this.cur_bg=0,this.preloader_movies=[pre_control.preloader.grounds_mc,pre_control.preloader.korni_mc,pre_control.preloader.boby_mc,pre_control.preloader.grounds_masker,pre_control.preloader.trees_mc,pre_control.preloader.stebel1_mc,pre_control.preloader.stebel2_mc,pre_control.preloader.stebel3_mc,pre_control.preloader.stebel4_mc,pre_control.preloader.anim_up,pre_control.preloader.anim_down];for(let e=0;e<this.preloader_movies.length;e++)this.preloader_movies[e].startY=this.preloader_movies[e].y;pre_control.preloader.back_mc.startY=pre_control.preloader.back_mc.y,this.birds_width_coef=my_width/2,this.birds={big:[],small:[]},this.airplanes_width_coef=1.2*my_width,this.airplanes={big:[],small:[]};let h=Math.floor((my_height-176-10)/10),c=Math.floor((my_height-176-10)/10);for(let e=0;e<10;e++)this.level_points.first.push(Math.floor((my_height/scale_coef-176)*scale_coef-h*e)),this.level_points.default.push(Math.floor((my_height/scale_coef-176)*scale_coef-c*e));this.shop_ico.on("pointertap",(()=>{sounds.playClick(),this.toShop()})),this.medals.on("pointertap",(()=>{sounds.playClick(),this.toShop(4)})),this.exp.on("pointertap",(()=>{sounds.playClick(),this.toShop(3)})),this.sett_btn.on("pointertap",(()=>{sounds.playClick(),this.showSettings()})),this.settings.win.close_mc.on("pointertap",(()=>{sounds.playClick(),this.hideSettings()})),this.settings.win.render_mc.render_btn.on("pointertap",(()=>{sounds.playClick(),this.showHideRender()})),this.settings.win.render_mc.blow_mc.webgl_btn.on("pointertap",(()=>{sounds.playClick(),this.changeRender("webgl")})),this.settings.win.render_mc.blow_mc.canvas_btn.on("pointertap",(()=>{sounds.playClick(),this.changeRender("canvas")})),this.settings.win.sounds_mc.sound_mc.on("pointertap",(()=>{sounds.playClick(),this.changeSound()})),this.settings.win.sounds_mc.music_mc.on("pointertap",(()=>{sounds.playClick(),this.changeMusic()})),this.initButtons(),this.initStyles(),this.countBigTrees()}startBgMusic(){sounds.playBackMusic()}toShop(e=0){modules.checkFlags(["game","shop"],(()=>shop.init(e)))}changeRender(e){let t=localStore.canvas;localStore.canvas="webgl"!=e,this.settings.win.render_mc.naming_txt.text=localStore.canvas?"CANVAS":"WEBGL",this.showHideRender(),saveLocalStorage((()=>{t!==localStore.canvas&&window.open("https://vk.com/app"+vk_params.api_id,"_parent")}))}changeSound(){this.settings.win.sounds_mc.sound_mc.disable_mc.visible=Boolean(localStore.sound),localStore.sound=!Boolean(localStore.sound),saveLocalStorage()}changeMusic(){this.settings.win.sounds_mc.music_mc.disable_mc.visible=Boolean(localStore.music),localStore.music=!Boolean(localStore.music),window.bg_music.volume=localStore.music?.2:0,saveLocalStorage()}showSettings(){this.settings.win.scale.x=this.settings.win.scale.y=scale_coef,this.settings.win.render_mc.naming_txt.text=localStore.canvas?"CANVAS":"WEBGL",this.settings.win.sounds_mc.sound_mc.disable_mc.visible=!Boolean(localStore.sound),this.settings.win.sounds_mc.music_mc.disable_mc.visible=!Boolean(localStore.music),this.settings.win.render_mc.open_mc.gotoAndStop(0),helper.alphaAnimation(this.settings.win.render_mc.blow_mc,0,300),this.settings.win.x=my_width/2,this.settings.win.y=my_height/2*-1,helper.drawShadow(this.settings.shadow_mc,(()=>gsap.to(this.settings.win,{duration:.5,y:my_height/2,ease:"back.out(1.7)"}))),this.settings.parent||root.layer1_mc.addChild(this.settings)}hideSettings(){gsap.to(this.settings.win,{duration:.2,y:2*my_height,ease:"back.in(1.7)",onComplete:()=>{helper.alphaAnimation(this.settings.shadow_mc,0,100,(()=>this.settings.parent.removeChild(this.settings)))}})}showHideRender(){1==this.settings.win.render_mc.open_mc.currentFrame?(this.settings.win.render_mc.open_mc.gotoAndStop(0),helper.alphaAnimation(this.settings.win.render_mc.blow_mc,0,300)):(this.settings.win.render_mc.open_mc.gotoAndStop(1),helper.alphaAnimation(this.settings.win.render_mc.blow_mc,1,300))}countBigTrees(){this.blur_trees_array[0].y=(-100*Math.random()-50)*scale_coef,this.blur_trees_array[1].y=(-100*Math.random()-50)*scale_coef;let e=helper.duplicate(this.big_tree),t=helper.duplicate(this.big_tree);e.scale.x=e.scale.y=t.scale.x=t.scale.y=scale_coef,e.endx=-1*e.width/5,t.endx=my_width-t.width/3*2,t.x=t.startx=my_width,e.x=e.startx=-1*e.width;let s=Math.ceil(my_width/(100*scale_coef)),i=Math.ceil(100*scale_coef);this.big_trees_array.push(e),this.big_trees_array[s-1]=t;for(let t=1;t<s-1;t++)this.big_trees_array[t]=helper.duplicate(this.big_tree),this.big_trees_array[t].endx=e.endx+i*t,this.big_trees_array[t].scale.x=this.big_trees_array[t].scale.y=scale_coef,t>Math.floor(s/2)?this.big_trees_array[t].x=this.big_trees_array[t].startx=my_width:this.big_trees_array[t].x=this.big_trees_array[t].startx=-1*this.big_trees_array[t].width,this.big_trees_array[t].y=(-200*Math.random()-50)*scale_coef;for(let e=1;e<s-1;e++)this.trees_anim.addChild(this.big_trees_array[e]);this.trees_anim.addChild(e),this.trees_anim.addChild(t),this.trees_anim.addChild(this.blur_trees_array[0]),this.trees_anim.addChild(this.blur_trees_array[1])}showBigTrees(e){if(!this.tree_trig){this.tree_trig=!0,this.blur_trees_array[0].x=-1*this.blur_trees_array[0].width,this.blur_trees_array[1].x=my_width;for(let e=0;e<this.big_trees_array.length;e++)gsap.to(this.big_trees_array[e],{duration:1,x:this.big_trees_array[e].endx,ease:"expo.out"});gsap.to(this.blur_trees_array[0],{duration:1,x:-1*this.blur_trees_array[0].width/2,ease:"expo.out"}),gsap.to(this.blur_trees_array[1],{duration:1,x:my_width-this.blur_trees_array[1].width/2,ease:"expo.out",onComplete:()=>{this.tree_trig=!1,e&&e(),window.complete_tree&&this.hideBigTrees()}}),root.layer1_mc.addChild(this.trees_anim)}}hideBigTrees(){for(let e=0;e<this.big_trees_array.length;e++)gsap.to(this.big_trees_array[e],{duration:1,x:this.big_trees_array[e].startx,ease:"expo.out"});gsap.to(this.blur_trees_array[0],{duration:1,x:-1*this.blur_trees_array[0].width,ease:"expo.out"}),gsap.to(this.blur_trees_array[1],{duration:1,x:my_width,ease:"expo.out",onComplete:()=>{}})}init(){learn.nullPointer(),window.bg_music||root.on("pointerdown",(()=>this.startBgMusic())),this.shop_ico.scale.x=this.shop_ico.scale.y=scale_coef,this.exp.scale.x=this.exp.scale.y=scale_coef,this.medals.scale.x=this.medals.scale.y=scale_coef,this.sett_btn.scale.x=this.sett_btn.scale.y=scale_coef,this.shop_ico.y=my_height,this.shop_ico.x=(my_width/scale_coef/2-390)*scale_coef,this.exp.y=this.sett_btn.y=this.medals.y=-100,this.exp.x=(my_width/scale_coef/2+126)*scale_coef,this.medals.x=(my_width/scale_coef/2+279)*scale_coef,this.sett_btn.x=(my_width/scale_coef/2+408)*scale_coef,this.showValuta(),gsap.to(this.shop_ico,{duration:.5+.25*Math.random(),y:(my_height/scale_coef-105)*scale_coef,ease:"back.out(2)"}),gsap.to(this.exp,{duration:.5+.25*Math.random(),y:19*scale_coef,ease:"back.out(2)"}),gsap.to(this.medals,{duration:.5+.25*Math.random(),y:19*scale_coef,ease:"back.out(2)"}),gsap.to(this.sett_btn,{duration:.5+.25*Math.random(),y:25*scale_coef,ease:"back.out(2)"}),root.layer0_mc.addChild(this.root_scene),root.layer1_mc.addChild(this.shop_ico),root.layer1_mc.addChild(this.medals),root.layer1_mc.addChild(this.exp),root.layer1_mc.addChild(this.sett_btn);let e=Math.ceil(udata.level/10);if(console.log(e),this.cur_bg+1!==e){for(let e=0;e<this.preloader_movies.length;e++)this.preloader_movies[e].y=this.preloader_movies[e].startY;pre_control.preloader.back_mc.y=pre_control.preloader.back_mc.startY;for(let t=1;t<=4;t++)pre_control.constructLoza(pre_control.preloader["stebel"+t+"_mc"],[pre_control.preloader["st"+t+"_0"],pre_control.preloader["st"+t+"_1"],pre_control.preloader["st"+t+"_2"]],pre_control["stebel"+t+"_params"],t-1,!0,!1,e)}this.constructBGS(e),window.text=new PIXI.Text,text.x=240,root.layer2_mc.addChild(text)}constructBGS(e){if(this.cur_bg+1==e)return this.initLevelIcons();if(void 0===this.grad_info[this.cur_bg])return this.cur_bg=0,this.initLevelIcons();let t="none",s=helper.gradient(this.grad_info[this.cur_bg].from,this.grad_info[this.cur_bg].to,this.grad_info[this.cur_bg].del);s.y=-1*my_height*(this.cur_bg+1),pre_control.preloader.back_mc.addChild(s);for(let e=0;e<this.preloader_movies.length;e++)gsap.to(this.preloader_movies[e],{duration:.6,y:this.preloader_movies[e].y+my_height,ease:t});gsap.to(pre_control.preloader.back_mc,{duration:.6,y:pre_control.preloader.back_mc.y+my_height,onComplete:()=>this.constructBGS(e),ease:t}),this["constructBG"+(this.cur_bg+1)]&&this["constructBG"+(this.cur_bg+1)](),this.cur_bg++}constructBG1(){let e=my_height/2-26*scale_coef,t=Math.ceil(my_width/this.birds_width_coef)+1;for(let s=0;s<2;s++){let i=new PIXI.Container,o=new PIXI.Container,a=Math.random()*(-1*this.birds_width_coef),r=Math.random()*(-1*this.birds_width_coef),l=86+42*Math.random();for(let l=0;l<t;l++){let n=["bird_blue","bird_red"][Math.floor(2*Math.random())],h=helper.duplicate(this.bg_movs[n]),c=helper.duplicate(this.bg_movs[n]);h.scale.x=h.scale.y=c.scale.x=c.scale.y=scale_coef*(.1*Math.random()+.9),this.birds.big.push(h),h.y=c.y=-1*my_height+e+20*Math.random()+s*(185*scale_coef),h.x=a+l*this.birds_width_coef,c.x=a+l*this.birds_width_coef-t*this.birds_width_coef,c.alpha=h.alpha=.9,i.addChild(h),i.addChild(c);let d=["bird_blue","bird_red"][Math.floor(2*Math.random())],_=helper.duplicate(this.bg_movs[d]),m=helper.duplicate(this.bg_movs[d]);_.scale.y=m.scale.y=scale_coef*(.1*Math.random()+.7),_.scale.x=m.scale.x=-1*m.scale.y,this.birds.small.push(_),_.y=m.y=-1*my_height+e+99+20*Math.random()+s*(185*scale_coef),_.x=r+l*this.birds_width_coef,m.x=r+l*this.birds_width_coef+t*this.birds_width_coef,m.alpha=_.alpha=.8,o.addChild(_),o.addChild(m)}let n=()=>gsap.to(i,{ease:"none",x:t*this.birds_width_coef,duration:t*this.birds_width_coef/l,onComplete:c}),h=()=>gsap.to(o,{ease:"none",x:-1*t*this.birds_width_coef,duration:t*this.birds_width_coef/(l/2),onComplete:d}),c=()=>{i.parent&&(i.x=0,n())},d=()=>{o.parent&&(o.x=0,h())};n(),h(),pre_control.preloader.anim_up.addChild(i),pre_control.preloader.anim_down.addChild(o)}}constructBG2(){let e=my_height/2-125*scale_coef,t=Math.ceil(my_width/this.airplanes_width_coef)+1;for(let s=0;s<1;s++){let i=new PIXI.Container,o=new PIXI.Container,a=Math.random()*(-1*this.airplanes_width_coef),r=Math.random()*(-1*this.airplanes_width_coef),l=126+42*Math.random();for(let l=0;l<t;l++){let n=helper.duplicate(this.bg_movs.airplane),h=helper.duplicate(this.bg_movs.airplane);h.scale.x=h.scale.y=n.scale.x=n.scale.y=scale_coef*(.3*Math.random()+.7),this.airplanes.big.push(n),n.y=h.y=-2*my_height+e+50*Math.random()+s*(250*scale_coef),n.x=a+l*this.airplanes_width_coef,h.x=a+l*this.airplanes_width_coef-t*this.airplanes_width_coef,h.alpha=n.alpha=.3*Math.random()+.4,i.addChild(n),i.addChild(h);let c=helper.duplicate(this.bg_movs.airplane),d=helper.duplicate(this.bg_movs.airplane);c.scale.y=d.scale.y=scale_coef*(.3*Math.random()+.3),c.scale.x=d.scale.x=-1*d.scale.y,this.airplanes.small.push(c),c.y=d.y=-2*my_height+e+175*scale_coef+50*Math.random()+s*(250*scale_coef),c.x=r+l*this.airplanes_width_coef,d.x=r+l*this.airplanes_width_coef+t*this.airplanes_width_coef,d.alpha=c.alpha=.8,o.addChild(c),o.addChild(d)}let n=()=>gsap.to(i,{ease:"none",x:t*this.airplanes_width_coef,duration:t*this.airplanes_width_coef/l,onComplete:c}),h=()=>gsap.to(o,{ease:"none",x:-1*t*this.airplanes_width_coef,duration:t*this.airplanes_width_coef/(l/2),onComplete:d}),c=()=>{i.parent&&(i.x=0,n())},d=()=>{o.parent&&(o.x=0,h())};n(),h(),pre_control.preloader.anim_down.addChild(i),pre_control.preloader.anim_down.addChild(o)}}constructBG3(){gsap.to(pre_control.preloader.up_blows,{duration:.6,y:pre_control.preloader.up_blows.y+my_height}),gsap.to(pre_control.preloader.down_blows,{duration:.6,y:pre_control.preloader.down_blows.y+my_height});let e=230*scale_coef,t=109*scale_coef,s=()=>{let i=helper.duplicate(this.bg_movs.rocket);i.x=my_width/2+Math.random()*my_width/2,i.y=-2*my_height+t,i.scale.x=i.scale.y=.7+.2*Math.random();let o=(120+50*Math.random())*i.alpha;i.rotation=Math.PI/180*-15;let a=-1*t+e+my_height,r=Math.tan(-1*i.rotation)*a,l=Math.sqrt(a*a+r*r);gsap.to(i,{duration:l/o,alpha:0,x:r,y:-1*a-2*my_height,onComplete:()=>{pre_control.preloader.anim_down.removeChild(i),s()}}),pre_control.preloader.anim_down.addChild(i)};s()}constructBG4(){let e=helper.duplicate(this.bg_movs.ufo),t=()=>{let s=Boolean(Math.floor(2*Math.random()));s=s?-1:1,e.y=-4*my_height+(my_height/2+Math.random()*my_height/4),e.x=1.5*my_width*s;let i=150+150*Math.random();gsap.to(e,{duration:2,ease:"expo.out",x:my_width/2+i*s,onComplete:()=>{e.anim.play();let i=setInterval((()=>{clearInterval(i),gsap.to(e,{duration:2,ease:"expo.in",x:-1*my_width*1.5*s,onComplete:()=>{let e=setInterval((()=>{clearInterval(e),t()}),3e3)}})}),3500)}})};t(),pre_control.preloader.anim_down.addChild(e)}showValuta(){helper.numberAnimation(this.medals.tf_txt,udata.medals),helper.numberAnimation(this.exp.tf_txt,udata.exp)}initUserPhoto(){helper.loadPhoto50(vk_params.viewer_id,(e=>{this.my_level.ava_mc.scale.x=this.my_level.ava_mc.scale.y=0,this.my_level.ava_mc.visible=!0,e.photo.width=e.photo.height=42,this.my_level.ava_mc.photo_mc.addChild(e.photo),gsap.to(this.my_level.ava_mc.scale,{duration:.15,x:1,y:1,ease:"back.out(2)",onComplete:()=>{learn.check()}}),setTextStyle(this.my_level.ava_mc.tf_txt,{dropShadow:!0,dropShadowAlpha:.12,dropShadowAngle:90,dropShadowDistance:3,miterLimit:3,stroke:"#4b413b",strokeThickness:3})})),this.updateLevelProgress(),this.my_level.on("pointertap",(()=>{sounds.playClick(),game.init()}))}updateLevelProgress(){udata.level_progress.length=udata.level_progress.length||1,udata.level_progress.word=udata.level_progress.word||[],udata.levels_info.cnt[udata.level-1]=udata.levels_info.cnt[udata.level-1]||0,this.my_level.ava_mc.tf_txt.text=Math.floor(udata.levels_info.cnt[udata.level-1]%10*10+Math.floor(udata.level_progress.word.length/udata.level_progress.length*10))+"%"}initLevelIcons(e="default",t=0){t=Math.floor((udata.level-1)/10),udata.level<11&&(e="first"),this.lvls.parent&&this.lvls.parent.removeChild(this.lvls),this.lvls=new PIXI.Container;let s=my_height-this.root_scene.stebel1_mc.y,i=this.root_scene.stebel1_mc.height-my_height;this.lvls.y=-1*this.root_scene.stebel1_mc.height+s+i,this.root_scene.stebel1_mc.addChild(this.lvls);let o=[],a=0;this.lvl_ics=[];for(let i=0;i<10;i++){let a=helper.duplicate(this.lvl_ico);a.scale.x=a.scale.y=0,a.y=this.level_points[e][i];let r=Math.floor((-1*s+my_height-a.y)/scale_coef);r>=loza_points.length&&(r=loza_points.length-1),a.x=(loza_points[r]-30)*scale_coef,this.lvls.addChild(a),o.push(a),this.lvl_ics[1+i+10*t]=a,udata.levels_info.cnt=udata.levels_info.cnt||[],a.level_txt.text=parseInt(i+1+10*t),udata.levels_info.cnt[i+10*t]=udata.levels_info.cnt[i+10*t]||0,a.icon_mc.gotoAndStop(helper.levelComplete(udata.levels_info.cnt[i+10*t])),i+10*t>=udata.level&&!udata.levels_info.cnt[i+10*t]&&(a.level_txt.text="",a.icon_mc.gotoAndStop(4)),i+10*t==udata.level-1&&(this.my_level=a,setButton(a)),a.ava_mc.visible=!1}let r=()=>{gsap.to(o[a].scale,{duration:.15,x:scale_coef,y:scale_coef,ease:"back.out(2)",onComplete:()=>{a++,o[a]?r():this.initUserPhoto()}})};r(),this.checkFrientPermits()}checkFrientPermits(){bridge.send("VKWebAppCheckAllowedScopes",{scopes:"friends"}).then((e=>{Boolean(e.result[0].allowed)?this.getFriendTop():this.activateDefFriend()}))}getFriendTop(){if(this.lvl_ics[parseInt(udata.level)+1]&&(this.lvl_ics[parseInt(udata.level)+1].friend_def.visible=!1),window.my_friends)return this.getTrueFriendTop();bridge.sendPromise("VKWebAppCallAPIMethod",{method:"friends.getAppUsers",params:{access_token:VK_token,v:VK_version}}).then((e=>{let t="";vk_params.api_result=e.response,t=vk_params.api_result.length>0?vk_params.viewer_id+","+vk_params.api_result.join(","):vk_params.viewer_id.toString(),window.my_friends=t,this.getTrueFriendTop()}))}getTrueFriendTop(){TS.php("friends.get",{users:my_friends,level:udata.level},(e=>{this.lvl_friends=[];for(let t=0;t<e.rating.length;t++)e.rating[t].level!=udata.level&&(this.lvl_friends[e.rating[t].level]=this.lvl_friends[e.rating[t].level]||[],this.lvl_friends[e.rating[t].level].push(e.rating[t].id));helper.pushPhoto50(e.ids.split(","),(e=>{e&&this.loadFriendLvls()}))}),pre_control.onError)}loadFriendLvls(){let e=Object.keys(this.lvl_friends);for(let t=0;t<e.length;t++){let s=this.lvl_ics[e[t]].friend_full;helper.loadPhoto50(this.lvl_friends[e[t]][0],(i=>{s.scale.x=s.scale.y=0,s.alpha=1,s.visible=!0,i.photo.width=i.photo.height=42,s.photo_mc.addChild(i.photo),setButton(s),s.on("pointertap",(()=>{window.open("https://vk.com/id"+this.lvl_friends[e[t]][0],"_blank")})),gsap.to(s.scale,{duration:.15,x:1,y:1,ease:"back.out(2)"}),this.lvl_friends[e[t]].length>1&&(s.count_txt.text="+"+(this.lvl_friends[e[t]].length-1)),setTextStyle(s.count_txt,{dropShadow:!0,dropShadowAlpha:.12,dropShadowAngle:90,dropShadowDistance:3,miterLimit:3,stroke:"#4b413b",strokeThickness:3})}))}}activateDefFriend(){1==udata.level||!udata.level%10||(this.lvl_ics[parseInt(udata.level)+1].friend_def.alpha=1,this.lvl_ics[parseInt(udata.level)+1].friend_def.scale.x=this.lvl_ics[parseInt(udata.level)+1].friend_def.scale.y=0,gsap.to(this.lvl_ics[parseInt(udata.level)+1].friend_def.scale,{x:1,y:1,duration:.3,ease:"back.out(1.7)"}),setButton(this.lvl_ics[parseInt(udata.level)+1].friend_def),this.lvl_ics[parseInt(udata.level)+1].friend_def.on("pointertap",(()=>{bridge.send("VKWebAppGetAuthToken",{app_id:parseInt(vk_params.api_id),scope:"friends"}).then((e=>{VK_token=e.access_token,helper.alphaAnimation(this.lvl_ics[parseInt(udata.level)+1].friend_def,0,300,(()=>this.getFriendTop()))}))})))}initButtons(){setButton(this.shop_ico),setButton(this.medals),setButton(this.exp),setButton(this.sett_btn),setButton(this.settings.win.close_mc),setButton(this.settings.win.render_mc.render_btn),setButton(this.settings.win.render_mc.blow_mc.webgl_btn),setButton(this.settings.win.render_mc.blow_mc.canvas_btn),setButton(this.settings.win.sounds_mc.sound_mc),setButton(this.settings.win.sounds_mc.music_mc)}initStyles(){setTextStyle(this.exp.tf_txt,{dropShadow:!0,dropShadowAlpha:.12,dropShadowAngle:90,dropShadowDistance:3,miterLimit:3,stroke:"#443f3d",strokeThickness:5}),setTextStyle(this.medals.tf_txt,{dropShadow:!0,dropShadowAlpha:.12,dropShadowAngle:90,dropShadowDistance:3,miterLimit:3,stroke:"#443f3d",strokeThickness:5})}}class s{constructor(e,t,s,i,o,a){this.game=e,this.bg_lines=t,this.sky=s,this.compl=a,this.big_char=i,this.small_char=o,this.compl_stars=[],this.up_blows=[],this.down_blows=[],this.big_chars=[],this.small_chars=[],this.sky_trigger=0,this.game.interactive=!0,this.rounds=[],this.rounds_trig=!1,this.local_start=this.server_start=this.local_end=this.server_end=0,this.mask_mc=new PIXI.Graphics,this.arr_RU=["А","Б","В","Г","Д","Е","Ё","Ж","З","И","Й","К","Л","М","Н","О","П","Р","С","Т","У","Ф","Х","Ц","Ч","Ш","Щ","Ь","Ы","Ъ","Э","Ю","Я"],this.keys_RU=[70,188,68,85,76,84,220,186,80,66,81,82,75,86,89,74,71,72,67,78,69,65,219,87,88,73,79,77,83,221,222,190,90],this.constructScene(),this.initButtons(),this.initStyles(),root.interactive=!0;for(let e=1;e<=7;e++)this.compl_stars.push(this.compl.win["star"+e]),this.compl.win["star"+e].scl={x:this.compl.win["star"+e].scale.x,y:this.compl.win["star"+e].scale.y};this.game.board_mc.exit_mc.on("pointertap",(()=>{sounds.playClick(),this.hideGame()})),this.compl.win.menu_mc.on("pointertap",(()=>{sounds.playClick(),this.hideComplete(),this.hideGame()})),this.compl.win.next_mc.bg.on("pointertap",(()=>{sounds.playClick(),this.hideComplete(),this.init()})),this.game.board_mc.picture_mc.mask=this.mask_mc,this.compl.interactive=!0,this.game.board_mc.buttmask_mc.on("pointermove",(e=>this.moveBoard(e))),this.game.board_mc.buttmask_mc.on("pointerdown",(e=>this.downMasker(e))),this.compl.win.close_mc.on("pointertap",(()=>{sounds.playClick(),this.hideComplete(),this.compl.win.menu_mc.interactive&&this.hideGame()})),root.on("pointerup",(()=>this.upMasker())),this.game.open_word.bg.on("pointertap",(()=>{sounds.playClick(),this.openWord()})),this.game.open_char.bg.on("pointertap",(()=>{sounds.playClick(),this.openChar()})),this.compl.win.share_btn.on("pointertap",(()=>this.clickRepostButt())),this.compl.win.restart_btn.on("pointertap",(()=>window.open("https://vk.com/app"+vk_params.api_id,"_parent"))),window.addEventListener("keyup",(e=>this.pressKey(e)))}init(){learn.nullPointer(),this.game.board_mc.picture_mc.mask=this.mask_mc,this.game.btree1_mc.y=menu.blur_trees_array[0].y,this.game.btree2_mc.y=menu.blur_trees_array[1].y,this.game.lifes_mc.blow_mc.visible=!1,menu.showBigTrees((()=>this.showGame())),window.complete_tree=!1,TS.php("game.getLevel",{},(e=>this.onGetLevel(e)),pre_control.onError),TIMERS.timers.energy||(TIMERS.timers.energy={init:!0,tick:e=>this.updateEnergyTimer(e)}),TIMERS.timers.otkat||(TIMERS.timers.otkat={init:!0,tick:e=>this.updateOtkatTimer(e)}),TIMERS.timers.lifes||(TIMERS.timers.lifes={init:!0,tick:e=>this.updateLifesTimer(e)})}showComplete(e){for(this.compl.shadow_mc.children.length||helper.drawShadow(this.compl.shadow_mc),this.compl.win.first_mc.exp_txt.text=e.exp,e.second.isset=Boolean(e.second.isset),this.compl.win.second_mc.visible=e.second.isset,e.second.isset?(this.compl.win.first_mc.x=-116,this.compl.win.second_mc.icons_mc.gotoAndStop(e.second.key),this.compl.win.second_mc.second_txt.text=e.second.value):this.compl.win.first_mc.x=-65,this.compl.win.share_btn.scale.x=this.compl.win.share_btn.scale.y=0,Boolean(e.share.isset)&&(this.compl.win.share_btn.icons_mc.gotoAndStop(e.share.key),this.compl.win.share_btn.tf_txt.text="+"+e.share.value,this.showRepostButt()),this.compl.win.restart_btn.visible=Boolean("game"==e.type),this.compl.win.menu_mc.visible=this.compl.win.next_mc.visible=Boolean("game"!=e.type),this.compl.win.congrat_txt.text="game"==e.type?"Игра пройдена!":"level"==e.type?"Уровень завершен!":"Cлово отгадано!",sounds.playComplete(),this.game.board_mc.picture_mc.mask=null;this.mask_mc.children.length;)this.mask_mc.removeChildAt(0);for(let e=0;e<this.compl_stars.length;e++)this.compl_stars[e].scale.x=this.compl_stars[e].scale.y=0,gsap.to(this.compl_stars[e].scale,{duration:.5+Math.random(),x:this.compl_stars[e].scl.x,y:this.compl_stars[e].scl.y,ease:"back.out(1.7)"});this.compl.scale.x=this.compl.scale.y=scale_coef,this.compl.win.x=this.compl.light_mc.x=my_width/scale_coef/2,this.compl.win.y=this.compl.light_mc.y=my_height/scale_coef/2,this.compl.win.menu_mc.bg.gotoAndStop(0),this.compl.win.menu_mc.buttonMode=this.compl.win.menu_mc.interactive=!0,this.compl.stage||root.layer2_mc.addChild(this.compl),learn.check(),void 0!==e.bonus_id&&(this.bonus_id=e.bonus_id)}clickRepostButt(){bridge.send("VKWebAppCheckAllowedScopes",{scopes:"wall"}).then((e=>{Boolean(e.result[0].allowed)?this.formRepostMessage():bridge.send("VKWebAppGetAuthToken",{app_id:parseInt(vk_params.api_id),scope:"wall"}).then((e=>{VK_token=e.access_token,this.formRepostMessage()})).catch((e=>e=>this.hideRepostButt()))})).catch((e=>this.hideRepostButt()))}formRepostMessage(){let e="";void 0!==menu.lvl_friends[udata.level-1]?helper.pushPhoto50([menu.lvl_friends[udata.level-1][0]],(()=>helper.loadPhoto50(menu.lvl_friends[udata.level-1][0],(t=>{e="@id"+menu.lvl_friends[udata.level-1][0]+"("+t.name+"), я уже на уровень выше в Игре Слов! Давай догоняй! https://vk.com/app"+vk_params.api_id,this.sendRepost(e)})))):(e=Math.floor(udata.real_exp/main_const.level_win)+" - вот сколько слов у меня уже отгадано в Игре Слов! Заходи и проверь свои навыки! https://vk.com/app"+vk_params.api_id,this.sendRepost(e))}sendRepost(e){bridge.send("VKWebAppShowWallPostBox",{message:e,attachments:main_const.repost_attachment}).then((e=>{console.log(e),TS.php("security.validateRepost",{bonus_id:this.bonus_id,post_id:e.post_id},(()=>{}),pre_control.onError),this.hideRepostButt()})).catch((e=>this.hideRepostButt()))}hideRepostButt(){helper.scaleAnimator("stop",this.compl.win.share_btn),gsap.killTweensOf(this.compl.win.share_btn),gsap.to(this.compl.win.share_btn.scale,{duration:.5,x:0,y:0,ease:"back.out(1.7)"})}showRepostButt(){gsap.to(this.compl.win.share_btn.scale,{duration:.5,x:1,y:1,ease:"back.out(1.7)",onComplete:()=>{helper.scaleAnimator("start",this.compl.win.share_btn)}}),this.repost_ivl=setInterval((()=>{clearInterval(this.repost_ivl),this.hideRepostButt()}),6e4)}hideComplete(){helper.alphaAnimation(this.compl,0,300,(()=>{root.layer2_mc.removeChild(this.compl),this.compl.alpha=1})),clearInterval(this.repost_ivl),this.hideRepostButt()}onGetLevel(e){for(window.complete_tree=!0,menu.tree_trig||menu.hideBigTrees();this.game.board_mc.picture_mc.children.length;)this.game.board_mc.picture_mc.removeChildAt(0);for(;this.game.board_mc.mask_mc.children.length;)this.game.board_mc.mask_mc.removeChildAt(0);let t=new PIXI.Texture.from(e.level.link),s=new PIXI.Sprite(t);for(this.game.board_mc.picture_mc.addChild(s);this.game.board_mc.chars_mc.children.length;)this.game.board_mc.chars_mc.removeChildAt(0);for(;this.game.board_mc.small_chars_mc.children.length;)this.game.board_mc.small_chars_mc.removeChildAt(0);this.big_chars=[],this.small_chars=[],this.game.board_mc.chars_mc.x=220.5-49*udata.level_progress.length/2-233;for(let e=0;e<udata.level_progress.length;e++){let t=helper.duplicate(this.big_char);e in udata.level_progress.word?t.tf_txt.text=this.arr_RU[udata.level_progress.word[e]]:t.tf_txt.text="",t.x=52*e,this.big_chars.push(t),this.game.board_mc.chars_mc.addChild(t)}for(let e=0;e<udata.level_progress.chars.length;e++){let t=helper.duplicate(this.small_char),s=Math.floor(e/(udata.level_progress.chars.length/2));t.x=55*e-udata.level_progress.chars.length/2*55*s,t.y=47*s,t.tf_txt.text=this.arr_RU[udata.level_progress.chars[e]],"Л"==t.tf_txt.text&&(t.tf_txt.text="V",t.tf_txt.rotation=Math.PI,t.tf_txt.y+=2*t.tf_txt.width),-1!==udata.level_progress.open_chars.indexOf(e)&&(t.visible=!1),this.small_chars.push(t),setButton(t.butt),t.butt.alpha=.01,t.butt.on("pointerdown",(e=>this.pressChar(e))),this.game.board_mc.small_chars_mc.addChild(t)}this.updPrices(),menu.tree_trig||this.showGame()}updPrices(){udata.my_bonuses.char=udata.my_bonuses.char||0,udata.my_bonuses.word=udata.my_bonuses.word||0,this.game.open_char.price_txt.text=udata.my_bonuses.char?"0":"-"+main_const.price_char,this.game.open_word.price_txt.text=udata.my_bonuses.word?"0":"-"+main_const.price_word}pressChar(e){let t=e.currentTarget.parent,s=this.small_chars.indexOf(t);-1!=s&&TS.php("game.selectChar",{cid:s},(e=>this.onSelectChar(e)),pre_control.onError)}pressKey(e){if(this.game.parent&&udata.level_progress.length&&!TS.mc.visible){debug_mode&&console.log("keyCode char: "+e.keyCode);for(let t=0;t<this.small_chars.length;t++)if(this.small_chars[t].visible){let s=this.keys_RU[udata.level_progress.chars[t]];if(debug_mode&&console.log("keyCode char: "+s),e.keyCode==s)return TS.php("game.selectChar",{cid:t},(e=>this.onSelectChar(e)),pre_control.onError)}}}openChar(){TS.php("game.openChar",{},(e=>{this.onSelectChar(e),this.updPrices()}),pre_control.onError)}openWord(){if(this.anim_openword)return;let e=udata.level_progress.word.length+1;TS.php("game.openWord",{},(t=>{let s=0,i=[];this.anim_openword=!0,this.updPrices();let o=()=>{i.word=t.word.slice(0,e+s),i.res=1,i.cid=t.chars[s],i.next_level=t.next_level,this.onSelectChar(i)};o();let a=setInterval((()=>{s++,void 0===t.chars[s+1]&&(i.complete_word=1,i.reward_info=t.reward_info,this.anim_openword=!1,clearInterval(a)),o()}),250)}),pre_control.onError)}onSelectChar(e){debug_mode&&console.log(JSON.stringify(e.word)),learn.check();let t=Boolean(parseInt(e.res)),s=Boolean(parseInt(e.complete_word)),i=Boolean(parseInt(e.next_level));if(debug_mode&&console.log(e),debug_mode&&console.log(t),menu.showValuta(),t){if(this.trueSelectChar(e.word.length-1,e.cid),sounds.playTrueChar(),s){let t=setInterval((()=>{clearInterval(t),this.showComplete(e.reward_info),i&&this.hideGame()}),400)}}else sounds.playLozeChar(),this.game.lifes_mc["life"+(5-udata.lifes)+"_mc"].gotoAndPlay(1),this.game.lifes_mc["life"+(5-udata.lifes)+"_mc"].boom_mc.gotoAndPlay(1),udata.lifes+1!=5||Boolean(parseInt(udata.lifes_unlim))||this.showLifesBlow()}trueSelectChar(e,t){this.big_chars[e].tf_txt.text="V"!==this.small_chars[t].tf_txt.text?this.small_chars[t].tf_txt.text:"Л",this.big_chars[e].tf_txt.alpha=0,helper.alphaAnimation(this.big_chars[e].tf_txt,1,150),helper.alphaAnimation(this.small_chars[t],0,150,(()=>this.small_chars[t].visible=!1))}downMasker(e){this.rounds_trig||(this.up_req=!1,main_const.brush=helper.copyJSON(this.comboBrush()),TS.php("game.downBrush",{},(t=>this.onValidDownBrush(t,e)),pre_control.onError))}comboBrush(){let e=udata.level,t=udata.levels_info.cnt[0]||0,s=main_const.brush_learn,i=main_const._brush,o={};return t>10||10==t&&1==e?i:(o.size=i.size+(s.size-i.size)*(1-e/50),o.first_time=i.first_time+(s.first_time-i.first_time)*(1-e/50),o.last_time=i.last_time+(s.last_time-i.last_time)*(1-e/50),o)}onValidDownBrush(e,t){if(this.local_start=new Date,this.server_start=e.start_time,this.server_end=e.crit_time,this.rounds_trig=!0,this.moveBoard(t,!0),this.up_req)return this.rounds_trig=!1,TS.php("game.upBrush",{micro:this.server_start},(e=>this.onValidUpBrush(e)),pre_control.onError);this.energy_ivl=setInterval((()=>{let e=new Date;this.server_start+(e-this.local_start)>=this.server_end&&(TS.php("game.upBrush",{micro:this.server_start+(e-this.local_start)},(e=>this.onValidUpBrush(e)),pre_control.onError),this.rounds_trig=!1,clearInterval(this.energy_ivl)),this.showEnergy(udata.energy-Math.floor((e-this.local_start)/udata.energytimer))}),10),this.brush_ivl||(this.brush_ivl=setInterval((()=>{this.rounds[0]&&(this.rounds[0].lifetime-=10,this.rounds[0].lifetime<=0&&(this.rounds[0].parent&&this.rounds[0].parent.removeChild(this.rounds[0]),this.rounds.shift()))}),10))}onValidUpBrush(){1==udata.level&&learn.check(),this.showEnergy(udata.energy)}moveBoard(e,t=!1){if(!this.rounds_trig)return;let s=new PIXI.Graphics,i=e.data.global;s.beginFill(),s.drawCircle(i.x,i.y,main_const.brush.size*scale_coef),s.endFill(),s.lifetime=t?main_const.brush.first_time:main_const.brush.last_time,this.rounds.push(s),this.mask_mc.addChild(s)}showEnergy(e){this.game.energy_mc.percent_txt.text=e+"%",this.game.energy_mc.color_mc.y=28-Math.min(100,e)/udata.emax*187,helper.alphaAnimation(this.game.energy_mc.time_txt,e<udata.emax?1:0,150)}upMasker(){if(this.up_req=!0,!this.rounds_trig)return;let e=new Date;TS.php("game.upBrush",{micro:this.server_start+(e-this.local_start)},(e=>this.onValidUpBrush(e)),pre_control.onError),this.rounds_trig=!1,clearInterval(this.energy_ivl)}showGame(){for(let e=0;e<this.up_blows.length;e++)this.game.blows_up.addChild(this.up_blows[e]);for(let e=0;e<this.down_blows.length;e++)this.game.blows_down.addChild(this.down_blows[e]);for(this.game.energy_mc.time_txt.alpha=0,this.showEnergy(udata.energy),this.updateLifes();this.mask_mc.children.length;)this.mask_mc.removeChildAt(0);root.layer0_mc.addChild(this.mask_mc),root.layer0_mc.addChild(this.game),learn.check()}updateLifes(){for(let e=0;e<5;e++)udata.lifes>e?this.game.lifes_mc["life"+(5-e)+"_mc"].gotoAndStop(1):this.game.lifes_mc["life"+(5-e)+"_mc"].gotoAndStop(17);udata.lifes<5&&0==this.game.lifes_mc.blow_mc.visible&&this.showLifesBlow(),TIMERS.timers.lifes_unlim||1!=parseInt(udata.lifes_unlim)||(this.showUnlim(),TIMERS.timers.lifes_unlim={init:!0,tick:e=>this.updateLifesUnlimTimer(e)})}hideGame(){this.compl.win.menu_mc.bg.gotoAndStop(1),this.compl.win.menu_mc.buttonMode=this.compl.win.menu_mc.interactive=!1,menu.init(),menu.showBigTrees((()=>{for(let e=0;e<this.up_blows.length;e++)pre_control.preloader.up_blows.addChild(this.up_blows[e]);for(let e=0;e<this.down_blows.length;e++)pre_control.preloader.down_blows.addChild(this.down_blows[e]);root.layer0_mc.removeChild(this.game)})),window.complete_tree=!0}constructScene(){this.game.board_mc.x=my_width/2,this.game.board_mc.y=my_height/2,this.game.board_mc.scale.x=this.game.board_mc.scale.y=this.game.lifes_mc.scale.x=this.game.lifes_mc.scale.y=this.game.energy_mc.scale.x=this.game.energy_mc.scale.y=scale_coef,this.game.lifes_mc.x=my_width/2-456*scale_coef,this.game.lifes_mc.y=my_height/2,this.game.energy_mc.x=my_width/2+374*scale_coef,this.game.energy_mc.y=my_height/2,this.game.open_char.x=this.game.open_word.x=my_width/2,this.game.open_char.y=this.game.open_word.y=my_height-105*scale_coef,this.game.open_char.scale.x=this.game.open_char.scale.y=this.game.open_word.scale.x=this.game.open_word.scale.y=scale_coef;let e=new PIXI.Graphics;e.beginFill(),e.drawRect(0,0,530,404),e.endFill(),this.game.board_mc.buttmask_mc.addChild(e),this.game.board_mc.buttmask_mc.alpha=.001,this.constructBackground(),this.constructSky()}constructBackground(){if(this.sky_trigger)return;let e=new PIXI.Graphics,t=Math.ceil(my_width/scale_coef/273);for(e.beginFill("0x573309"),e.drawRect(0,0,my_width,my_height),e.endFill();this.game.bg_mc.children.length;)this.game.bg_mc.removeChildAt(0);for(;this.game.lines_mc.children.length;)this.game.lines_mc.removeChildAt(0);this.game.lines_mc.y=my_height;let s=my_height/devicePixelRatio>1e3?1:0;for(let e=0;e<=s;e++)for(let s=0;s<t;s++){let t=helper.duplicate(this.bg_lines);t.x=273*s,t.y=-1*(t.height-10)*e*2,e&&(t.scale.y=-1),t.x-=136*e,this.game.lines_mc.addChild(t)}this.game.lines_mc.scale.x=this.game.lines_mc.scale.y=scale_coef,this.game.tree1_mc.scale.x=this.game.tree1_mc.scale.y=scale_coef,this.game.btree1_mc.scale.x=this.game.btree1_mc.scale.y=scale_coef,this.game.tree2_mc.scale.x=this.game.tree2_mc.scale.y=scale_coef,this.game.btree2_mc.scale.x=this.game.btree2_mc.scale.y=scale_coef,this.game.tree1_mc.x=-1*this.game.tree1_mc.width/5,this.game.btree1_mc.x=-1*this.game.btree1_mc.width/2,this.game.tree2_mc.x=my_width-this.game.tree2_mc.width/3*2,this.game.btree2_mc.x=my_width-this.game.btree2_mc.width/2,this.game.bg_mc.addChild(e)}constructSky(){if(this.game.sun_mc.x=my_width/2,this.game.sunlight_mc.x=my_width/2,this.game.sky_mc.x=my_width/2,this.game.blows_up.y=this.game.blows_down.y=-150*scale_coef,this.sky_trigger)return;if(!this.up_blows[0])for(let e=0;e<pre_control.preloader.up_blows.children.length;e++)this.up_blows.push(pre_control.preloader.up_blows.children[e]);if(!this.down_blows[0])for(let e=0;e<pre_control.preloader.down_blows.children.length;e++)this.down_blows.push(pre_control.preloader.down_blows.children[e]);let e=Math.ceil((my_width/2-501*scale_coef)/110);1!==scale_coef&&(e=Math.ceil((my_width/2-501*scale_coef)/108));for(let t=0;t<e;t++){let e=helper.duplicate(this.sky),s=helper.duplicate(this.sky);1!==scale_coef?(e.x=500+108*t,s.x=-610-108*t):(e.x=501+110*t,s.x=-611-110*t),this.game.sky_mc.addChild(e),this.game.sky_mc.addChild(s)}this.game.sky_mc.scale.x=this.game.sky_mc.scale.y=scale_coef,this.sky_trigger=1}showLifesBlow(){this.game.lifes_mc.blow_mc.p1_mc.scale.x=this.game.lifes_mc.blow_mc.p1_mc.scale.y=0,this.game.lifes_mc.blow_mc.p2_mc.scale.x=this.game.lifes_mc.blow_mc.p2_mc.scale.y=0,this.game.lifes_mc.blow_mc.p3_mc.scale.x=this.game.lifes_mc.blow_mc.p3_mc.scale.y=0,this.game.lifes_mc.blow_mc.tf_txt.alpha=0,this.game.lifes_mc.blow_mc.visible=!0,gsap.to(this.game.lifes_mc.blow_mc.p1_mc.scale,{duration:.15,x:1,y:1,ease:"back.out(1.7)",onComplete:()=>{gsap.to(this.game.lifes_mc.blow_mc.p2_mc.scale,{duration:.15,x:1,y:1,ease:"back.out(1.7)",onComplete:()=>{gsap.to(this.game.lifes_mc.blow_mc.p3_mc.scale,{duration:.15,x:1,y:1,ease:"back.out(1.7)"}),helper.alphaAnimation(this.game.lifes_mc.blow_mc.tf_txt,1,300)}})}})}hideLifesBlow(){helper.alphaAnimation(this.game.lifes_mc.blow_mc.tf_txt,0,150,(()=>{gsap.to(this.game.lifes_mc.blow_mc.p3_mc.scale,{duration:.15,x:0,y:0,ease:"none",onComplete:()=>{gsap.to(this.game.lifes_mc.blow_mc.p2_mc.scale,{duration:.15,x:0,y:0,ease:"none",onComplete:()=>{gsap.to(this.game.lifes_mc.blow_mc.p1_mc.scale,{duration:.15,x:0,y:0,ease:"none",onComplete:()=>this.game.lifes_mc.blow_mc.visible=!1})}})}})}))}updateOtkatTimer(e){if("max"==e.status)return udata.energytimer=main_const.energy_diff,helper.alphaAnimation(this.game.energy_mc.bonus_mc,0);helper.alphaAnimation(this.game.energy_mc.bonus_mc,1)}updateEnergyTimer(e){if("max"==e.status)return this.showEnergy(udata.energy);let t=e.time,s=parseInt(t/60);t%=60,s%=60,this.game.energy_mc.time_txt.text=helper.getZeros(s)+":"+helper.getZeros(t),this.showEnergy(udata.energy)}updateLifesTimer(e){if("max"==e.status)return this.game.lifes_mc.blow_mc.visible&&!Boolean(parseInt(udata.lifes_unlim))&&this.hideLifesBlow(),this.updateLifes();if(Boolean(parseInt(udata.lifes_unlim)))return;let t=e.time,s=parseInt(t/60);t%=60,s%=60,this.game.lifes_mc.blow_mc.tf_txt.text="+1 через \n"+helper.getZeros(s)+":"+helper.getZeros(t),this.updateLifes()}updateLifesUnlimTimer(e){if("max"==e.status)return udata.lifes_unlim=0,console.log("sasay"),this.hideUnlim(),this.updateLifes();if(!Boolean(parseInt(udata.lifes_unlim)))return;this.showUnlim();let t=e.time,s=parseInt(t/60);t%=60,s%=60,this.game.lifes_mc.blow_mc.tf_txt.text="активно \n"+helper.getZeros(s)+":"+helper.getZeros(t)}showUnlim(){this.game.lifes_mc.blow_mc.visible||this.showLifesBlow();for(let e=1;e<=5;e++)helper.alphaAnimation(this.game.lifes_mc["life"+e+"_mc"],0);helper.alphaAnimation(this.game.lifes_mc.unlim_mc,1)}hideUnlim(){for(let e=1;e<=5;e++)helper.alphaAnimation(this.game.lifes_mc["life"+e+"_mc"],1);helper.alphaAnimation(this.game.lifes_mc.unlim_mc,0)}initButtons(){setButton(this.game.board_mc.exit_mc),setButton(this.game.board_mc.buttmask_mc),setButton(this.compl.win.close_mc),setButton(this.compl.win.next_mc.bg),setButton(this.compl.win.menu_mc),setButton(this.compl.win.share_btn),setButton(this.compl.win.restart_btn),setButton(this.game.open_char.bg),setButton(this.game.open_word.bg)}initStyles(){setTextStyle(this.game.energy_mc.percent_txt,{dropShadow:!0,dropShadowAlpha:.24,dropShadowAngle:90,dropShadowDistance:3,miterLimit:3,stroke:"#6e2613",strokeThickness:5}),setTextStyle(this.game.energy_mc.time_txt,{dropShadow:!0,dropShadowAlpha:.24,dropShadowAngle:90,dropShadowDistance:3,miterLimit:3,stroke:"#6e2613",strokeThickness:5}),setTextStyle(this.game.open_char.price_txt,{dropShadow:!0,dropShadowAlpha:.12,dropShadowAngle:90,dropShadowDistance:3,miterLimit:2,stroke:"#763c24",strokeThickness:4}),setTextStyle(this.game.open_word.price_txt,{dropShadow:!0,dropShadowAlpha:.12,dropShadowAngle:90,dropShadowDistance:3,miterLimit:2,stroke:"#763c24",strokeThickness:4}),setTextStyle(this.compl.win.share_btn.tf_txt,{dropShadow:!0,dropShadowAlpha:.12,dropShadowAngle:90,dropShadowDistance:3,miterLimit:2,stroke:"#763c24",strokeThickness:4}),setTextStyle(this.compl.win.first_mc.exp_txt,{dropShadow:!0,dropShadowAlpha:.24,dropShadowAngle:90,dropShadowDistance:3,miterLimit:3,stroke:"#996602",strokeThickness:5}),setTextStyle(this.compl.win.second_mc.second_txt,{dropShadow:!0,dropShadowAlpha:.24,dropShadowAngle:90,dropShadowDistance:3,miterLimit:3,stroke:"#996602",strokeThickness:5}),setTextStyle(this.compl.win.congrat_txt,{dropShadow:!0,dropShadowAlpha:1,dropShadowAngle:90,dropShadowDistance:3,miterLimit:3,stroke:"#622703",strokeThickness:7,stroke:"#843606"})}}class i{constructor(e,t,s){this.shop=e,this.slot=t,this.minis=s,this.category=0,this.page=0,this.slots=[],this.shop.interactive=!0,this.initButtons(),this.initStyles();for(let e=0;e<5;e++)this.shop.win["menu"+(e+1)+"_btn"].on("pointertap",(()=>{sounds.playClick(),e!==this.category&&this.showShop(e)}));this.shop.win.close_mc.on("pointertap",(()=>{sounds.playClick(),this.hideShop()})),bridge.subscribe((e=>{"VKWebAppShowOrderBoxResult"==e.detail.type&&this.successDonat(e)}))}init(e=0){if(this.shop.parent)return this.showShop(e);this.shop.win.x=my_width/scale_coef/2,this.shop.win.y=my_height/scale_coef/2,this.shop.scale.x=this.shop.scale.y=scale_coef,this.shop.btree1_mc||(this.shop.tree1_mc=helper.duplicate(modules.big_tree),this.shop.tree2_mc=helper.duplicate(modules.big_tree),this.shop.btree1_mc=helper.duplicate(modules.big_blur_tree),this.shop.btree2_mc=helper.duplicate(modules.big_blur_tree),this.shop.addChild(this.shop.tree1_mc,this.shop.tree2_mc,this.shop.btree1_mc,this.shop.btree2_mc),this.shop.btree1_mc.y=menu.blur_trees_array[0].y,this.shop.btree2_mc.y=menu.blur_trees_array[1].y,this.shop.tree1_mc.scale.x=this.shop.tree1_mc.scale.y=scale_coef,this.shop.btree1_mc.scale.x=this.shop.btree1_mc.scale.y=scale_coef,this.shop.tree2_mc.scale.x=this.shop.tree2_mc.scale.y=scale_coef,this.shop.btree2_mc.scale.x=this.shop.btree2_mc.scale.y=scale_coef,this.shop.tree1_mc.x=-1*this.shop.tree1_mc.width/5-(my_width/scale_coef<1400?50*scale_coef:0),this.shop.btree1_mc.x=-1*this.shop.btree1_mc.width/2,this.shop.tree2_mc.x=my_width/scale_coef-this.shop.tree2_mc.width/3*2+(my_width/scale_coef<1400?50*scale_coef:0),this.shop.btree2_mc.x=my_width/scale_coef-this.shop.btree2_mc.width/2),helper.numberAnimation(this.shop.win.medals_txt,udata.medals),helper.drawShadow(this.shop.shadow_mc,null,!1),window.complete_tree=!0,menu.showBigTrees((()=>{this.showShop(e)}))}nextPage(){}prevPage(){}showShop(e){this.category=e;for(let t=0;t<5;t++)gsap.to(this.shop.win["menu"+(t+1)+"_btn"],{duration:.2,y:(t==e?5:0)-230});this.constructCat(),this.shop.parent||root.layer1_mc.addChild(this.shop)}filterCat(e){e=helper.copyJSON(e);for(let t=0;t<e.length;t++){let s=e[t],i=shop_info.items[s].key;udata.ads_limits[i]=udata.ads_limits[i]||0,udata.ads_limits[i]>=main_const.ads_limits[i]&&"ads"==shop_info.items[s].price_type&&e.splice(t,1)}return e}constructCat(){for(;this.shop.win.slots_mc.children.length;)this.shop.win.slots_mc.removeChildAt(0);this.slots=[],shop_info.categories[this.category]=shop_info.categories[this.category]||[];let e=this.filterCat(shop_info.categories[this.category]);for(let t=8*this.page;t<e.length&&t-8*this.page<8;t++){let s=Math.floor((t-8*this.page)/4),i=helper.duplicate(this.slot);this.slots.push(i);let o=e[t];switch(i.x=147*(t-8*this.page)-4*s*147,i.y=214*s,i.price_mc.value_txt.text=shop_info.items[o].price,i.price_mc.icons_mc.gotoAndStop(shop_info.items[o].price_type),i.icons_mc.gotoAndStop(o),i.buy_btn.gotoAndStop(1),this.constructBuyButton(i.buy_btn,o),setTextStyle(i.price_mc.value_txt,{dropShadow:!0,dropShadowAlpha:.12,dropShadowAngle:90,dropShadowDistance:3,miterLimit:3,stroke:"#443f3d",strokeThickness:3}),shop_info.items[o].price_type){case"ads":i.price_mc.value_txt.visible=!1;break;case"votes":setTextStyle(i.price_mc.value_txt,{fill:"#bfdde0"})}shop_info.items[o].timer&&(i.timer_mc.alpha=1,i.timer_mc.tf_txt.text="на "+Math.floor(shop_info.items[o].timer/60)+" мин"),i.buy_btn.interactive=i.buy_btn.buttonMode=!0,i.buy_btn.on("mouseover",(e=>this.overBuy(e))),i.buy_btn.on("mouseout",(e=>this.outBuy(e))),i.scale.x=i.scale.y=0,gsap.to(i.scale,{duration:.15*(t-8*this.page+1),x:1,y:1,ease:"back.out(1.7)"}),this.shop.win.slots_mc.addChild(i)}}constructBuyButton(e,t){switch(shop_info.items[t].price_type){case"ads":e.gotoAndStop(3),e.on("pointertap",(s=>{sounds.playClick(),bridge.send("VKWebAppCheckNativeAds",{ad_format:"reward",use_waterfall:!0}).then((s=>{console.log(s),this.add_item=t,this.add_iof=this.slots.indexOf(e.parent),TS.php("shop.newAd",{item_id:t},(e=>this.successInitAd(e)),pre_control.onError)}))}));break;case"votes":e.on("pointertap",(s=>{sounds.playClick(),bridge.send("VKWebAppShowOrderBox",{type:"item",item:"item"+t}),this.vote_item=t,this.vote_iof=this.slots.indexOf(e.parent)}));break;default:e.on("pointertap",(s=>{sounds.playClick(),TS.php("shop.buy",{item_id:t},(s=>this.onSuccessBuy(this.slots.indexOf(e.parent),t)),pre_control.onError)}))}}successInitAd(e){this.add_id=e.ad_id.id,bridge.send("VKWebAppShowNativeAds",{ad_format:"reward",use_waterfall:!0}).then((e=>{console.log(e),e.result&&TS.php("shop.endAd",{ad_id:this.add_id},(e=>this.successEndAd(e)),pre_control.onError)})).catch((e=>console.log(e)))}successEndAd(e){this.onSuccessBuy(this.add_iof,this.add_item)}successDonat(e){udata[shop_info.items[this.vote_item].key]=parseInt(udata[shop_info.items[this.vote_item].key])+parseInt(shop_info.items[this.vote_item].value),this.onSuccessBuy(this.vote_iof,this.vote_item)}onSuccessBuy(e,t){if(e<0)return;sounds.playBuy();let s=shop_info.items[t],i={x:this.slots[e].worldTransform.tx,y:this.slots[e].worldTransform.ty};switch(s.key){case"energy":helper.iconGenerator(this.minis.energy_mini,s.value,i,"energy");break;case"lifes":case"lifes_unlim":helper.iconGenerator(this.minis.lifes_mini,s.value,i,"life");break;case"energytimer":helper.iconGenerator(this.minis.otkat_mini,s.value,i);break;case"exp":helper.iconGenerator(this.minis.exp_mini,s.value,i,"star");break;case"medals":helper.iconGenerator(this.minis.medals_mini,s.value,i,"medal")}menu.showValuta(),helper.numberAnimation(this.shop.win.medals_txt,udata.medals),game&&(game.showEnergy(udata.energy),game.updateLifes())}overBuy(e){let t=e.currentTarget;switch(t.currentFrame){case 1:t.gotoAndStop(2);break;case 3:t.gotoAndStop(4)}}outBuy(e){let t=e.currentTarget;switch(t.currentFrame){case 2:t.gotoAndStop(1);break;case 4:t.gotoAndStop(3)}}hideShop(){window.complete_tree=!0,menu.showBigTrees((()=>root.layer1_mc.removeChild(this.shop)))}initButtons(){setButton(this.shop.win.close_mc),setButton(this.shop.win.prev_btn),setButton(this.shop.win.next_btn),setButton(this.shop.win.menu1_btn),setButton(this.shop.win.menu2_btn),setButton(this.shop.win.menu3_btn),setButton(this.shop.win.menu4_btn),setButton(this.shop.win.menu5_btn)}initStyles(){setTextStyle(this.shop.win.medals_txt,{dropShadow:!0,dropShadowAlpha:.12,dropShadowAngle:90,dropShadowDistance:3,miterLimit:3,stroke:"#443f3d",strokeThickness:5})}}var o=__webpack_require__(412);class a{constructor(e){window.TIME=parseInt(e),window.DATE=new Date(1e3*TIME),window.SEASON=["winter","spring","summer","autumn"][parseInt((DATE.getMonth()+1)/3)%4],this.start_t=(new Date).getTime(),this.current_energy=0,this.timers={},this.interval=setInterval((()=>{this.tick()}),100)}tick(){let e=(new Date).getTime(),t=Math.floor((e-this.start_t)/1e3);if(TIME+=t,!t)return;this.start_t=e;let s=new Date,i=Math.floor(s.getTimezoneOffset()/60)+3;DATE=new Date(1e3*(TIME+3600*i)),SEASON=["winter","spring","summer","autumn"][parseInt((DATE.getMonth()+1)/3)%4];let o=Object.keys(this.timers);for(let e=0;e<o.length;e++)this.timers[o[e]].init&&this.timers[o[e]].tick(this[o[e]+"Control"]())}energyControl(){if(parseInt(udata.energy)>=parseInt(udata.emax))return{status:"max"};let e=Math.floor((TIME-parseInt(udata.etime))/udata.energytimer),t=0;return e<0?void 0:(e>parseInt(udata.emax)-parseInt(udata.energy)&&(e=parseInt(udata.emax)-parseInt(udata.energy)),udata.energy=parseInt(udata.energy)+e,parseInt(udata.energy)>=parseInt(udata.emax)?(udata.energy=udata.emax,udata.etime=TIME,{status:"plus",time:0}):(t=(e+1)*udata.energytimer-(TIME-parseInt(udata.etime)),e>0?(udata.etime=TIME-(udata.energytimer-t),{status:"plus",time:t}):{status:"tick",time:t}))}otkatControl(){return TIME-parseInt(udata.otkat_bonus_timer)>0?{status:"max"}:{status:"tick",time:parseInt(udata.otkat_bonus_timer)-TIME}}lifes_unlimControl(){return TIME-parseInt(udata.full_lifes_timer)>0?{status:"max"}:{status:"tick",time:parseInt(udata.full_lifes_timer)-TIME}}lifesControl(){if(parseInt(udata.lifes)>=5)return{status:"max"};let e=Math.floor((TIME-parseInt(udata.lifetime))/udata.lifetimer),t=0;return e<0?void 0:(e>5-parseInt(udata.lifes)&&(e=5-parseInt(udata.lifes)),udata.lifes=parseInt(udata.lifes)+e,parseInt(udata.lifes)>=5?(udata.lifes=5,udata.lifetime=TIME,{status:"plus",time:0}):(t=(e+1)*udata.lifetimer-(TIME-parseInt(udata.lifetime)),e>0?(udata.lifetime=TIME-(udata.lifetimer-t),{status:"plus",time:t}):{status:"tick",time:t}))}}window.bridge=vkBridge,window.debug_mode=!1;let r,l=document.location.search.substr(1).split("&"),n={};for(let e=0;e<l.length;e++)r=l[e].split("="),n[r[0]]=r[1];bridge.send("VKWebAppInit").then((e=>{if(window.VKinit=!0,window.VKPlatform=n.platform,"web"!==window.VKPlatform||!debug_mode)return;let t=new Stats;t.showPanel(0),document.body.appendChild(t.dom),requestAnimationFrame((function e(){t.begin(),t.end(),requestAnimationFrame(e)}))})),window.load_info=window.prog=window.root=window.udata=window.pre_control=null,window.vk_params=n,window.VK_token=vk_params.access_token,window.VK_version="5.120",window.bridge=bridge,window.session_hash=md5(Math.floor(1e6*Math.random()).toString()),window.helper=new class{constructor(){this.scale_anims=[]}iconGenerator(e,t,s={x:0,y:0},i=null){let o=[],a=[-1,1];switch(i){case"star":s.eX=menu.exp.x,s.eY=menu.exp.y;break;case"medal":s.eX=menu.medals.x,s.eY=menu.medals.y;break;case"life":s.eX=0,s.eY=my_height/2;break;case"energy":s.eX=my_width,s.eY=my_height/2;break;default:s.eX=my_width,s.eY=0}let r=setInterval((()=>{clearInterval(r);for(let e=0;e<o.length;e++)this.alphaAnimation(o[e],0,1e3),gsap.to(o[e],{duration:1,x:s.eX,y:s.eY,ease:"power1.out"});r=setInterval((()=>{for(let e=0;e<o.length;e++){let e=o.pop();e.parent&&e.parent.removeChild(e)}clearInterval(r)}),1e3)}),700);"life"!==i&&(t=Math.abs(Math.ceil(Math.min(21,t)/3)));for(let i=0;i<t;i++){let t=this.duplicate(e);t.x=s.x,t.y=s.y,t.scale.x=t.scale.y=scale_coef,root.layer2_mc.addChild(t),o.push(t),gsap.to(t,{duration:.5,x:s.x+40*Math.random()*a[Math.floor(2*Math.random())],y:s.y+30*Math.random()+20,ease:"bounce.out"})}}scaleAnimator(e,t){let s=e=>{gsap.to(e.scale,{duration:.3,x:.95,y:.95,ease:"none",onComplete:()=>{"stop"!=e.status?i(e):e.go_anim=!1}})},i=e=>{gsap.to(e.scale,{duration:.3,x:1,y:1,ease:"none",onComplete:()=>{"stop"!=e.status?s(e):e.go_anim=!1}})};-1==this.scale_anims.indexOf(t)&&this.scale_anims.push(t),t.status=e;for(let e=0;e<this.scale_anims.length;e++)this.scale_anims[e].go_anim||"start"!=this.scale_anims[e].status||s(this.scale_anims[e])}alphaAnimation(e,t=1,s=100,i=null){let o=Math.floor(performance.now()),a=s,r=e.alpha;if(r==t)return void(i&&i());let l=setInterval((()=>{let s=(Math.floor(performance.now())-o)/a;e.alpha=r<t?r+(t-r)*s:r-(r-t)*s,s>=1&&(e.alpha=t,e.alpha>1&&(e.alpha=1),e.alpha<0&&(e.alpha=0),clearInterval(l),i&&i())}),1)}gradient(e,t,s=null){let i=document.createElement("canvas");i.setAttribute("height",my_height),i.setAttribute("width",my_width);let o=i.getContext("2d"),a=o.createLinearGradient(0,0,0,my_height/2);return a.addColorStop(0,e),s&&a.addColorStop(.42,s),a.addColorStop(1,t),o.fillStyle=a,o.fillRect(0,0,my_width,my_height),new PIXI.Sprite(new PIXI.Texture.from(i))}clickControl(e,t,s,i){e.on("pointerdown",(s=>{t&&t(s),e.dn_trig=!0,i&&this.ivls.push(setInterval((()=>{for(let e=0;e<this.ivls.length;e++)clearInterval(this.ivls[e]);e.dn_trig=!1,i(s)}),200))})),e.on("pointerup",(t=>{s&&e.dn_trig&&s(t)}))}duplicate(e){return new e.constructor}getZeros(e){let t="";return t=e<10?"0"+e:+e,t}shortText(e){let t=[1,1e3,1e6,1e9,1e12,1e15],s=t.length-1;for(;e/t[s]<1&&s>0;)s--;let i=e/t[s];return Math.round(10*i)/10+["","K","M","B","T","q"][s]}fullText(e){let t=(e.substring(0,e.length-1),e.substring(e.length-1,e.length));return isNaN(t)?parseFloat(e)*[1,1e3,1e6,1e9,1e12,1e15][["","K","M","B","T","q"].indexOf(t)]:parseInt(e)}numberAnimation(e,t,s=100,i=null){if(e.text==this.shortText(t))return void(i&&i());let o=Math.floor(performance.now()),a=0;a=this.fullText(e.text);let r=parseInt(t),l=s,n=setInterval((()=>{let t=(Math.floor(performance.now())-o)/l;e.text=r<a?this.shortText(parseInt(a-(a-r)*t)):this.shortText(parseInt(a+(r-a)*t)),t>=1&&(e.text=this.shortText(r),clearInterval(n),i&&i())}),1)}levelComplete(e){let t=[0,10,50,100],s=[3,2,1,0];for(let i=t.length-1;i>=0;i--)if(e>=t[i])return s[i]}getJSON(e,t,s){let i=new XMLHttpRequest;i.open("GET",e+"?h="+session_hash),i.responseType="json",i.send(),i.addEventListener("loadend",(()=>{4===i.readyState&&200===i.status?t(i.response):s(errors[1])}))}loadPhoto50(e,t=null,s=null){let i=bitmaps50.id.indexOf(e);return-1!==i&&(s=bitmaps50.bm[i]),bitmaps50.name[i]||(bitmaps50.name[i]="Пригласить"),s?s!==null_photo50&&s.split("userapi.com").length<2?(bitmaps50.id.push(e),bitmaps50.name.push(data.response[0].first_name),bitmaps50.bm.push(null_photo50),this.loadPhoto50(e,t,null_photo50)):void(t&&t({photo:new PIXI.Sprite.from(s),name:bitmaps50.name[i]})):bridge.sendPromise("VKWebAppCallAPIMethod",{method:"users.get",params:{fields:"photo_50",user_ids:e,access_token:VK_token,v:VK_version}}).then((s=>{this.loadPhoto50(e,t,s.response[0].photo_50),bitmaps50.id.push(e),bitmaps50.name.push(s.response[0].first_name),bitmaps50.bm.push(s.response[0].photo_50)}))}pushPhoto50(e,t=null){for(let t=0;t<e.length;t++){let s=bitmaps50.id.indexOf(e[t]);-1!==s&&e.slice(s,1)}e.length<1?t&&t(!0):bridge.sendPromise("VKWebAppCallAPIMethod",{method:"users.get",params:{fields:"photo_50",user_ids:e.join(","),access_token:VK_token,v:VK_version}}).then((e=>{for(let t=0;t<e.response.length;t++)bitmaps50.id.push(e.response[t].id),bitmaps50.name.push(e.response[t].first_name),e.response[t].photo_50.split("userapi.com").length<2?bitmaps50.bm.push(e.response[t].photo_50):bitmaps50.bm.push(null_photo50);t&&t(!0)})).catch((()=>{t&&t(!1)}))}drawShadow(e,t,s=!0){if(e.alpha=0,e.children.length<1){let t=new PIXI.Graphics;t.beginFill("0x333333"),t.drawRect(0,0,my_width,my_height),t.endFill(),e.addChild(t),e.scale.x=e.scale.y=scale_coef}s?this.alphaAnimation(e,.33,200,(()=>{t&&t()})):(e.alpha=.33,t&&t())}parse(e){let t=[];try{t=JSON.parse(e)}catch(e){}return t}encode64(e){return btoa(unescape(encodeURIComponent(e)))}decode64(e){try{return decodeURIComponent(escape(window.atob(e)))}catch(t){return e}}toKeyVals(e){return e[0]?{keys:"key",values:e}:{keys:Object.keys(e),values:Object.values(e)}}copyJSON(e){return JSON.parse(JSON.stringify(e))}},window.modules=new class{constructor(){this.flags={},this.names={}}load(e,t){window[content_links[e]].setup(PIXI.animate),scene.load(window[content_links[e]],(s=>{this.flags[e]=!0,this.names[e]=s,this.nulledXY(s),t&&t()}))}loadMenu(e){this.load("menu",e)}loadGame(e){this.load("game",e)}loadShop(e){this.load("shop",e)}constructMenu(){window.menu=new t(this.names.menu.main_level_icon,this.names.menu.main_exp,this.names.menu.main_medals,this.names.menu.main_shop_icon,this.names.menu.main_friends,this.names.menu.main_friends_icon,{bird_blue:this.names.menu.main_bbird,bird_red:this.names.menu.main_rbird,airplane:this.names.menu.main_airplane,rocket:this.names.menu.main_rocket,ufo:this.names.menu.main_ufo},this.names.menu.main_settings,this.names.menu.main_settings_icon),window.learn=new o.Z(this.names.menu.learn_hand)}constructGame(){window.game=new s(this.names.game.game_full,this.names.game.game_lines,this.names.game.game_body_sky,this.names.game.game_yellow_char,this.names.game.game_char_red,this.names.game.game_complete),this.big_tree=helper.duplicate(this.names.game.game_full.tree1_mc),this.big_blur_tree=helper.duplicate(this.names.game.game_full.btree1_mc)}constructShop(){window.shop=new i(this.names.shop.shop_full,this.names.shop.shop_slot,this.names.shop.shop_mini)}nulledXY(e){let t=Object.keys(e);for(;e.children.length;)e.removeChildAt(0);for(let s=0;s<t.length;s++)null!==e[t[s]]&&"object"==typeof e[t[s]]&&(e[t[s]].x=e[t[s]].y=0)}checkFlags(e,t){for(let s=0;s<e.length;s++)if(!this.flags[e[s]])return TS.mc&&(TS.mc.visible=!0),void this["load"+this.ucFirst(e[s])]((()=>{this["construct"+this.ucFirst(e[s])]&&this["construct"+this.ucFirst(e[s])](),TS.mc&&(TS.mc.visible=!1),this.checkFlags(e,t)}));t&&t()}ucFirst(e){return e?e[0].toUpperCase()+e.slice(1):e}},window.sounds=new class{constructor(){}playBackMusic(){window.bg_music||(window.bg_music=PIXI.sound.Sound.from({url:sound_cfg.main_theme.url,volume:localStore.music?.2:0,loop:!0,autoPlay:!0}))}playLozeChar(){localStore.sound&&this.playCustom(sound_cfg.loze_char)}playTrueChar(){localStore.sound&&this.playCustom(sound_cfg.right_char)}playComplete(){localStore.sound&&this.playCustom(sound_cfg.complete)}playBuy(){localStore.sound&&this.playCustom(sound_cfg.buy)}playClick(){localStore.sound&&this.playCustom(sound_cfg.default_click)}playCustom(e){PIXI.sound.Sound.from({url:e.url,volume:e.volume,loop:!1,autoPlay:!0})}},window.my_server="https://tolmasoft.com/gameword/server",window.debug_mode&&(window.my_server="https://tolmasoft.com/gameword/_test/server"),window.TS=new class{constructor(e,t){this.arr=e,this.mc=t,this.scriptURL=this.arr[3]+"/universal.php",this.req_key="skriYjhHx",this.reqs=[],this.wait=!1,this.reqsJSON=[],window.errors=[{text:"Undefined function",code:0},{text:"Invalid request",code:1},{text:"Output have invalid format",code:2}],this.mc&&this.drawMC()}drawMC(){this.mc||(this.mc=new PIXI.Graphics,this.mc.beginFill(),this.mc.drawRect(0,0,my_width,my_height),this.mc.endFill(),this.mc.alpha=.01,this.mc.visible=!1,this.mc.interactive=!0,root.layer2_mc.addChild(this.mc))}php(e,t,s,i){this.reqs.push({m:e,p:t,c:s,e:i}),this.nextReq(),window.debug_mode&&(console.log(e),console.log(t))}nextReq(){this.wait||this.reqs.length<=0||(this.thisReq=this.reqs.shift(),this.loadReq(this.thisReq.m,this.thisReq.p),!this.mc&&root.layer2_mc&&this.drawMC(),this.mc&&(this.mc.visible=!0))}loadReq(e,t){this.MSS=new XMLHttpRequest,this.parameters=JSON.stringify(t),this.MSSURL=this.scriptURL+"?h="+md5(Math.floor(1e6*Math.random()).toString()),this.MSSparams="method="+e+"&params="+btoa(btoa(this.parameters))+"&token="+this.token+"&uid="+this.arr[1]+"&user_id="+this.arr[4],this.MSSparams+="&auth="+this.arr[2],this.MSSparams+="&req_key="+this.req_key,this.MSS.open("POST",this.MSSURL,!0),this.MSS.setRequestHeader("Content-type","application/x-www-form-urlencoded"),this.MSS.send(this.MSSparams),this.MSS.addEventListener("loadend",(()=>this.completeRequest(this.MSS)))}completeRequest(e){if(4===this.MSS.readyState&&200===this.MSS.status)try{this.json=JSON.parse(this.MSS.response.toString().trim())}catch(e){this.json=errors[2],this.json.status="error"}else this.json=errors[1],this.json.status="error";window.debug_mode&&console.log(e),this.json.current_time&&(window.TIMERS?TIME=this.json.current_time:window.TIMERS=new a(this.json.current_time)),this.parseUD(),this.req_key=this.json.req_key,"error"==this.json.status?this.onError():this.onComplete(),this.mc&&(this.mc.visible=!1),this.nextReq()}onError(){Boolean(this.thisReq.e)&&this.thisReq.e(this.json)}onComplete(){Boolean(this.thisReq.c)&&this.thisReq.c(this.json)}parseUD(){this.json.udata&&(window.udata=this.json.udata),this.json.brush_info&&(window.udata=this.json)}}([vk_params.api_id,vk_params.viewer_id,vk_params.auth_key,my_server,vk_params.user_id]),window.bitmaps50={id:[],bm:[],name:[]},window.bitmaps100={id:[],bm:[],name:[]},window.bitmaps200={id:[],bm:[],name:[]},window.null_photo50=my_server+"/images/noicon.png",window.null_photo100=my_server+"/images/noicon100.png",window.null_photo200=my_server+"/images/noicon200.png",window.endLoadGame=()=>{window.init_game||(window.init_game=!0,helper.alphaAnimation(pre_control.preloader.logo_game,0,500,(()=>{for(;root.children.length;)root.removeChildAt(0);for(let e=0;e<3;e++)root["layer"+e+"_mc"]=new PIXI.Container,root.addChild(root["layer"+e+"_mc"]);learn.init(),menu.init()})))},window.loadGame=()=>{modules.checkFlags(["game","menu"],(()=>{window.end_load=!0,window.show_logo&&window.data_load&&endLoadGame()}))},window.canv=document.createElement("canvas"),canv.setAttribute("id","stage"),canv.setAttribute("width","100%"),canv.setAttribute("height","100%"),document.body.appendChild(canv),PIXI.settings.ROUND_PIXELS=!0;window.setButton=e=>{e.interactive=!0,e.buttonMode=!0,e._totalFrames=e._totalFrames||1,e._totalFrames<2||(e.gotoAndStop(0),e.on("mouseover",(()=>e.gotoAndStop(1))),e.on("mouseout",(()=>e.gotoAndStop(0))))},window.include=e=>{let t=document.createElement("script");t.src=e,t.type="text/javascript",document.getElementsByTagName("head")[0].appendChild(t)},window.include_preload=(e,t="font/ttf")=>{let s=document.createElement("link");s.rel="preload",s.href=e,s.as="font",s.type=t,s.crossorigin=!0,document.getElementsByTagName("head")[0].appendChild(s)},window.setTextStyle=(e,t={})=>{let s=Object.keys(t);for(let i=0;i<s.length;i++)e.style[s[i]]=t[s[i]]},window.iconScaleIn=e=>{let t=e.currentTarget;gsap.to(t.scale,{duration:.2,x:1.05,y:1.05,ease:"back.out(3)"})},window.iconScaleOut=e=>{let t=e.currentTarget;gsap.to(t.scale,{duration:.1,x:1,y:1})};let h=e=>{if(window.WebGLRenderingContext){let s=document.createElement("canvas"),i=["webgl","experimental-webgl","moz-webgl","webkit-3d"],o=!1;for(var t=0;t<4;t++)try{if(o=s.getContext(i[t]),o&&"function"==typeof o.getParameter)return!e||{name:i[t],gl:o}}catch(e){}return!1}return!1};((e=!1)=>{window.localStore=[];let t={music:!0,sound:!0,canvas:!1};var s;h()||(t={music:!0,sound:!0,canvas:!0}),s=s=>{let i=(()=>{try{let e;return localStorage.setItem("test","test"),localStorage.removeItem("test"),e=!!localStorage.getItem("gameword"),[!0,e]}catch(e){return window.incognito=!0,console.warn("Внимание! Вы не разрешили хранить игре данные у себя на устройстве. Уровень музыки и настройки графикисбросятся при перезагрузке игры"),[!1,!1]}})();s||i[0]||(window.localStore=t),s?window.localStore=helper.parse(s):i[1]&&(window.localStore=helper.parse(localStorage.getItem("gameword"))),void 0!==localStore.music&&void 0!==!localStore.canvas||(localStore=t),saveLocalStorage(),e&&e()},bridge.sendPromise("VKWebAppCallAPIMethod",{method:"storage.get",params:{key:"gameword",access_token:VK_token,v:VK_version}}).then((e=>{""==e.response[0].value?s(!1):s(helper.decode64(e.response[0].value)),debug_mode&&console.log(helper.decode64(e.response[0].value))})).catch((e=>{s(!1)}))})((()=>{h()||(localStore.canvas=!0,saveLocalStorage()),window.scene=new PIXI.animate.Scene({width:window.innerWidth*window.devicePixelRatio,height:window.innerHeight*window.devicePixelRatio,view:canv,transparent:!0,antialias:!0,forceCanvas:Boolean(window.localStore.canvas)}),scene.renderer.options.backgroundColor=null,window.preloader.setup(PIXI.animate),scene.load(window.preloader,(t=>{window.root=scene.stage,window.devicePixelRatio,pre_control=new e(t),helper.getJSON(my_server+"/json/links.json",(e=>(e=>{window.content_links=e;let t=Object.keys(content_links);for(let e=0;e<t.length;e++)include("libs/"+content_links[t[e]]+".min.js?"+session_hash);pre_control.getToken()})(e)),(e=>pre_control.onError(e)))}))})),window.saveLocalStorage=(e=null)=>{window.incognito||localStorage.setItem("gameword",JSON.stringify(localStore)),bridge.sendPromise("VKWebAppCallAPIMethod",{method:"storage.set",params:{key:"gameword",value:helper.encode64(JSON.stringify(localStore)),access_token:VK_token,v:VK_version}}).then((t=>{debug_mode&&console.log("Success save local data"),e&&e()})).catch((e=>console.log(e)))},document.oncontextmenu=()=>!1,window.addEventListener("focus",(()=>{window.game&&(game.mask_mc.y=0)})),window.addEventListener("blur",(()=>{window.game&&(game.mask_mc.y=-1e4)})),window.copyTextarea=document.createElement("textarea"),copyTextarea.value="Создание скриншотов в игре ЗАПРЕЩЕНО",window.addEventListener("keyup",(e=>{44==e.keyCode&&(()=>{document.body.appendChild(copyTextarea),copyTextarea.focus(),copyTextarea.select();try{document.execCommand("copy"),document.body.removeChild(copyTextarea)}catch(e){document.body.removeChild(copyTextarea)}})()}))})()})();